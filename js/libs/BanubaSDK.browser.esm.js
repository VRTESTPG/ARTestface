/* eslint-disable */
let Zu=0;const Pn=()=>Zu++;class Dn{constructor(c){if(typeof window>"u")return this;const a=URL.createObjectURL(new Blob([c],{type:"text/javascript"})),d=new globalThis.Worker(a);return URL.revokeObjectURL(a),d}}var el=`this.self=function(){"use strict";onmessage=({data:e})=>{const t={id:e.id};setTimeout(postMessage,e.timeout,t)};var s="";return s}();
`;const Fn=new Dn(el),ht=new Map,An=(_,c)=>{const a=Pn(),d={id:a,timeout:c};return ht.set(d.id,_),Fn.postMessage(d),a};Fn.onmessage=({data:_})=>{const c=ht.get(_.id);ht.delete(_.id),c()};const rl=60,jn=1e3/rl,Gr=[];let Mn=0;const Ln=_=>{const c=Pn();if(Gr.length===0){const a=performance.now(),d=jn-(a-Mn)%jn;An(()=>{const E=Mn=performance.now(),C=[...Gr];Gr.length=0,C.forEach(T=>T(E))},d)}return Gr.push(_),c};var tl=Object.freeze(Object.defineProperty({__proto__:null,setTimeout:An,requestAnimationFrame:Ln},Symbol.toStringTag,{value:"Module"}));const nl=(..._)=>window.setTimeout(..._),Vr=new Map,il=_=>{const c=window.requestAnimationFrame((...a)=>{Vr.delete(c),_(...a)});return Vr.set(c,_),c};typeof document<"u"&&document.addEventListener("visibilitychange",()=>{document.visibilityState!=="visible"&&Vr.forEach((_,c)=>{Vr.delete(c),cancelAnimationFrame(c),Ln(_)})});var al=Object.freeze(Object.defineProperty({__proto__:null,setTimeout:nl,requestAnimationFrame:il},Symbol.toStringTag,{value:"Module"}));const Rn=()=>document.visibilityState==="visible"?al:tl,Qe=_=>Rn().requestAnimationFrame(_),sr=(_,c)=>Rn().setTimeout(_,c),ol={requestAnimationFrame:Qe,setTimeout:sr},sl=()=>new Promise(_=>Qe(_)),On=(_=-1)=>function(c,a,d){const E=d,C=E.value;return{...E,value:async function*(...M){const A=C.apply(this,M);let O=0,L=0;for(;;){const W=1e3/_,Q=.1*W;for(;(L=performance.now())-O<W-Q;)await sl();O=L;const{done:we,value:Le}=await A.next();if(we)return Le;const re=yield Le;typeof re<"u"&&(_=re)}}}},In=async(_,c={})=>new Promise(a=>{const d=document.createElement("video");if(d.muted=!0,d.controls=!1,d.playsInline=!0,Object.assign(d,c),_ instanceof globalThis.MediaStream)d.srcObject=_,d.addEventListener("ended",()=>d.srcObject=null,{once:!0}),_.addEventListener("inactive",()=>d.dispatchEvent(new CustomEvent("ended")),{once:!0});else{if(typeof _!="string"){const C=_=URL.createObjectURL(_);d.addEventListener("emptied",()=>URL.revokeObjectURL(C),{once:!0})}d.crossOrigin="anonymous",d.src=_,d.addEventListener("ended",()=>d.src="",{once:!0})}d.style.position="fixed",d.style.zIndex="-9999999",d.style.opacity="0.0000000001",document.body.appendChild(d),d.addEventListener("emptied",()=>d.remove(),{once:!0});const E=setInterval(()=>d.readyState,300);d.addEventListener("play",()=>clearInterval(E),{once:!0}),d.addEventListener("play",()=>a(d),{once:!0}),d.addEventListener("loadedmetadata",()=>d.play(),{once:!0})}),Bn=(_=300,c=150)=>{let a;return typeof OffscreenCanvas>"u"?(a=document.createElement("canvas"),a.width=_,a.height=c):a=new OffscreenCanvas(_,c),a},ul=(_,c={})=>{const a=_||Bn(),d=a.getContext("2d",c);return{get width(){return a.width},get height(){return a.height},get format(){return"RGBA"},drawImage:async(E,C,T,F,M)=>{var A,O;a.width=(A=E.videoWidth)!==null&&A!==void 0?A:E.width,a.height=(O=E.videoHeight)!==null&&O!==void 0?O:E.height,d.save(),d.translate(C,T),d.scale(Math.sign(F),Math.sign(M)),E instanceof ImageData?d.putImageData(E,C,T):d.drawImage(E,0,0,Math.abs(F),Math.abs(M)),d.restore()},getImageData:async(E,C,T,F,M)=>{const{width:A,height:O,data:L}=d.getImageData(E,C,T,F);return M.set(L),{width:A,height:O,data:M,format:"RGBA"}},dispose:()=>{}}};var ll=`#version 300 es
#define GLSLIFY 1
uniform vec2 u_scale;out vec2 v_tex_uv;void main(){float x=-1.0+float((gl_VertexID&1)<<2);float y=-1.0+float((gl_VertexID&2)<<1);v_tex_uv.x=(x+1.0)*0.5;v_tex_uv.y=(y+1.0)*0.5;gl_Position=vec4(x,y,0,1);gl_Position.xy*=u_scale;}`,fl=`#version 300 es
precision mediump float;
#define GLSLIFY 1
in vec2 v_tex_uv;uniform sampler2D u_texture;out vec4 fragColor;void main(){fragColor=texture(u_texture,v_tex_uv);}`;const cl={alpha:!0,antialias:!1,depth:!1,desynchronized:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1},dl=(_,c={})=>{const a=_||Bn(),d=a.getContext("webgl2",{...cl,...c});if(d==null)return null;const E=Nn(d,d.VERTEX_SHADER,ll),C=Nn(d,d.FRAGMENT_SHADER,fl),T=ml(d,E,C),F=Un(d,d.TEXTURE0),M=Un(d,d.TEXTURE1);let A=null;_ instanceof HTMLCanvasElement||(A=d.createFramebuffer(),d.bindFramebuffer(d.FRAMEBUFFER,A),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,M,0));const O=d.createBuffer();d.bindBuffer(d.PIXEL_PACK_BUFFER,O),d.bufferData(d.PIXEL_PACK_BUFFER,0,d.STREAM_READ);const L=d.getUniformLocation(T,"u_scale"),W=d.getParameter(d.IMPLEMENTATION_COLOR_READ_FORMAT),Q=d.getParameter(d.IMPLEMENTATION_COLOR_READ_TYPE),we=W===d.RGB?"RGB":"RGBA",Le=we.length;we==="RGB"&&d.pixelStorei(d.PACK_ALIGNMENT,1);let re;return{get width(){return d.drawingBufferWidth},get height(){return d.drawingBufferHeight},get format(){return we},async drawImage(te,ke,le,se,ie){d.activeTexture(d.TEXTURE0),d.texImage2D(d.TEXTURE_2D,0,W,W,Q,te);const Ee=Math.sign(se),Te=Math.sign(ie);(L.x!==Ee||L.y!==Te)&&d.uniform2fv(L,new Float32Array([L.x=Ee,L.y=Te])),se<0&&(se=Math.abs(se)),ie<0&&(ie=Math.abs(ie)),(a.width!==se||a.height!==ie)&&(d.activeTexture(d.TEXTURE1),d.texImage2D(d.TEXTURE_2D,0,W,a.width=se,a.height=ie,0,W,Q,null),d.viewport(0,0,a.width,a.height)),d.drawArrays(d.TRIANGLES,0,3)},getImageData:async(te,ke,le,se,ie)=>(re!==le*se*Le&&d.bufferData(d.PIXEL_PACK_BUFFER,re=le*se*Le,d.STREAM_READ),d.readPixels(te,ke,le,se,W,Q,0),await vl(d),d.getBufferSubData(d.PIXEL_PACK_BUFFER,0,new DataView(ie.buffer),ie.byteOffset,re),{width:le,height:se,data:ie,format:we}),dispose(){d.bindBuffer(d.PIXEL_PACK_BUFFER,null),d.activeTexture(d.TEXTURE1),A&&d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0),d.bindFramebuffer(d.FRAMEBUFFER,null),d.bindTexture(d.TEXTURE_2D,null),d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,null),d.useProgram(null),d.deleteBuffer(O),d.deleteFramebuffer(A),d.deleteTexture(F),d.deleteTexture(M),d.deleteProgram(T),d.deleteShader(E),d.deleteShader(C)}}};function ml(_,c,a){const d=_.createProgram();return _.attachShader(d,c),_.attachShader(d,a),_.linkProgram(d),_.useProgram(d),d}function Nn(_,c,a){const d=_.createShader(c);return _.shaderSource(d,a),_.compileShader(d),d}function Un(_,c){const a=_.createTexture();return _.activeTexture(c),_.bindTexture(_.TEXTURE_2D,a),_.texImage2D(_.TEXTURE_2D,0,_.RGB,1,1,0,_.RGB,_.UNSIGNED_BYTE,null),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR),a}const _l=(_,c)=>{const a=_.clientWaitSync(c,0,0);return a===_.CONDITION_SATISFIED||a===_.ALREADY_SIGNALED};async function vl(_){const c=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);_.flush(),await new Promise(a=>function d(){_l(_,c)?a():sr(d,2)}()),_.deleteSync(c)}const pt=(_,c)=>{let a=dl(_,c);return a==null&&(a=ul(_,c)),a},hl={horizontalFlip:!1,resize:(_,c)=>[_,c],crop:(_,c)=>[0,0,_,c]},Gn=(_={})=>{const{resize:c,crop:a,horizontalFlip:d}={...hl,..._};return{dxywh(E){var C,T;const F=(C=E.videoWidth)!==null&&C!==void 0?C:E.width,M=(T=E.videoHeight)!==null&&T!==void 0?T:E.height;let[A,O]=[0,0],[L,W]=c(F,M);return d&&([A,L]=[L,-L]),[A,O,L,W]},sxywh(E){var C,T;const F=(C=E.videoWidth)!==null&&C!==void 0?C:E.width,M=(T=E.videoHeight)!==null&&T!==void 0?T:E.height,[A,O,L,W]=a(F,M);return[A,O,L,W]}}};function ur(_,c,a,d){var E=arguments.length,C=E<3?c:d===null?d=Object.getOwnPropertyDescriptor(c,a):d,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(_,c,a,d);else for(var F=_.length-1;F>=0;F--)(T=_[F])&&(C=(E<3?T(C):E>3?T(c,a,C):T(c,a))||C);return E>3&&C&&Object.defineProperty(c,a,C),C}var Vn;class $n{constructor(c){Object.defineProperty(this,"_src",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._src=typeof c=="string"?c:URL.createObjectURL(c)}async*[Vn=Symbol.asyncIterator]({allocate:c,...a}){const d=document.createElement("img");await new Promise((A,O)=>{d.onload=A,d.onerror=O,d.crossOrigin="anonymous",d.src=this._src});const E=pt(),C=Gn(a);E.drawImage(d,...C.dxywh(d));const T=C.sxywh(E),F=new Uint8ClampedArray(T[2]*T[3]*E.format.length),M=await E.getImageData(...T,F);for(E.dispose(),URL.revokeObjectURL(d.src),d.src="";;){const A=c(T[2]*T[3]*E.format.length);await new Promise(O=>sr(O)),A.set(F),yield{...M,data:A}}}}ur([On(30)],$n.prototype,Vn,null);var Wn;const zn={loop:!1};class gt{constructor(c,a){Object.defineProperty(this,"_video",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_ctx",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_src",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._src=c,this._options={...zn,...a}}async*[Wn=Symbol.asyncIterator]({allocate:c,...a}){var d,E;const C=(d=this._video)!==null&&d!==void 0?d:this._video=await In(this._src,this._options),T=(E=this._ctx)!==null&&E!==void 0?E:this._ctx=pt(),F=Gn(a);let M=!1;C.addEventListener("pause",()=>C.play()),C.addEventListener("ended",()=>this.stop(),{once:!0}),C.addEventListener("emptied",()=>M=!0,{once:!0}),C.addEventListener("emptied",()=>W.then(()=>T.dispose()),{once:!0}),T.drawImage(C,...F.dxywh(C));let A=F.sxywh(T),O=c(A[2]*A[3]*T.format.length),L=T.getImageData(...A,O),W;for(;!M;)T.drawImage(C,...F.dxywh(C)),A=F.sxywh(T),O=c(A[2]*A[3]*T.format.length),W=T.getImageData(...A,O),await new Promise(Q=>sr(Q)),yield L,await(L=W),await new Promise(Q=>Qe(Q))}stop(){this._video&&(this._video.srcObject=null,this._video.src=""),this._ctx=null,this._video=null}}ur([On(30)],gt.prototype,Wn,null);class Me{constructor(c){if(Object.defineProperty(this,"_video",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_stream",{enumerable:!0,configurable:!0,writable:!0,value:null}),!Me.cache.has(c))Me.cache.set(c,this);else return Me.cache.get(c);this._stream=c}async*[Symbol.asyncIterator](c){var a;const E=((a=this._video)!==null&&a!==void 0?a:this._video=new gt(this._stream))[Symbol.asyncIterator](c);let C;for(;;){const{done:T,value:F}=await E.next(C);if(T)break;C=yield F}this.stop()}stop(){var c,a,d;const E=(d=(a=(c=this._stream)===null||c===void 0?void 0:c.getVideoTracks)===null||a===void 0?void 0:a.call(c))!==null&&d!==void 0?d:[];for(const C of E)C.stop();this._stream&&Me.cache.delete(this._stream),this._stream=null,this._video=null}}Object.defineProperty(Me,"cache",{enumerable:!0,configurable:!0,writable:!0,value:new WeakMap});const pl=typeof screen<"u"&&screen.height>screen.width,$r={facingMode:"user",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080},resizeMode:{ideal:"crop-and-scale"}};pl&&(delete $r.width,delete $r.height);class gl{constructor(c){Object.defineProperty(this,"_stream",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_constraints",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._constraints={...$r,...c}}async start(){var c;return(c=this._stream)!==null&&c!==void 0||(this._stream=await Hn(this._constraints)),this}async*[Symbol.asyncIterator]({horizontalFlip:c=!0,...a}){var d;const C=((d=this._stream)!==null&&d!==void 0?d:this._stream=await Hn(this._constraints))[Symbol.asyncIterator]({horizontalFlip:c,...a});let T;for(;;){const{done:F,value:M}=await C.next(T);if(F)break;T=yield M}this.stop()}stop(){var c;(c=this._stream)===null||c===void 0||c.stop(),this._stream=null}}const Hn=async _=>{if(typeof navigator.mediaDevices>"u")throw new Error(`SecureContext is required to access webcam
It's likely you need to set up HTTPS/TLS for your website
See https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#Encryption_based_security for details `);return new Me(await navigator.mediaDevices.getUserMedia({video:_}))},qn={createRenderingContext:pt,createVideoElement:In};let bl="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Qn=(_=21)=>{let c="",a=_;for(;a--;)c+=bl[Math.random()*64|0];return c};var yl=(()=>{var _=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(a){a=a||{};var a=typeof a<"u"?a:{},d=Object.assign,E,C;a.ready=new Promise(function(e,r){E=e,C=r}),a.expectedDataFileDownloads||(a.expectedDataFileDownloads=0),a.expectedDataFileDownloads++,function(){if(!a.ENVIRONMENT_IS_PTHREAD){var e=function(r){typeof window=="object"?window.encodeURIComponent(window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/"):typeof process>"u"&&typeof location<"u"&&encodeURIComponent(location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/");var t="BanubaSDK.data",n="BanubaSDK.data";typeof a.locateFilePackage=="function"&&!a.locateFile&&(a.locateFile=a.locateFilePackage,te("warning: you defined Module.locateFilePackage, that has been renamed to Module.locateFile (using your locateFilePackage for now)"));var i=a.locateFile?a.locateFile(n,""):n,o=r.remote_package_size;r.package_uuid;function u(h,y,p,x){var P=new XMLHttpRequest;P.open("GET",h,!0),P.responseType="arraybuffer",P.onprogress=function(j){var I=h,N=y;if(j.total&&(N=j.total),j.loaded){P.addedTotal?a.dataFileDownloads[I].loaded=j.loaded:(P.addedTotal=!0,a.dataFileDownloads||(a.dataFileDownloads={}),a.dataFileDownloads[I]={loaded:j.loaded,total:N});var k=0,D=0,U=0;for(var R in a.dataFileDownloads){var B=a.dataFileDownloads[R];k+=B.total,D+=B.loaded,U++}k=Math.ceil(k*a.expectedDataFileDownloads/U),a.setStatus&&a.setStatus("Downloading data... ("+D+"/"+k+")")}else a.dataFileDownloads||a.setStatus&&a.setStatus("Downloading data...")},P.onerror=function(j){throw new Error("NetworkError for: "+h)},P.onload=function(j){if(P.status==200||P.status==304||P.status==206||P.status==0&&P.response){var I=P.response;p(I)}else throw new Error(P.statusText+" : "+P.responseURL)},P.send(null)}var l=null,f=a.getPreloadedPackage?a.getPreloadedPackage(i,o):null;f||u(i,o,function(h){l?(l(h),l=null):f=h});function v(){function h(j,I){if(!j)throw I+new Error().stack}a.FS_createPath("/","bnb_shaders",!0,!0),a.FS_createPath("/bnb_shaders","bnb",!0,!0),a.FS_createPath("/bnb_shaders/bnb","lib",!0,!0),a.FS_createPath("/","frx",!0,!0),a.FS_createPath("/","bnb_js",!0,!0);function y(j,I,N){this.start=j,this.end=I,this.audio=N}y.prototype={requests:{},open:function(j,I){this.name=I,this.requests[I]=this,a.addRunDependency("fp "+this.name)},send:function(){},onload:function(){var j=this.byteArray.subarray(this.start,this.end);this.finish(j)},finish:function(j){var I=this;a.FS_createDataFile(this.name,null,j,!0,!0,!0),a.removeRunDependency("fp "+I.name),this.requests[this.name]=null}};for(var p=r.files,x=0;x<p.length;++x)new y(p[x].start,p[x].end,p[x].audio||0).open("GET",p[x].filename);function P(j){h(j,"Loading data file failed."),h(j instanceof ArrayBuffer,"bad input to processPackageData");var I=new Uint8Array(j);y.prototype.byteArray=I;for(var N=r.files,k=0;k<N.length;++k)y.prototype.requests[N[k].filename].onload();a.removeRunDependency("datafile_BanubaSDK.data")}a.addRunDependency("datafile_BanubaSDK.data"),a.preloadResults||(a.preloadResults={}),a.preloadResults[t]={fromCache:!1},f?(P(f),f=null):l=P}a.calledRun?v():(a.preRun||(a.preRun=[]),a.preRun.push(v))};e({files:[{filename:"/bnb_shaders/.empty",start:0,end:19},{filename:"/bnb_shaders/bnb/anim_transform.glsl",start:19,end:182},{filename:"/bnb_shaders/bnb/color_spaces.glsl",start:182,end:4481},{filename:"/bnb_shaders/bnb/decode_int1010102.glsl",start:4481,end:5680},{filename:"/bnb_shaders/bnb/get_bone.glsl",start:5680,end:6484},{filename:"/bnb_shaders/bnb/get_transform.glsl",start:6484,end:7937},{filename:"/bnb_shaders/bnb/glsl.frag",start:7937,end:8703},{filename:"/bnb_shaders/bnb/glsl.vert",start:8703,end:9754},{filename:"/bnb_shaders/bnb/lut.glsl",start:9754,end:14639},{filename:"/bnb_shaders/bnb/math.glsl",start:14639,end:15012},{filename:"/bnb_shaders/bnb/matrix_operations.glsl",start:15012,end:18773},{filename:"/bnb_shaders/bnb/morph_transform.glsl",start:18773,end:19831},{filename:"/bnb_shaders/bnb/quat_rotation.glsl",start:19831,end:21225},{filename:"/bnb_shaders/bnb/samplers_declaration.glsl",start:21225,end:23969},{filename:"/bnb_shaders/bnb/texture_bicubic.glsl",start:23969,end:25504},{filename:"/bnb_shaders/bnb/textures_lookup.glsl",start:25504,end:28214},{filename:"/bnb_shaders/bnb/transform_uv.glsl",start:28214,end:30651},{filename:"/bnb_shaders/bnb/version.glsl",start:30651,end:30955},{filename:"/bnb_shaders/bnb/lib/apply_light_streaks.frag",start:30955,end:31267},{filename:"/bnb_shaders/bnb/lib/apply_light_streaks.vert",start:31267,end:31522},{filename:"/bnb_shaders/bnb/lib/auto_morph.frag",start:31522,end:31635},{filename:"/bnb_shaders/bnb/lib/auto_morph.vert",start:31635,end:32271},{filename:"/bnb_shaders/bnb/lib/auto_morph_fisheye.frag",start:32271,end:32384},{filename:"/bnb_shaders/bnb/lib/auto_morph_fisheye.vert",start:32384,end:32915},{filename:"/bnb_shaders/bnb/lib/beauty_morph.frag",start:32915,end:33033},{filename:"/bnb_shaders/bnb/lib/beauty_morph.vert",start:33033,end:34198},{filename:"/bnb_shaders/bnb/lib/bg_mask_assosiation.frag",start:34198,end:34543},{filename:"/bnb_shaders/bnb/lib/bg_mask_assosiation.vert",start:34543,end:34924},{filename:"/bnb_shaders/bnb/lib/bg_mask_smoothing.frag",start:34924,end:35923},{filename:"/bnb_shaders/bnb/lib/bg_mask_smoothing.vert",start:35923,end:36128},{filename:"/bnb_shaders/bnb/lib/camera.frag",start:36128,end:37575},{filename:"/bnb_shaders/bnb/lib/camera.vert",start:37575,end:37896},{filename:"/bnb_shaders/bnb/lib/copy_pixels.frag",start:37896,end:38070},{filename:"/bnb_shaders/bnb/lib/copy_pixels.vert",start:38070,end:38325},{filename:"/bnb_shaders/bnb/lib/dual_filter_blur_downscale.frag",start:38325,end:38968},{filename:"/bnb_shaders/bnb/lib/dual_filter_blur_downscale.vert",start:38968,end:39173},{filename:"/bnb_shaders/bnb/lib/dual_filter_blur_upscale.frag",start:39173,end:40085},{filename:"/bnb_shaders/bnb/lib/dual_filter_blur_upscale.vert",start:40085,end:40426},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_0.frag",start:40426,end:41412},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_0.vert",start:41412,end:42003},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_1.frag",start:42003,end:42989},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_1.vert",start:42989,end:43580},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_2.frag",start:43580,end:44566},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_2.vert",start:44566,end:45157},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_3.frag",start:45157,end:46143},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_3.vert",start:46143,end:46734},{filename:"/bnb_shaders/bnb/lib/gltf.frag",start:46734,end:49111},{filename:"/bnb_shaders/bnb/lib/gltf.vert",start:49111,end:50494},{filename:"/bnb_shaders/bnb/lib/improved_dual_filter_blur_downscale.frag",start:50494,end:51883},{filename:"/bnb_shaders/bnb/lib/init_light_streaks.frag",start:51883,end:52213},{filename:"/bnb_shaders/bnb/lib/init_light_streaks.vert",start:52213,end:52468},{filename:"/bnb_shaders/bnb/lib/mesh_morph.frag",start:52468,end:52586},{filename:"/bnb_shaders/bnb/lib/mesh_morph.vert",start:52586,end:54683},{filename:"/bnb_shaders/bnb/lib/morph_apply.frag",start:54683,end:55026},{filename:"/bnb_shaders/bnb/lib/morph_apply.vert",start:55026,end:57214},{filename:"/bnb_shaders/bnb/lib/morph_blur.frag",start:57214,end:58537},{filename:"/bnb_shaders/bnb/lib/morph_blur.vert",start:58537,end:58869},{filename:"/bnb_shaders/bnb/lib/retouch.frag",start:58869,end:62620},{filename:"/bnb_shaders/bnb/lib/retouch.vert",start:62620,end:63202},{filename:"/bnb_shaders/bnb/lib/static_pos.frag",start:63202,end:63313},{filename:"/bnb_shaders/bnb/lib/static_pos.vert",start:63313,end:63591},{filename:"/bnb_shaders/bnb/lib/uv_morph.frag",start:63591,end:63704},{filename:"/bnb_shaders/bnb/lib/uv_morph.vert",start:63704,end:64235},{filename:"/bnb_shaders/bnb/lib/vbg.frag",start:64235,end:65296},{filename:"/bnb_shaders/bnb/lib/vbg.vert",start:65296,end:66556},{filename:"/resources-versions.txt",start:66556,end:68679},{filename:"/watermark.png",start:68679,end:71165},{filename:"/watermark_blurred.png",start:71165,end:93598},{filename:"/frx/frx.js",start:93598,end:96120},{filename:"/bnb_js/.empty",start:96120,end:96140},{filename:"/bnb_js/background.js",start:96140,end:99473},{filename:"/bnb_js/console.js",start:99473,end:100033},{filename:"/bnb_js/global.js",start:100033,end:100414},{filename:"/bnb_js/legacy.js",start:100414,end:104691},{filename:"/bnb_js/light_streaks.js",start:104691,end:114398},{filename:"/bnb_js/timers.js",start:114398,end:117717}],remote_package_size:117717,package_uuid:"5fa9bc21-03b5-4a50-846a-726ea62f505b"})}}();var T=a.FinalizationGroup,F=d({},a),M="./this.program",A=(e,r)=>{throw r},O=!0,L="";function W(e){return a.locateFile?a.locateFile(e,L):L+e}var Q,we,Le;typeof document<"u"&&document.currentScript&&(L=document.currentScript.src),_&&(L=_),L.indexOf("blob:")!==0?L=L.substr(0,L.replace(/[?#].*/,"").lastIndexOf("/")+1):L="",Q=function(e){var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},we=function(e,r,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){if(n.status==200||n.status==0&&n.response){r(n.response);return}t()},n.onerror=t,n.send(null)};var re=a.print||console.log.bind(console),te=a.printErr||console.warn.bind(console);d(a,F),F=null,a.arguments,a.thisProgram&&(M=a.thisProgram),a.quit&&(A=a.quit);function ke(e){ke.shown||(ke.shown={}),ke.shown[e]||(ke.shown[e]=1,te(e))}var le;a.wasmBinary&&(le=a.wasmBinary);var se=a.noExitRuntime||!0;typeof WebAssembly!="object"&&he("no native wasm support detected");var ie,Ee=!1,Te;function Xe(e,r){e||he(r)}var St=0,ii=1;function xt(e,r){var t;return r==ii?t=_n(e.length):t=je(e.length),e.subarray||e.slice?q.set(e,t):q.set(new Uint8Array(e),t),t}var kt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Ue(e,r,t){for(var n=r+t,i=r;e[i]&&!(i>=n);)++i;if(i-r>16&&e.subarray&&kt)return kt.decode(e.subarray(r,i));for(var o="";r<i;){var u=e[r++];if(!(u&128)){o+=String.fromCharCode(u);continue}var l=e[r++]&63;if((u&224)==192){o+=String.fromCharCode((u&31)<<6|l);continue}var f=e[r++]&63;if((u&240)==224?u=(u&15)<<12|l<<6|f:u=(u&7)<<18|l<<12|f<<6|e[r++]&63,u<65536)o+=String.fromCharCode(u);else{var v=u-65536;o+=String.fromCharCode(55296|v>>10,56320|v&1023)}}return o}function Ce(e,r){return e?Ue(q,e,r):""}function lr(e,r,t,n){if(!(n>0))return 0;for(var i=t,o=t+n-1,u=0;u<e.length;++u){var l=e.charCodeAt(u);if(l>=55296&&l<=57343){var f=e.charCodeAt(++u);l=65536+((l&1023)<<10)|f&1023}if(l<=127){if(t>=o)break;r[t++]=l}else if(l<=2047){if(t+1>=o)break;r[t++]=192|l>>6,r[t++]=128|l&63}else if(l<=65535){if(t+2>=o)break;r[t++]=224|l>>12,r[t++]=128|l>>6&63,r[t++]=128|l&63}else{if(t+3>=o)break;r[t++]=240|l>>18,r[t++]=128|l>>12&63,r[t++]=128|l>>6&63,r[t++]=128|l&63}}return r[t]=0,t-i}function Pe(e,r,t){return lr(e,q,r,t)}function De(e){for(var r=0,t=0;t<e.length;++t){var n=e.charCodeAt(t);n>=55296&&n<=57343&&(n=65536+((n&1023)<<10)|e.charCodeAt(++t)&1023),n<=127?++r:n<=2047?r+=2:n<=65535?r+=3:r+=4}return r}var Tt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ai(e,r){for(var t=e,n=t>>1,i=n+r/2;!(n>=i)&&Ge[n];)++n;if(t=n<<1,t-e>32&&Tt)return Tt.decode(q.subarray(e,t));for(var o="",u=0;!(u>=r/2);++u){var l=ue[e+u*2>>1];if(l==0)break;o+=String.fromCharCode(l)}return o}function oi(e,r,t){if(t===void 0&&(t=2147483647),t<2)return 0;t-=2;for(var n=r,i=t<e.length*2?t/2:e.length,o=0;o<i;++o){var u=e.charCodeAt(o);ue[r>>1]=u,r+=2}return ue[r>>1]=0,r-n}function si(e){return e.length*2}function ui(e,r){for(var t=0,n="";!(t>=r/4);){var i=g[e+t*4>>2];if(i==0)break;if(++t,i>=65536){var o=i-65536;n+=String.fromCharCode(55296|o>>10,56320|o&1023)}else n+=String.fromCharCode(i)}return n}function li(e,r,t){if(t===void 0&&(t=2147483647),t<4)return 0;for(var n=r,i=n+t-4,o=0;o<e.length;++o){var u=e.charCodeAt(o);if(u>=55296&&u<=57343){var l=e.charCodeAt(++o);u=65536+((u&1023)<<10)|l&1023}if(g[r>>2]=u,r+=4,r+4>i)break}return g[r>>2]=0,r-n}function fi(e){for(var r=0,t=0;t<e.length;++t){var n=e.charCodeAt(t);n>=55296&&n<=57343&&++t,r+=4}return r}function Hr(e){var r=De(e)+1,t=je(r);return t&&lr(e,X,t,r),t}function ci(e,r){X.set(e,r)}function di(e,r,t){for(var n=0;n<e.length;++n)X[r++>>0]=e.charCodeAt(n);t||(X[r>>0]=0)}function mi(e,r){return e%r>0&&(e+=r-e%r),e}var fr,X,q,ue,Ge,g,ne,J,Pt;function Dt(e){fr=e,a.HEAP8=X=new Int8Array(e),a.HEAP16=ue=new Int16Array(e),a.HEAP32=g=new Int32Array(e),a.HEAPU8=q=new Uint8Array(e),a.HEAPU16=Ge=new Uint16Array(e),a.HEAPU32=ne=new Uint32Array(e),a.HEAPF32=J=new Float32Array(e),a.HEAPF64=Pt=new Float64Array(e)}a.INITIAL_MEMORY;var Ft,At=[],jt=[],Mt=[],Lt=!1,_i=0;function qr(){return se||_i>0}function vi(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)bi(a.preRun.shift());Qr(At)}function hi(){!a.noFSInit&&!s.init.initialized&&s.init(),s.ignorePermissions=!1,Qr(jt)}function pi(){Lt=!0}function gi(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)wi(a.postRun.shift());Qr(Mt)}function bi(e){At.unshift(e)}function yi(e){jt.unshift(e)}function wi(e){Mt.unshift(e)}var Re=0,Ke=null;function Kl(e){return e}function cr(e){Re++,a.monitorRunDependencies&&a.monitorRunDependencies(Re)}function Je(e){if(Re--,a.monitorRunDependencies&&a.monitorRunDependencies(Re),Re==0&&Ke){var r=Ke;Ke=null,r()}}a.preloadedImages={},a.preloadedAudios={};function he(e){a.onAbort&&a.onAbort(e),e="Aborted("+e+")",te(e),Ee=!0,Te=1,e+=". Build with -s ASSERTIONS=1 for more info.";var r=new WebAssembly.RuntimeError(e);throw C(r),r}var Ei="data:application/octet-stream;base64,";function Rt(e){return e.startsWith(Ei)}var fe;fe="BanubaSDK.wasm",Rt(fe)||(fe=W(fe));function Ot(e){try{if(e==fe&&le)return new Uint8Array(le);if(!Le)throw"both async and sync fetching of the wasm failed"}catch(r){he(r)}}function Ci(){return!le&&O&&typeof fetch=="function"?fetch(fe,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+fe+"'";return e.arrayBuffer()}).catch(function(){return Ot(fe)}):Promise.resolve().then(function(){return Ot(fe)})}function Si(){var e={env:ln,wasi_snapshot_preview1:ln};function r(u,l){var f=u.exports;a.asm=f,ie=a.asm.memory,Dt(ie.buffer),Ft=a.asm.__indirect_function_table,yi(a.asm.__wasm_call_ctors),Je()}cr();function t(u){r(u.instance)}function n(u){return Ci().then(function(l){return WebAssembly.instantiate(l,e)}).then(function(l){return l}).then(u,function(l){te("failed to asynchronously prepare wasm: "+l),he(l)})}function i(){return!le&&typeof WebAssembly.instantiateStreaming=="function"&&!Rt(fe)&&typeof fetch=="function"?fetch(fe,{credentials:"same-origin"}).then(function(u){var l=WebAssembly.instantiateStreaming(u,e);return l.then(t,function(f){return te("wasm streaming compile failed: "+f),te("falling back to ArrayBuffer instantiation"),n(t)})}):n(t)}if(a.instantiateWasm)try{var o=a.instantiateWasm(e,r);return o}catch(u){return te("Module.instantiateWasm callback failed with error: "+u),!1}return i().catch(C),{}}var H,ae;function xi(e){const r=Ce(e),t=s.readFile(r),n=document.createElement("video"),i=URL.createObjectURL(new Blob([t],{type:"video/mp4"})),o=a.proxyVideoRequestsTo;return n.muted=!0,n.autoplay=!1,n.controls=!1,n.playsInline=!0,n.src=o?o+encodeURIComponent(i):i,K.toHandle(n)}function ki(e){const r=K.toValue(e);URL.revokeObjectURL(r.src),r.src=""}function Ti(){return a.useCamTexture&&a.texture?(a.camTextureId||(a.camTextureId=S.getNewId(S.textures),a.texture.name=a.camTextureId,S.textures[a.camTextureId]=a.texture),a.camTextureId):0}function Pi(){var e=window.location.hostname,r=De(e)+1,t=je(r);return Pe(e,t,r),t}function Di(){return/electron/i.test(navigator.userAgent)}function Qr(e){for(;e.length>0;){var r=e.shift();if(typeof r=="function"){r(a);continue}var t=r.func;typeof t=="number"?r.arg===void 0?mr(t)():mr(t)(r.arg):t(r.arg===void 0?null:r.arg)}}var dr=[];function mr(e){var r=dr[e];return r||(e>=dr.length&&(dr.length=e+1),dr[e]=r=Ft.get(e)),r}function It(e){if(e instanceof hn||e=="unwind")return Te;A(1,e)}var Ze;Ze=()=>performance.now();var Fi=!0;function Bt(e){return g[fn()>>2]=e,e}function Nt(e,r){var t;if(e===0)t=Date.now();else if((e===1||e===4)&&Fi)t=Ze();else return Bt(28),-1;return g[r>>2]=t/1e3|0,g[r+4>>2]=t%1e3*1e3*1e3|0,0}function Ai(e,r){return Nt(e,r)}function ji(e){return je(e+16)+16}var Ut=[];function Mi(){var e=Ut.pop();e||he("no exception to throw");var r=e.get_exception_info(),t=e.get_base_ptr();throw r.get_rethrown()?e.free():(Ut.push(e),r.set_rethrown(!0),r.set_caught(!1)),t}function Li(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(r){g[this.ptr+4>>2]=r},this.get_type=function(){return g[this.ptr+4>>2]},this.set_destructor=function(r){g[this.ptr+8>>2]=r},this.get_destructor=function(){return g[this.ptr+8>>2]},this.set_refcount=function(r){g[this.ptr>>2]=r},this.set_caught=function(r){r=r?1:0,X[this.ptr+12>>0]=r},this.get_caught=function(){return X[this.ptr+12>>0]!=0},this.set_rethrown=function(r){r=r?1:0,X[this.ptr+13>>0]=r},this.get_rethrown=function(){return X[this.ptr+13>>0]!=0},this.init=function(r,t){this.set_type(r),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var r=g[this.ptr>>2];g[this.ptr>>2]=r+1},this.release_ref=function(){var r=g[this.ptr>>2];return g[this.ptr>>2]=r-1,r===1}}function Ri(e,r,t){var n=new Li(e);throw n.init(r,t),e}function er(e,r){var t=new Date(g[e>>2]*1e3);g[r>>2]=t.getUTCSeconds(),g[r+4>>2]=t.getUTCMinutes(),g[r+8>>2]=t.getUTCHours(),g[r+12>>2]=t.getUTCDate(),g[r+16>>2]=t.getUTCMonth(),g[r+20>>2]=t.getUTCFullYear()-1900,g[r+24>>2]=t.getUTCDay(),g[r+36>>2]=0,g[r+32>>2]=0;var n=Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0),i=(t.getTime()-n)/(1e3*60*60*24)|0;return g[r+28>>2]=i,er.GMTString||(er.GMTString=Hr("GMT")),g[r+40>>2]=er.GMTString,r}function Oi(e,r){return er(e,r)}var z={splitPath:function(e){var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return r.exec(e).slice(1)},normalizeArray:function(e,r){for(var t=0,n=e.length-1;n>=0;n--){var i=e[n];i==="."?e.splice(n,1):i===".."?(e.splice(n,1),t++):t&&(e.splice(n,1),t--)}if(r)for(;t;t--)e.unshift("..");return e},normalize:function(e){var r=e.charAt(0)==="/",t=e.substr(-1)==="/";return e=z.normalizeArray(e.split("/").filter(function(n){return!!n}),!r).join("/"),!e&&!r&&(e="."),e&&t&&(e+="/"),(r?"/":"")+e},dirname:function(e){var r=z.splitPath(e),t=r[0],n=r[1];return!t&&!n?".":(n&&(n=n.substr(0,n.length-1)),t+n)},basename:function(e){if(e==="/")return"/";e=z.normalize(e),e=e.replace(/\/$/,"");var r=e.lastIndexOf("/");return r===-1?e:e.substr(r+1)},extname:function(e){return z.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return z.normalize(e.join("/"))},join2:function(e,r){return z.normalize(e+"/"+r)}};function Gt(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}else return function(){he("randomDevice")}}var Se={resolve:function(){for(var e="",r=!1,t=arguments.length-1;t>=-1&&!r;t--){var n=t>=0?arguments[t]:s.cwd();if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,r=n.charAt(0)==="/"}return e=z.normalizeArray(e.split("/").filter(function(i){return!!i}),!r).join("/"),(r?"/":"")+e||"."},relative:function(e,r){e=Se.resolve(e).substr(1),r=Se.resolve(r).substr(1);function t(v){for(var h=0;h<v.length&&v[h]==="";h++);for(var y=v.length-1;y>=0&&v[y]==="";y--);return h>y?[]:v.slice(h,y-h+1)}for(var n=t(e.split("/")),i=t(r.split("/")),o=Math.min(n.length,i.length),u=o,l=0;l<o;l++)if(n[l]!==i[l]){u=l;break}for(var f=[],l=u;l<n.length;l++)f.push("..");return f=f.concat(i.slice(u)),f.join("/")}},Oe={ttys:[],init:function(){},shutdown:function(){},register:function(e,r){Oe.ttys[e]={input:[],output:[],ops:r},s.registerDevice(e,Oe.stream_ops)},stream_ops:{open:function(e){var r=Oe.ttys[e.node.rdev];if(!r)throw new s.ErrnoError(43);e.tty=r,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,r,t,n,i){if(!e.tty||!e.tty.ops.get_char)throw new s.ErrnoError(60);for(var o=0,u=0;u<n;u++){var l;try{l=e.tty.ops.get_char(e.tty)}catch{throw new s.ErrnoError(29)}if(l===void 0&&o===0)throw new s.ErrnoError(6);if(l==null)break;o++,r[t+u]=l}return o&&(e.node.timestamp=Date.now()),o},write:function(e,r,t,n,i){if(!e.tty||!e.tty.ops.put_char)throw new s.ErrnoError(60);try{for(var o=0;o<n;o++)e.tty.ops.put_char(e.tty,r[t+o])}catch{throw new s.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var r=null;if(typeof window<"u"&&typeof window.prompt=="function"?(r=window.prompt("Input: "),r!==null&&(r+=`
`)):typeof readline=="function"&&(r=readline(),r!==null&&(r+=`
`)),!r)return null;e.input=He(r,!0)}return e.input.shift()},put_char:function(e,r){r===null||r===10?(re(Ue(e.output,0)),e.output=[]):r!=0&&e.output.push(r)},flush:function(e){e.output&&e.output.length>0&&(re(Ue(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,r){r===null||r===10?(te(Ue(e.output,0)),e.output=[]):r!=0&&e.output.push(r)},flush:function(e){e.output&&e.output.length>0&&(te(Ue(e.output,0)),e.output=[])}}};function Ii(e,r){q.fill(0,e,e+r)}function Bi(e,r){return Math.ceil(e/r)*r}function Vt(e){e=Bi(e,65536);var r=vn(65536,e);return r?(Ii(r,e),r):0}var G={ops_table:null,mount:function(e){return G.createNode(null,"/",16895,0)},createNode:function(e,r,t,n){if(s.isBlkdev(t)||s.isFIFO(t))throw new s.ErrnoError(63);G.ops_table||(G.ops_table={dir:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr,lookup:G.node_ops.lookup,mknod:G.node_ops.mknod,rename:G.node_ops.rename,unlink:G.node_ops.unlink,rmdir:G.node_ops.rmdir,readdir:G.node_ops.readdir,symlink:G.node_ops.symlink},stream:{llseek:G.stream_ops.llseek}},file:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr},stream:{llseek:G.stream_ops.llseek,read:G.stream_ops.read,write:G.stream_ops.write,allocate:G.stream_ops.allocate,mmap:G.stream_ops.mmap,msync:G.stream_ops.msync}},link:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr,readlink:G.node_ops.readlink},stream:{}},chrdev:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr},stream:s.chrdev_stream_ops}});var i=s.createNode(e,r,t,n);return s.isDir(i.mode)?(i.node_ops=G.ops_table.dir.node,i.stream_ops=G.ops_table.dir.stream,i.contents={}):s.isFile(i.mode)?(i.node_ops=G.ops_table.file.node,i.stream_ops=G.ops_table.file.stream,i.usedBytes=0,i.contents=null):s.isLink(i.mode)?(i.node_ops=G.ops_table.link.node,i.stream_ops=G.ops_table.link.stream):s.isChrdev(i.mode)&&(i.node_ops=G.ops_table.chrdev.node,i.stream_ops=G.ops_table.chrdev.stream),i.timestamp=Date.now(),e&&(e.contents[r]=i,e.timestamp=i.timestamp),i},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,r){var t=e.contents?e.contents.length:0;if(!(t>=r)){var n=1024*1024;r=Math.max(r,t*(t<n?2:1.125)>>>0),t!=0&&(r=Math.max(r,256));var i=e.contents;e.contents=new Uint8Array(r),e.usedBytes>0&&e.contents.set(i.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,r){if(e.usedBytes!=r)if(r==0)e.contents=null,e.usedBytes=0;else{var t=e.contents;e.contents=new Uint8Array(r),t&&e.contents.set(t.subarray(0,Math.min(r,e.usedBytes))),e.usedBytes=r}},node_ops:{getattr:function(e){var r={};return r.dev=s.isChrdev(e.mode)?e.id:1,r.ino=e.id,r.mode=e.mode,r.nlink=1,r.uid=0,r.gid=0,r.rdev=e.rdev,s.isDir(e.mode)?r.size=4096:s.isFile(e.mode)?r.size=e.usedBytes:s.isLink(e.mode)?r.size=e.link.length:r.size=0,r.atime=new Date(e.timestamp),r.mtime=new Date(e.timestamp),r.ctime=new Date(e.timestamp),r.blksize=4096,r.blocks=Math.ceil(r.size/r.blksize),r},setattr:function(e,r){r.mode!==void 0&&(e.mode=r.mode),r.timestamp!==void 0&&(e.timestamp=r.timestamp),r.size!==void 0&&G.resizeFileStorage(e,r.size)},lookup:function(e,r){throw s.genericErrors[44]},mknod:function(e,r,t,n){return G.createNode(e,r,t,n)},rename:function(e,r,t){if(s.isDir(e.mode)){var n;try{n=s.lookupNode(r,t)}catch{}if(n)for(var i in n.contents)throw new s.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=t,r.contents[t]=e,r.timestamp=e.parent.timestamp,e.parent=r},unlink:function(e,r){delete e.contents[r],e.timestamp=Date.now()},rmdir:function(e,r){var t=s.lookupNode(e,r);for(var n in t.contents)throw new s.ErrnoError(55);delete e.contents[r],e.timestamp=Date.now()},readdir:function(e){var r=[".",".."];for(var t in e.contents)!e.contents.hasOwnProperty(t)||r.push(t);return r},symlink:function(e,r,t){var n=G.createNode(e,r,41471,0);return n.link=t,n},readlink:function(e){if(!s.isLink(e.mode))throw new s.ErrnoError(28);return e.link}},stream_ops:{read:function(e,r,t,n,i){var o=e.node.contents;if(i>=e.node.usedBytes)return 0;var u=Math.min(e.node.usedBytes-i,n);if(u>8&&o.subarray)r.set(o.subarray(i,i+u),t);else for(var l=0;l<u;l++)r[t+l]=o[i+l];return u},write:function(e,r,t,n,i,o){if(r.buffer===X.buffer&&(o=!1),!n)return 0;var u=e.node;if(u.timestamp=Date.now(),r.subarray&&(!u.contents||u.contents.subarray)){if(o)return u.contents=r.subarray(t,t+n),u.usedBytes=n,n;if(u.usedBytes===0&&i===0)return u.contents=r.slice(t,t+n),u.usedBytes=n,n;if(i+n<=u.usedBytes)return u.contents.set(r.subarray(t,t+n),i),n}if(G.expandFileStorage(u,i+n),u.contents.subarray&&r.subarray)u.contents.set(r.subarray(t,t+n),i);else for(var l=0;l<n;l++)u.contents[i+l]=r[t+l];return u.usedBytes=Math.max(u.usedBytes,i+n),n},llseek:function(e,r,t){var n=r;if(t===1?n+=e.position:t===2&&s.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new s.ErrnoError(28);return n},allocate:function(e,r,t){G.expandFileStorage(e.node,r+t),e.node.usedBytes=Math.max(e.node.usedBytes,r+t)},mmap:function(e,r,t,n,i,o){if(r!==0)throw new s.ErrnoError(28);if(!s.isFile(e.node.mode))throw new s.ErrnoError(43);var u,l,f=e.node.contents;if(!(o&2)&&f.buffer===fr)l=!1,u=f.byteOffset;else{if((n>0||n+t<f.length)&&(f.subarray?f=f.subarray(n,n+t):f=Array.prototype.slice.call(f,n,n+t)),l=!0,u=Vt(t),!u)throw new s.ErrnoError(48);X.set(f,u)}return{ptr:u,allocated:l}},msync:function(e,r,t,n,i){if(!s.isFile(e.node.mode))throw new s.ErrnoError(43);return i&2||G.stream_ops.write(e,r,0,n,t,!1),0}}};function Ni(e,r,t,n){var i=n?"":"al "+e;we(e,function(o){Xe(o,'Loading data file "'+e+'" failed (no arrayBuffer).'),r(new Uint8Array(o)),i&&Je()},function(o){if(t)t();else throw'Loading data file "'+e+'" failed.'}),i&&cr()}var s={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(e,r){if(e=Se.resolve(s.cwd(),e),r=r||{},!e)return{path:"",node:null};var t={follow_mount:!0,recurse_count:0};for(var n in t)r[n]===void 0&&(r[n]=t[n]);if(r.recurse_count>8)throw new s.ErrnoError(32);for(var i=z.normalizeArray(e.split("/").filter(function(p){return!!p}),!1),o=s.root,u="/",l=0;l<i.length;l++){var f=l===i.length-1;if(f&&r.parent)break;if(o=s.lookupNode(o,i[l]),u=z.join2(u,i[l]),s.isMountpoint(o)&&(!f||f&&r.follow_mount)&&(o=o.mounted.root),!f||r.follow)for(var v=0;s.isLink(o.mode);){var h=s.readlink(u);u=Se.resolve(z.dirname(u),h);var y=s.lookupPath(u,{recurse_count:r.recurse_count});if(o=y.node,v++>40)throw new s.ErrnoError(32)}}return{path:u,node:o}},getPath:function(e){for(var r;;){if(s.isRoot(e)){var t=e.mount.mountpoint;return r?t[t.length-1]!=="/"?t+"/"+r:t+r:t}r=r?e.name+"/"+r:e.name,e=e.parent}},hashName:function(e,r){for(var t=0,n=0;n<r.length;n++)t=(t<<5)-t+r.charCodeAt(n)|0;return(e+t>>>0)%s.nameTable.length},hashAddNode:function(e){var r=s.hashName(e.parent.id,e.name);e.name_next=s.nameTable[r],s.nameTable[r]=e},hashRemoveNode:function(e){var r=s.hashName(e.parent.id,e.name);if(s.nameTable[r]===e)s.nameTable[r]=e.name_next;else for(var t=s.nameTable[r];t;){if(t.name_next===e){t.name_next=e.name_next;break}t=t.name_next}},lookupNode:function(e,r){var t=s.mayLookup(e);if(t)throw new s.ErrnoError(t,e);for(var n=s.hashName(e.id,r),i=s.nameTable[n];i;i=i.name_next){var o=i.name;if(i.parent.id===e.id&&o===r)return i}return s.lookup(e,r)},createNode:function(e,r,t,n){var i=new s.FSNode(e,r,t,n);return s.hashAddNode(i),i},destroyNode:function(e){s.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return(e&61440)===32768},isDir:function(e){return(e&61440)===16384},isLink:function(e){return(e&61440)===40960},isChrdev:function(e){return(e&61440)===8192},isBlkdev:function(e){return(e&61440)===24576},isFIFO:function(e){return(e&61440)===4096},isSocket:function(e){return(e&49152)===49152},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:function(e){var r=s.flagModes[e];if(typeof r>"u")throw new Error("Unknown file open mode: "+e);return r},flagsToPermissionString:function(e){var r=["r","w","rw"][e&3];return e&512&&(r+="w"),r},nodePermissions:function(e,r){return s.ignorePermissions?0:r.includes("r")&&!(e.mode&292)||r.includes("w")&&!(e.mode&146)||r.includes("x")&&!(e.mode&73)?2:0},mayLookup:function(e){var r=s.nodePermissions(e,"x");return r||(e.node_ops.lookup?0:2)},mayCreate:function(e,r){try{var t=s.lookupNode(e,r);return 20}catch{}return s.nodePermissions(e,"wx")},mayDelete:function(e,r,t){var n;try{n=s.lookupNode(e,r)}catch(o){return o.errno}var i=s.nodePermissions(e,"wx");if(i)return i;if(t){if(!s.isDir(n.mode))return 54;if(s.isRoot(n)||s.getPath(n)===s.cwd())return 10}else if(s.isDir(n.mode))return 31;return 0},mayOpen:function(e,r){return e?s.isLink(e.mode)?32:s.isDir(e.mode)&&(s.flagsToPermissionString(r)!=="r"||r&512)?31:s.nodePermissions(e,s.flagsToPermissionString(r)):44},MAX_OPEN_FDS:4096,nextfd:function(e,r){e=e||0,r=r||s.MAX_OPEN_FDS;for(var t=e;t<=r;t++)if(!s.streams[t])return t;throw new s.ErrnoError(33)},getStream:function(e){return s.streams[e]},createStream:function(e,r,t){s.FSStream||(s.FSStream=function(){},s.FSStream.prototype={object:{get:function(){return this.node},set:function(u){this.node=u}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}}});var n=new s.FSStream;for(var i in e)n[i]=e[i];e=n;var o=s.nextfd(r,t);return e.fd=o,s.streams[o]=e,e},closeStream:function(e){s.streams[e]=null},chrdev_stream_ops:{open:function(e){var r=s.getDevice(e.node.rdev);e.stream_ops=r.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new s.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return e&255},makedev:function(e,r){return e<<8|r},registerDevice:function(e,r){s.devices[e]={stream_ops:r}},getDevice:function(e){return s.devices[e]},getMounts:function(e){for(var r=[],t=[e];t.length;){var n=t.pop();r.push(n),t.push.apply(t,n.mounts)}return r},syncfs:function(e,r){typeof e=="function"&&(r=e,e=!1),s.syncFSRequests++,s.syncFSRequests>1&&te("warning: "+s.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var t=s.getMounts(s.root.mount),n=0;function i(u){return s.syncFSRequests--,r(u)}function o(u){if(u)return o.errored?void 0:(o.errored=!0,i(u));++n>=t.length&&i(null)}t.forEach(function(u){if(!u.type.syncfs)return o(null);u.type.syncfs(u,e,o)})},mount:function(e,r,t){var n=t==="/",i=!t,o;if(n&&s.root)throw new s.ErrnoError(10);if(!n&&!i){var u=s.lookupPath(t,{follow_mount:!1});if(t=u.path,o=u.node,s.isMountpoint(o))throw new s.ErrnoError(10);if(!s.isDir(o.mode))throw new s.ErrnoError(54)}var l={type:e,opts:r,mountpoint:t,mounts:[]},f=e.mount(l);return f.mount=l,l.root=f,n?s.root=f:o&&(o.mounted=l,o.mount&&o.mount.mounts.push(l)),f},unmount:function(e){var r=s.lookupPath(e,{follow_mount:!1});if(!s.isMountpoint(r.node))throw new s.ErrnoError(28);var t=r.node,n=t.mounted,i=s.getMounts(n);Object.keys(s.nameTable).forEach(function(u){for(var l=s.nameTable[u];l;){var f=l.name_next;i.includes(l.mount)&&s.destroyNode(l),l=f}}),t.mounted=null;var o=t.mount.mounts.indexOf(n);t.mount.mounts.splice(o,1)},lookup:function(e,r){return e.node_ops.lookup(e,r)},mknod:function(e,r,t){var n=s.lookupPath(e,{parent:!0}),i=n.node,o=z.basename(e);if(!o||o==="."||o==="..")throw new s.ErrnoError(28);var u=s.mayCreate(i,o);if(u)throw new s.ErrnoError(u);if(!i.node_ops.mknod)throw new s.ErrnoError(63);return i.node_ops.mknod(i,o,r,t)},create:function(e,r){return r=r!==void 0?r:438,r&=4095,r|=32768,s.mknod(e,r,0)},mkdir:function(e,r){return r=r!==void 0?r:511,r&=1023,r|=16384,s.mknod(e,r,0)},mkdirTree:function(e,r){for(var t=e.split("/"),n="",i=0;i<t.length;++i)if(!!t[i]){n+="/"+t[i];try{s.mkdir(n,r)}catch(o){if(o.errno!=20)throw o}}},mkdev:function(e,r,t){return typeof t>"u"&&(t=r,r=438),r|=8192,s.mknod(e,r,t)},symlink:function(e,r){if(!Se.resolve(e))throw new s.ErrnoError(44);var t=s.lookupPath(r,{parent:!0}),n=t.node;if(!n)throw new s.ErrnoError(44);var i=z.basename(r),o=s.mayCreate(n,i);if(o)throw new s.ErrnoError(o);if(!n.node_ops.symlink)throw new s.ErrnoError(63);return n.node_ops.symlink(n,i,e)},rename:function(e,r){var t=z.dirname(e),n=z.dirname(r),i=z.basename(e),o=z.basename(r),u,l,f;if(u=s.lookupPath(e,{parent:!0}),l=u.node,u=s.lookupPath(r,{parent:!0}),f=u.node,!l||!f)throw new s.ErrnoError(44);if(l.mount!==f.mount)throw new s.ErrnoError(75);var v=s.lookupNode(l,i),h=Se.relative(e,n);if(h.charAt(0)!==".")throw new s.ErrnoError(28);if(h=Se.relative(r,t),h.charAt(0)!==".")throw new s.ErrnoError(55);var y;try{y=s.lookupNode(f,o)}catch{}if(v!==y){var p=s.isDir(v.mode),x=s.mayDelete(l,i,p);if(x)throw new s.ErrnoError(x);if(x=y?s.mayDelete(f,o,p):s.mayCreate(f,o),x)throw new s.ErrnoError(x);if(!l.node_ops.rename)throw new s.ErrnoError(63);if(s.isMountpoint(v)||y&&s.isMountpoint(y))throw new s.ErrnoError(10);if(f!==l&&(x=s.nodePermissions(l,"w"),x))throw new s.ErrnoError(x);s.hashRemoveNode(v);try{l.node_ops.rename(v,f,o)}catch(P){throw P}finally{s.hashAddNode(v)}}},rmdir:function(e){var r=s.lookupPath(e,{parent:!0}),t=r.node,n=z.basename(e),i=s.lookupNode(t,n),o=s.mayDelete(t,n,!0);if(o)throw new s.ErrnoError(o);if(!t.node_ops.rmdir)throw new s.ErrnoError(63);if(s.isMountpoint(i))throw new s.ErrnoError(10);t.node_ops.rmdir(t,n),s.destroyNode(i)},readdir:function(e){var r=s.lookupPath(e,{follow:!0}),t=r.node;if(!t.node_ops.readdir)throw new s.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var r=s.lookupPath(e,{parent:!0}),t=r.node;if(!t)throw new s.ErrnoError(44);var n=z.basename(e),i=s.lookupNode(t,n),o=s.mayDelete(t,n,!1);if(o)throw new s.ErrnoError(o);if(!t.node_ops.unlink)throw new s.ErrnoError(63);if(s.isMountpoint(i))throw new s.ErrnoError(10);t.node_ops.unlink(t,n),s.destroyNode(i)},readlink:function(e){var r=s.lookupPath(e),t=r.node;if(!t)throw new s.ErrnoError(44);if(!t.node_ops.readlink)throw new s.ErrnoError(28);return Se.resolve(s.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,r){var t=s.lookupPath(e,{follow:!r}),n=t.node;if(!n)throw new s.ErrnoError(44);if(!n.node_ops.getattr)throw new s.ErrnoError(63);return n.node_ops.getattr(n)},lstat:function(e){return s.stat(e,!0)},chmod:function(e,r,t){var n;if(typeof e=="string"){var i=s.lookupPath(e,{follow:!t});n=i.node}else n=e;if(!n.node_ops.setattr)throw new s.ErrnoError(63);n.node_ops.setattr(n,{mode:r&4095|n.mode&-4096,timestamp:Date.now()})},lchmod:function(e,r){s.chmod(e,r,!0)},fchmod:function(e,r){var t=s.getStream(e);if(!t)throw new s.ErrnoError(8);s.chmod(t.node,r)},chown:function(e,r,t,n){var i;if(typeof e=="string"){var o=s.lookupPath(e,{follow:!n});i=o.node}else i=e;if(!i.node_ops.setattr)throw new s.ErrnoError(63);i.node_ops.setattr(i,{timestamp:Date.now()})},lchown:function(e,r,t){s.chown(e,r,t,!0)},fchown:function(e,r,t){var n=s.getStream(e);if(!n)throw new s.ErrnoError(8);s.chown(n.node,r,t)},truncate:function(e,r){if(r<0)throw new s.ErrnoError(28);var t;if(typeof e=="string"){var n=s.lookupPath(e,{follow:!0});t=n.node}else t=e;if(!t.node_ops.setattr)throw new s.ErrnoError(63);if(s.isDir(t.mode))throw new s.ErrnoError(31);if(!s.isFile(t.mode))throw new s.ErrnoError(28);var i=s.nodePermissions(t,"w");if(i)throw new s.ErrnoError(i);t.node_ops.setattr(t,{size:r,timestamp:Date.now()})},ftruncate:function(e,r){var t=s.getStream(e);if(!t)throw new s.ErrnoError(8);if((t.flags&2097155)===0)throw new s.ErrnoError(28);s.truncate(t.node,r)},utime:function(e,r,t){var n=s.lookupPath(e,{follow:!0}),i=n.node;i.node_ops.setattr(i,{timestamp:Math.max(r,t)})},open:function(e,r,t,n,i){if(e==="")throw new s.ErrnoError(44);r=typeof r=="string"?s.modeStringToFlags(r):r,t=typeof t>"u"?438:t,r&64?t=t&4095|32768:t=0;var o;if(typeof e=="object")o=e;else{e=z.normalize(e);try{var u=s.lookupPath(e,{follow:!(r&131072)});o=u.node}catch{}}var l=!1;if(r&64)if(o){if(r&128)throw new s.ErrnoError(20)}else o=s.mknod(e,t,0),l=!0;if(!o)throw new s.ErrnoError(44);if(s.isChrdev(o.mode)&&(r&=-513),r&65536&&!s.isDir(o.mode))throw new s.ErrnoError(54);if(!l){var f=s.mayOpen(o,r);if(f)throw new s.ErrnoError(f)}r&512&&s.truncate(o,0),r&=-131713;var v=s.createStream({node:o,path:s.getPath(o),id:o.id,flags:r,mode:o.mode,seekable:!0,position:0,stream_ops:o.stream_ops,node_ops:o.node_ops,ungotten:[],error:!1},n,i);return v.stream_ops.open&&v.stream_ops.open(v),a.logReadFiles&&!(r&1)&&(s.readFiles||(s.readFiles={}),e in s.readFiles||(s.readFiles[e]=1)),v},close:function(e){if(s.isClosed(e))throw new s.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(r){throw r}finally{s.closeStream(e.fd)}e.fd=null},isClosed:function(e){return e.fd===null},llseek:function(e,r,t){if(s.isClosed(e))throw new s.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new s.ErrnoError(70);if(t!=0&&t!=1&&t!=2)throw new s.ErrnoError(28);return e.position=e.stream_ops.llseek(e,r,t),e.ungotten=[],e.position},read:function(e,r,t,n,i){if(n<0||i<0)throw new s.ErrnoError(28);if(s.isClosed(e))throw new s.ErrnoError(8);if((e.flags&2097155)===1)throw new s.ErrnoError(8);if(s.isDir(e.node.mode))throw new s.ErrnoError(31);if(!e.stream_ops.read)throw new s.ErrnoError(28);var o=typeof i<"u";if(!o)i=e.position;else if(!e.seekable)throw new s.ErrnoError(70);var u=e.stream_ops.read(e,r,t,n,i);return o||(e.position+=u),u},write:function(e,r,t,n,i,o){if(n<0||i<0)throw new s.ErrnoError(28);if(s.isClosed(e))throw new s.ErrnoError(8);if((e.flags&2097155)===0)throw new s.ErrnoError(8);if(s.isDir(e.node.mode))throw new s.ErrnoError(31);if(!e.stream_ops.write)throw new s.ErrnoError(28);e.seekable&&e.flags&1024&&s.llseek(e,0,2);var u=typeof i<"u";if(!u)i=e.position;else if(!e.seekable)throw new s.ErrnoError(70);var l=e.stream_ops.write(e,r,t,n,i,o);return u||(e.position+=l),l},allocate:function(e,r,t){if(s.isClosed(e))throw new s.ErrnoError(8);if(r<0||t<=0)throw new s.ErrnoError(28);if((e.flags&2097155)===0)throw new s.ErrnoError(8);if(!s.isFile(e.node.mode)&&!s.isDir(e.node.mode))throw new s.ErrnoError(43);if(!e.stream_ops.allocate)throw new s.ErrnoError(138);e.stream_ops.allocate(e,r,t)},mmap:function(e,r,t,n,i,o){if((i&2)!==0&&(o&2)===0&&(e.flags&2097155)!==2)throw new s.ErrnoError(2);if((e.flags&2097155)===1)throw new s.ErrnoError(2);if(!e.stream_ops.mmap)throw new s.ErrnoError(43);return e.stream_ops.mmap(e,r,t,n,i,o)},msync:function(e,r,t,n,i){return!e||!e.stream_ops.msync?0:e.stream_ops.msync(e,r,t,n,i)},munmap:function(e){return 0},ioctl:function(e,r,t){if(!e.stream_ops.ioctl)throw new s.ErrnoError(59);return e.stream_ops.ioctl(e,r,t)},readFile:function(e,r){if(r=r||{},r.flags=r.flags||0,r.encoding=r.encoding||"binary",r.encoding!=="utf8"&&r.encoding!=="binary")throw new Error('Invalid encoding type "'+r.encoding+'"');var t,n=s.open(e,r.flags),i=s.stat(e),o=i.size,u=new Uint8Array(o);return s.read(n,u,0,o,0),r.encoding==="utf8"?t=Ue(u,0):r.encoding==="binary"&&(t=u),s.close(n),t},writeFile:function(e,r,t){t=t||{},t.flags=t.flags||577;var n=s.open(e,t.flags,t.mode);if(typeof r=="string"){var i=new Uint8Array(De(r)+1),o=lr(r,i,0,i.length);s.write(n,i,0,o,void 0,t.canOwn)}else if(ArrayBuffer.isView(r))s.write(n,r,0,r.byteLength,void 0,t.canOwn);else throw new Error("Unsupported data type");s.close(n)},cwd:function(){return s.currentPath},chdir:function(e){var r=s.lookupPath(e,{follow:!0});if(r.node===null)throw new s.ErrnoError(44);if(!s.isDir(r.node.mode))throw new s.ErrnoError(54);var t=s.nodePermissions(r.node,"x");if(t)throw new s.ErrnoError(t);s.currentPath=r.path},createDefaultDirectories:function(){s.mkdir("/tmp"),s.mkdir("/home"),s.mkdir("/home/web_user")},createDefaultDevices:function(){s.mkdir("/dev"),s.registerDevice(s.makedev(1,3),{read:function(){return 0},write:function(r,t,n,i,o){return i}}),s.mkdev("/dev/null",s.makedev(1,3)),Oe.register(s.makedev(5,0),Oe.default_tty_ops),Oe.register(s.makedev(6,0),Oe.default_tty1_ops),s.mkdev("/dev/tty",s.makedev(5,0)),s.mkdev("/dev/tty1",s.makedev(6,0));var e=Gt();s.createDevice("/dev","random",e),s.createDevice("/dev","urandom",e),s.mkdir("/dev/shm"),s.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){s.mkdir("/proc");var e=s.mkdir("/proc/self");s.mkdir("/proc/self/fd"),s.mount({mount:function(){var r=s.createNode(e,"fd",16895,73);return r.node_ops={lookup:function(t,n){var i=+n,o=s.getStream(i);if(!o)throw new s.ErrnoError(8);var u={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return o.path}}};return u.parent=u,u}},r}},{},"/proc/self/fd")},createStandardStreams:function(){a.stdin?s.createDevice("/dev","stdin",a.stdin):s.symlink("/dev/tty","/dev/stdin"),a.stdout?s.createDevice("/dev","stdout",null,a.stdout):s.symlink("/dev/tty","/dev/stdout"),a.stderr?s.createDevice("/dev","stderr",null,a.stderr):s.symlink("/dev/tty1","/dev/stderr"),s.open("/dev/stdin",0),s.open("/dev/stdout",1),s.open("/dev/stderr",1)},ensureErrnoError:function(){s.ErrnoError||(s.ErrnoError=function(r,t){this.node=t,this.setErrno=function(n){this.errno=n},this.setErrno(r),this.message="FS error"},s.ErrnoError.prototype=new Error,s.ErrnoError.prototype.constructor=s.ErrnoError,[44].forEach(function(e){s.genericErrors[e]=new s.ErrnoError(e),s.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:function(){s.ensureErrnoError(),s.nameTable=new Array(4096),s.mount(G,{},"/"),s.createDefaultDirectories(),s.createDefaultDevices(),s.createSpecialDirectories(),s.filesystems={MEMFS:G}},init:function(e,r,t){s.init.initialized=!0,s.ensureErrnoError(),a.stdin=e||a.stdin,a.stdout=r||a.stdout,a.stderr=t||a.stderr,s.createStandardStreams()},quit:function(){s.init.initialized=!1;for(var e=0;e<s.streams.length;e++){var r=s.streams[e];!r||s.close(r)}},getMode:function(e,r){var t=0;return e&&(t|=365),r&&(t|=146),t},findObject:function(e,r){var t=s.analyzePath(e,r);return t.exists?t.object:null},analyzePath:function(e,r){try{var t=s.lookupPath(e,{follow:!r});e=t.path}catch{}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var t=s.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=t.path,n.parentObject=t.node,n.name=z.basename(e),t=s.lookupPath(e,{follow:!r}),n.exists=!0,n.path=t.path,n.object=t.node,n.name=t.node.name,n.isRoot=t.path==="/"}catch(i){n.error=i.errno}return n},createPath:function(e,r,t,n){e=typeof e=="string"?e:s.getPath(e);for(var i=r.split("/").reverse();i.length;){var o=i.pop();if(!!o){var u=z.join2(e,o);try{s.mkdir(u)}catch{}e=u}}return u},createFile:function(e,r,t,n,i){var o=z.join2(typeof e=="string"?e:s.getPath(e),r),u=s.getMode(n,i);return s.create(o,u)},createDataFile:function(e,r,t,n,i,o){var u=r?z.join2(typeof e=="string"?e:s.getPath(e),r):e,l=s.getMode(n,i),f=s.create(u,l);if(t){if(typeof t=="string"){for(var v=new Array(t.length),h=0,y=t.length;h<y;++h)v[h]=t.charCodeAt(h);t=v}s.chmod(f,l|146);var p=s.open(f,577);s.write(p,t,0,t.length,0,o),s.close(p),s.chmod(f,l)}return f},createDevice:function(e,r,t,n){var i=z.join2(typeof e=="string"?e:s.getPath(e),r),o=s.getMode(!!t,!!n);s.createDevice.major||(s.createDevice.major=64);var u=s.makedev(s.createDevice.major++,0);return s.registerDevice(u,{open:function(l){l.seekable=!1},close:function(l){n&&n.buffer&&n.buffer.length&&n(10)},read:function(l,f,v,h,y){for(var p=0,x=0;x<h;x++){var P;try{P=t()}catch{throw new s.ErrnoError(29)}if(P===void 0&&p===0)throw new s.ErrnoError(6);if(P==null)break;p++,f[v+x]=P}return p&&(l.node.timestamp=Date.now()),p},write:function(l,f,v,h,y){for(var p=0;p<h;p++)try{n(f[v+p])}catch{throw new s.ErrnoError(29)}return h&&(l.node.timestamp=Date.now()),p}}),s.mkdev(i,o,u)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(Q)try{e.contents=He(Q(e.url),!0),e.usedBytes=e.contents.length}catch{throw new s.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:function(e,r,t,n,i){function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(p){if(!(p>this.length-1||p<0)){var x=p%this.chunkSize,P=p/this.chunkSize|0;return this.getter(P)[x]}},o.prototype.setDataGetter=function(p){this.getter=p},o.prototype.cacheLength=function(){var p=new XMLHttpRequest;if(p.open("HEAD",t,!1),p.send(null),!(p.status>=200&&p.status<300||p.status===304))throw new Error("Couldn't load "+t+". Status: "+p.status);var x=Number(p.getResponseHeader("Content-length")),P,j=(P=p.getResponseHeader("Accept-Ranges"))&&P==="bytes",I=(P=p.getResponseHeader("Content-Encoding"))&&P==="gzip",N=1024*1024;j||(N=x);var k=function(U,R){if(U>R)throw new Error("invalid range ("+U+", "+R+") or no bytes requested!");if(R>x-1)throw new Error("only "+x+" bytes available! programmer error!");var B=new XMLHttpRequest;if(B.open("GET",t,!1),x!==N&&B.setRequestHeader("Range","bytes="+U+"-"+R),typeof Uint8Array<"u"&&(B.responseType="arraybuffer"),B.overrideMimeType&&B.overrideMimeType("text/plain; charset=x-user-defined"),B.send(null),!(B.status>=200&&B.status<300||B.status===304))throw new Error("Couldn't load "+t+". Status: "+B.status);return B.response!==void 0?new Uint8Array(B.response||[]):He(B.responseText||"",!0)},D=this;D.setDataGetter(function(U){var R=U*N,B=(U+1)*N-1;if(B=Math.min(B,x-1),typeof D.chunks[U]>"u"&&(D.chunks[U]=k(R,B)),typeof D.chunks[U]>"u")throw new Error("doXHR failed!");return D.chunks[U]}),(I||!x)&&(N=x=1,x=this.getter(0).length,N=x,re("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=x,this._chunkSize=N,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var u,l}else var l={isDevice:!1,url:t};var f=s.createFile(e,r,l,n,i);l.contents?f.contents=l.contents:l.url&&(f.contents=null,f.url=l.url),Object.defineProperties(f,{usedBytes:{get:function(){return this.contents.length}}});var v={},h=Object.keys(f.stream_ops);return h.forEach(function(y){var p=f.stream_ops[y];v[y]=function(){return s.forceLoadFile(f),p.apply(null,arguments)}}),v.read=function(p,x,P,j,I){s.forceLoadFile(f);var N=p.node.contents;if(I>=N.length)return 0;var k=Math.min(N.length-I,j);if(N.slice)for(var D=0;D<k;D++)x[P+D]=N[I+D];else for(var D=0;D<k;D++)x[P+D]=N.get(I+D);return k},f.stream_ops=v,f},createPreloadedFile:function(e,r,t,n,i,o,u,l,f,v){b.init();var h=r?Se.resolve(z.join2(e,r)):e;function y(p){function x(j){v&&v(),l||s.createDataFile(e,r,j,n,i,f),o&&o(),Je()}var P=!1;a.preloadPlugins.forEach(function(j){P||j.canHandle(h)&&(j.handle(p,h,x,function(){u&&u(),Je()}),P=!0)}),P||x(p)}cr(),typeof t=="string"?Ni(t,function(p){y(p)},u):y(t)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,r,t){r=r||function(){},t=t||function(){};var n=s.indexedDB();try{var i=n.open(s.DB_NAME(),s.DB_VERSION)}catch(o){return t(o)}i.onupgradeneeded=function(){re("creating db");var u=i.result;u.createObjectStore(s.DB_STORE_NAME)},i.onsuccess=function(){var u=i.result,l=u.transaction([s.DB_STORE_NAME],"readwrite"),f=l.objectStore(s.DB_STORE_NAME),v=0,h=0,y=e.length;function p(){h==0?r():t()}e.forEach(function(x){var P=f.put(s.analyzePath(x).object.contents,x);P.onsuccess=function(){v++,v+h==y&&p()},P.onerror=function(){h++,v+h==y&&p()}}),l.onerror=t},i.onerror=t},loadFilesFromDB:function(e,r,t){r=r||function(){},t=t||function(){};var n=s.indexedDB();try{var i=n.open(s.DB_NAME(),s.DB_VERSION)}catch(o){return t(o)}i.onupgradeneeded=t,i.onsuccess=function(){var u=i.result;try{var l=u.transaction([s.DB_STORE_NAME],"readonly")}catch(x){t(x);return}var f=l.objectStore(s.DB_STORE_NAME),v=0,h=0,y=e.length;function p(){h==0?r():t()}e.forEach(function(x){var P=f.get(x);P.onsuccess=function(){s.analyzePath(x).exists&&s.unlink(x),s.createDataFile(z.dirname(x),z.basename(x),P.result,!0,!0,!0),v++,v+h==y&&p()},P.onerror=function(){h++,v+h==y&&p()}}),l.onerror=t},i.onerror=t}},V={mappings:{},DEFAULT_POLLMASK:5,calculateAt:function(e,r,t){if(r[0]==="/")return r;var n;if(e===-100)n=s.cwd();else{var i=s.getStream(e);if(!i)throw new s.ErrnoError(8);n=i.path}if(r.length==0){if(!t)throw new s.ErrnoError(44);return n}return z.join2(n,r)},doStat:function(e,r,t){try{var n=e(r)}catch(i){if(i&&i.node&&z.normalize(r)!==z.normalize(s.getPath(i.node)))return-54;throw i}return g[t>>2]=n.dev,g[t+4>>2]=0,g[t+8>>2]=n.ino,g[t+12>>2]=n.mode,g[t+16>>2]=n.nlink,g[t+20>>2]=n.uid,g[t+24>>2]=n.gid,g[t+28>>2]=n.rdev,g[t+32>>2]=0,ae=[n.size>>>0,(H=n.size,+Math.abs(H)>=1?H>0?(Math.min(+Math.floor(H/4294967296),4294967295)|0)>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],g[t+40>>2]=ae[0],g[t+44>>2]=ae[1],g[t+48>>2]=4096,g[t+52>>2]=n.blocks,g[t+56>>2]=n.atime.getTime()/1e3|0,g[t+60>>2]=0,g[t+64>>2]=n.mtime.getTime()/1e3|0,g[t+68>>2]=0,g[t+72>>2]=n.ctime.getTime()/1e3|0,g[t+76>>2]=0,ae=[n.ino>>>0,(H=n.ino,+Math.abs(H)>=1?H>0?(Math.min(+Math.floor(H/4294967296),4294967295)|0)>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],g[t+80>>2]=ae[0],g[t+84>>2]=ae[1],0},doMsync:function(e,r,t,n,i){var o=q.slice(e,e+t);s.msync(r,o,i,t,n)},doMkdir:function(e,r){return e=z.normalize(e),e[e.length-1]==="/"&&(e=e.substr(0,e.length-1)),s.mkdir(e,r,0),0},doMknod:function(e,r,t){switch(r&61440){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return s.mknod(e,r,t),0},doReadlink:function(e,r,t){if(t<=0)return-28;var n=s.readlink(e),i=Math.min(t,De(n)),o=X[r+i];return Pe(n,r,t+1),X[r+i]=o,i},doAccess:function(e,r){if(r&-8)return-28;var t=s.lookupPath(e,{follow:!0}),n=t.node;if(!n)return-44;var i="";return r&4&&(i+="r"),r&2&&(i+="w"),r&1&&(i+="x"),i&&s.nodePermissions(n,i)?-2:0},doDup:function(e,r,t){var n=s.getStream(t);return n&&s.close(n),s.open(e,r,0,t,t).fd},doReadv:function(e,r,t,n){for(var i=0,o=0;o<t;o++){var u=g[r+o*8>>2],l=g[r+(o*8+4)>>2],f=s.read(e,X,u,l,n);if(f<0)return-1;if(i+=f,f<l)break}return i},doWritev:function(e,r,t,n){for(var i=0,o=0;o<t;o++){var u=g[r+o*8>>2],l=g[r+(o*8+4)>>2],f=s.write(e,X,u,l,n);if(f<0)return-1;i+=f}return i},varargs:void 0,get:function(){V.varargs+=4;var e=g[V.varargs-4>>2];return e},getStr:function(e){var r=Ce(e);return r},getStreamFromFD:function(e){var r=s.getStream(e);if(!r)throw new s.ErrnoError(8);return r},get64:function(e,r){return e}};function Ui(e,r,t){V.varargs=t;try{var n=V.getStreamFromFD(e);switch(r){case 0:{var i=V.get();if(i<0)return-28;var o;return o=s.open(n.path,n.flags,0,i),o.fd}case 1:case 2:return 0;case 3:return n.flags;case 4:{var i=V.get();return n.flags|=i,0}case 5:{var i=V.get(),u=0;return ue[i+u>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return Bt(28),-1;default:return-28}}catch(l){if(typeof s>"u"||!(l instanceof s.ErrnoError))throw l;return-l.errno}}function Gi(e,r,t,n){try{r=V.getStr(r);var i=n&256,o=n&4096;return n=n&-4353,r=V.calculateAt(e,r,o),V.doStat(i?s.lstat:s.stat,r,t)}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return-u.errno}}function Vi(e,r,t){try{var n=V.get64(r,t);return s.ftruncate(e,n),0}catch(i){if(typeof s>"u"||!(i instanceof s.ErrnoError))throw i;return-i.errno}}function $i(e,r){try{if(r===0)return-28;var t=s.cwd(),n=De(t);return r<n+1?-68:(Pe(t,e,r),e)}catch(i){if(typeof s>"u"||!(i instanceof s.ErrnoError))throw i;return-i.errno}}function Wi(e,r,t){try{var n=V.getStreamFromFD(e);n.getdents||(n.getdents=s.readdir(n.path));for(var i=280,o=0,u=s.llseek(n,0,1),l=Math.floor(u/i);l<n.getdents.length&&o+i<=t;){var f,v,h=n.getdents[l];if(h===".")f=n.id,v=4;else if(h===".."){var y=s.lookupPath(n.path,{parent:!0});f=y.node.id,v=4}else{var p=s.lookupNode(n,h);f=p.id,v=s.isChrdev(p.mode)?2:s.isDir(p.mode)?4:s.isLink(p.mode)?10:8}ae=[f>>>0,(H=f,+Math.abs(H)>=1?H>0?(Math.min(+Math.floor(H/4294967296),4294967295)|0)>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],g[r+o>>2]=ae[0],g[r+o+4>>2]=ae[1],ae=[(l+1)*i>>>0,(H=(l+1)*i,+Math.abs(H)>=1?H>0?(Math.min(+Math.floor(H/4294967296),4294967295)|0)>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],g[r+o+8>>2]=ae[0],g[r+o+12>>2]=ae[1],ue[r+o+16>>1]=280,X[r+o+18>>0]=v,Pe(h,r+o+19,256),o+=i,l+=1}return s.llseek(n,l*i,0),o}catch(x){if(typeof s>"u"||!(x instanceof s.ErrnoError))throw x;return-x.errno}}function zi(e,r,t){V.varargs=t;try{var n=V.getStreamFromFD(e);switch(r){case 21509:case 21505:return n.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-59;case 21519:{if(!n.tty)return-59;var i=V.get();return g[i>>2]=0,0}case 21520:return n.tty?-28:-59;case 21531:{var i=V.get();return s.ioctl(n,r,i)}case 21523:return n.tty?0:-59;case 21524:return n.tty?0:-59;default:he("bad ioctl syscall "+r)}}catch(o){if(typeof s>"u"||!(o instanceof s.ErrnoError))throw o;return-o.errno}}function Hi(e,r){try{return e=V.getStr(e),V.doStat(s.lstat,e,r)}catch(t){if(typeof s>"u"||!(t instanceof s.ErrnoError))throw t;return-t.errno}}function qi(e,r){try{return e=V.getStr(e),V.doMkdir(e,r)}catch(t){if(typeof s>"u"||!(t instanceof s.ErrnoError))throw t;return-t.errno}}function Qi(e,r,t,n,i,o){o<<=12;var u,l=!1;if((n&16)!==0&&e%65536!==0)return-28;if((n&32)!==0){if(u=Vt(r),!u)return-48;l=!0}else{var f=s.getStream(i);if(!f)return-8;var v=s.mmap(f,e,r,o,t,n);u=v.ptr,l=v.allocated}return V.mappings[u]={malloc:u,len:r,allocated:l,fd:i,prot:t,flags:n,offset:o},u}function Yi(e,r,t,n,i,o){try{return Qi(e,r,t,n,i,o)}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return-u.errno}}function Xi(e,r){var t=V.mappings[e];if(r===0||!t)return-28;if(r===t.len){var n=s.getStream(t.fd);n&&(t.prot&2&&V.doMsync(e,n,r,t.flags,t.offset),s.munmap(n)),V.mappings[e]=null,t.allocated&&ye(t.malloc)}return 0}function Ki(e,r){try{return Xi(e,r)}catch(t){if(typeof s>"u"||!(t instanceof s.ErrnoError))throw t;return-t.errno}}function Ji(e,r,t){V.varargs=t;try{var n=V.getStr(e),i=t?V.get():0,o=s.open(n,r,i);return o.fd}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return-u.errno}}function Zi(e,r,t){try{return e=V.getStr(e),V.doReadlink(e,r,t)}catch(n){if(typeof s>"u"||!(n instanceof s.ErrnoError))throw n;return-n.errno}}function ea(e,r){try{return e=V.getStr(e),V.doStat(s.stat,e,r)}catch(t){if(typeof s>"u"||!(t instanceof s.ErrnoError))throw t;return-t.errno}}function ra(e){try{return e=V.getStr(e),s.unlink(e),0}catch(r){if(typeof s>"u"||!(r instanceof s.ErrnoError))throw r;return-r.errno}}function ta(e,r){he("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function na(e,r){he("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function ia(e,r,t,n,i){}function _r(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function aa(){for(var e=new Array(256),r=0;r<256;++r)e[r]=String.fromCharCode(r);$t=e}var $t=void 0;function Z(e){for(var r="",t=e;q[t];)r+=$t[q[t++]];return r}var Ve={},Ie={},vr={},oa=48,sa=57;function hr(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var r=e.charCodeAt(0);return r>=oa&&r<=sa?"_"+e:e}function pr(e,r){return e=hr(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(r)}function Yr(e,r){var t=pr(r,function(n){this.name=r,this.message=n;var i=new Error(n).stack;i!==void 0&&(this.stack=this.toString()+`
`+i.replace(/^Error(:[^\n]*)?\n/,""))});return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},t}var $e=void 0;function $(e){throw new $e(e)}var Wt=void 0;function gr(e){throw new Wt(e)}function ce(e,r,t){e.forEach(function(l){vr[l]=r});function n(l){var f=t(l);f.length!==e.length&&gr("Mismatched type converter count");for(var v=0;v<e.length;++v)pe(e[v],f[v])}var i=new Array(r.length),o=[],u=0;r.forEach(function(l,f){Ie.hasOwnProperty(l)?i[f]=Ie[l]:(o.push(l),Ve.hasOwnProperty(l)||(Ve[l]=[]),Ve[l].push(function(){i[f]=Ie[l],++u,u===o.length&&n(i)}))}),o.length===0&&n(i)}function pe(e,r,t){if(t=t||{},!("argPackAdvance"in r))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=r.name;if(e||$('type "'+n+'" must have a positive integer typeid pointer'),Ie.hasOwnProperty(e)){if(t.ignoreDuplicateRegistrations)return;$("Cannot register type '"+n+"' twice")}if(Ie[e]=r,delete vr[e],Ve.hasOwnProperty(e)){var i=Ve[e];delete Ve[e],i.forEach(function(o){o()})}}function ua(e,r,t,n,i){var o=_r(t);r=Z(r),pe(e,{name:r,fromWireType:function(u){return!!u},toWireType:function(u,l){return l?n:i},argPackAdvance:8,readValueFromPointer:function(u){var l;if(t===1)l=X;else if(t===2)l=ue;else if(t===4)l=g;else throw new TypeError("Unknown boolean type size: "+r);return this.fromWireType(l[u>>o])},destructorFunction:null})}function la(e){if(!(this instanceof Fe)||!(e instanceof Fe))return!1;for(var r=this.$$.ptrType.registeredClass,t=this.$$.ptr,n=e.$$.ptrType.registeredClass,i=e.$$.ptr;r.baseClass;)t=r.upcast(t),r=r.baseClass;for(;n.baseClass;)i=n.upcast(i),n=n.baseClass;return r===n&&t===i}function fa(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Xr(e){function r(t){return t.$$.ptrType.registeredClass.name}$(r(e)+" instance already deleted")}var Kr=!1;function zt(e){}function ca(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function Ht(e){e.count.value-=1;var r=e.count.value===0;r&&ca(e)}function rr(e){return typeof T>"u"?(rr=function(r){return r},e):(Kr=new T(function(r){for(var t=r.next();!t.done;t=r.next()){var n=t.value;n.ptr?Ht(n):console.warn("object already deleted: "+n.ptr)}}),rr=function(r){return Kr.register(r,r.$$,r.$$),r},zt=function(r){Kr.unregister(r.$$)},rr(e))}function da(){if(this.$$.ptr||Xr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=rr(Object.create(Object.getPrototypeOf(this),{$$:{value:fa(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function ma(){this.$$.ptr||Xr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&$("Object already scheduled for deletion"),zt(this),Ht(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function _a(){return!this.$$.ptr}var tr=void 0,nr=[];function Jr(){for(;nr.length;){var e=nr.pop();e.$$.deleteScheduled=!1,e.delete()}}function va(){return this.$$.ptr||Xr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&$("Object already scheduled for deletion"),nr.push(this),nr.length===1&&tr&&tr(Jr),this.$$.deleteScheduled=!0,this}function ha(){Fe.prototype.isAliasOf=la,Fe.prototype.clone=da,Fe.prototype.delete=ma,Fe.prototype.isDeleted=_a,Fe.prototype.deleteLater=va}function Fe(){}var qt={};function Zr(e,r,t){if(e[r].overloadTable===void 0){var n=e[r];e[r]=function(){return e[r].overloadTable.hasOwnProperty(arguments.length)||$("Function '"+t+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[r].overloadTable+")!"),e[r].overloadTable[arguments.length].apply(this,arguments)},e[r].overloadTable=[],e[r].overloadTable[n.argCount]=n}}function et(e,r,t){a.hasOwnProperty(e)?((t===void 0||a[e].overloadTable!==void 0&&a[e].overloadTable[t]!==void 0)&&$("Cannot register public name '"+e+"' twice"),Zr(a,e,e),a.hasOwnProperty(t)&&$("Cannot register multiple overloads of a function with the same number of arguments ("+t+")!"),a[e].overloadTable[t]=r):(a[e]=r,t!==void 0&&(a[e].numArguments=t))}function pa(e,r,t,n,i,o,u,l){this.name=e,this.constructor=r,this.instancePrototype=t,this.rawDestructor=n,this.baseClass=i,this.getActualType=o,this.upcast=u,this.downcast=l,this.pureVirtualFunctions=[]}function br(e,r,t){for(;r!==t;)r.upcast||$("Expected null or instance of "+t.name+", got an instance of "+r.name),e=r.upcast(e),r=r.baseClass;return e}function ga(e,r){if(r===null)return this.isReference&&$("null is not a valid "+this.name),0;r.$$||$('Cannot pass "'+it(r)+'" as a '+this.name),r.$$.ptr||$("Cannot pass deleted object as a pointer of type "+this.name);var t=r.$$.ptrType.registeredClass,n=br(r.$$.ptr,t,this.registeredClass);return n}function ba(e,r){var t;if(r===null)return this.isReference&&$("null is not a valid "+this.name),this.isSmartPointer?(t=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,t),t):0;r.$$||$('Cannot pass "'+it(r)+'" as a '+this.name),r.$$.ptr||$("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&r.$$.ptrType.isConst&&$("Cannot convert argument of type "+(r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name)+" to parameter type "+this.name);var n=r.$$.ptrType.registeredClass;if(t=br(r.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(r.$$.smartPtr===void 0&&$("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:r.$$.smartPtrType===this?t=r.$$.smartPtr:$("Cannot convert argument of type "+(r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:t=r.$$.smartPtr;break;case 2:if(r.$$.smartPtrType===this)t=r.$$.smartPtr;else{var i=r.clone();t=this.rawShare(t,K.toHandle(function(){i.delete()})),e!==null&&e.push(this.rawDestructor,t)}break;default:$("Unsupporting sharing policy")}return t}function ya(e,r){if(r===null)return this.isReference&&$("null is not a valid "+this.name),0;r.$$||$('Cannot pass "'+it(r)+'" as a '+this.name),r.$$.ptr||$("Cannot pass deleted object as a pointer of type "+this.name),r.$$.ptrType.isConst&&$("Cannot convert argument of type "+r.$$.ptrType.name+" to parameter type "+this.name);var t=r.$$.ptrType.registeredClass,n=br(r.$$.ptr,t,this.registeredClass);return n}function yr(e){return this.fromWireType(ne[e>>2])}function wa(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function Ea(e){this.rawDestructor&&this.rawDestructor(e)}function Ca(e){e!==null&&e.delete()}function Qt(e,r,t){if(r===t)return e;if(t.baseClass===void 0)return null;var n=Qt(e,r,t.baseClass);return n===null?null:t.downcast(n)}function Sa(){return Object.keys(ir).length}function xa(){var e=[];for(var r in ir)ir.hasOwnProperty(r)&&e.push(ir[r]);return e}function ka(e){tr=e,nr.length&&tr&&tr(Jr)}function Ta(){a.getInheritedInstanceCount=Sa,a.getLiveInheritedInstances=xa,a.flushPendingDeletes=Jr,a.setDelayFunction=ka}var ir={};function Pa(e,r){for(r===void 0&&$("ptr should not be undefined");e.baseClass;)r=e.upcast(r),e=e.baseClass;return r}function Da(e,r){return r=Pa(e,r),ir[r]}function wr(e,r){(!r.ptrType||!r.ptr)&&gr("makeClassHandle requires ptr and ptrType");var t=!!r.smartPtrType,n=!!r.smartPtr;return t!==n&&gr("Both smartPtrType and smartPtr must be specified"),r.count={value:1},rr(Object.create(e,{$$:{value:r}}))}function Fa(e){var r=this.getPointee(e);if(!r)return this.destructor(e),null;var t=Da(this.registeredClass,r);if(t!==void 0){if(t.$$.count.value===0)return t.$$.ptr=r,t.$$.smartPtr=e,t.clone();var n=t.clone();return this.destructor(e),n}function i(){return this.isSmartPointer?wr(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:r,smartPtrType:this,smartPtr:e}):wr(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var o=this.registeredClass.getActualType(r),u=qt[o];if(!u)return i.call(this);var l;this.isConst?l=u.constPointerType:l=u.pointerType;var f=Qt(r,this.registeredClass,l.registeredClass);return f===null?i.call(this):this.isSmartPointer?wr(l.registeredClass.instancePrototype,{ptrType:l,ptr:f,smartPtrType:this,smartPtr:e}):wr(l.registeredClass.instancePrototype,{ptrType:l,ptr:f})}function Aa(){ge.prototype.getPointee=wa,ge.prototype.destructor=Ea,ge.prototype.argPackAdvance=8,ge.prototype.readValueFromPointer=yr,ge.prototype.deleteObject=Ca,ge.prototype.fromWireType=Fa}function ge(e,r,t,n,i,o,u,l,f,v,h){this.name=e,this.registeredClass=r,this.isReference=t,this.isConst=n,this.isSmartPointer=i,this.pointeeType=o,this.sharingPolicy=u,this.rawGetPointee=l,this.rawConstructor=f,this.rawShare=v,this.rawDestructor=h,!i&&r.baseClass===void 0?n?(this.toWireType=ga,this.destructorFunction=null):(this.toWireType=ya,this.destructorFunction=null):this.toWireType=ba}function Yt(e,r,t){a.hasOwnProperty(e)||gr("Replacing nonexistant public symbol"),a[e].overloadTable!==void 0&&t!==void 0?a[e].overloadTable[t]=r:(a[e]=r,a[e].argCount=t)}function ja(e,r,t){var n=a["dynCall_"+e];return t&&t.length?n.apply(null,[r].concat(t)):n.call(null,r)}function Ma(e,r,t){return e.includes("j")?ja(e,r,t):mr(r).apply(null,t)}function La(e,r){var t=[];return function(){t.length=arguments.length;for(var n=0;n<arguments.length;n++)t[n]=arguments[n];return Ma(e,r,t)}}function oe(e,r){e=Z(e);function t(){return e.includes("j")?La(e,r):mr(r)}var n=t();return typeof n!="function"&&$("unknown function pointer with signature "+e+": "+r),n}var Xt=void 0;function Kt(e){var r=cn(e),t=Z(r);return ye(r),t}function Be(e,r){var t=[],n={};function i(o){if(!n[o]&&!Ie[o]){if(vr[o]){vr[o].forEach(i);return}t.push(o),n[o]=!0}}throw r.forEach(i),new Xt(e+": "+t.map(Kt).join([", "]))}function Ra(e,r,t,n,i,o,u,l,f,v,h,y,p){h=Z(h),o=oe(i,o),l&&(l=oe(u,l)),v&&(v=oe(f,v)),p=oe(y,p);var x=hr(h);et(x,function(){Be("Cannot construct "+h+" due to unbound types",[n])}),ce([e,r,t],n?[n]:[],function(P){P=P[0];var j,I;n?(j=P.registeredClass,I=j.instancePrototype):I=Fe.prototype;var N=pr(x,function(){if(Object.getPrototypeOf(this)!==k)throw new $e("Use 'new' to construct "+h);if(D.constructor_body===void 0)throw new $e(h+" has no accessible constructor");var Y=D.constructor_body[arguments.length];if(Y===void 0)throw new $e("Tried to invoke ctor of "+h+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(D.constructor_body).toString()+") parameters instead!");return Y.apply(this,arguments)}),k=Object.create(I,{constructor:{value:N}});N.prototype=k;var D=new pa(h,N,k,p,j,o,l,v),U=new ge(h,D,!0,!1,!1),R=new ge(h+"*",D,!1,!1,!1),B=new ge(h+" const*",D,!1,!0,!1);return qt[e]={pointerType:R,constPointerType:B},Yt(x,N),[U,R,B]})}function Jt(e,r){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var t=pr(e.name||"unknownFunctionName",function(){});t.prototype=e.prototype;var n=new t,i=e.apply(n,r);return i instanceof Object?i:n}function rt(e){for(;e.length;){var r=e.pop(),t=e.pop();t(r)}}function Er(e,r,t,n,i){var o=r.length;o<2&&$("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var u=r[1]!==null&&t!==null,l=!1,f=1;f<r.length;++f)if(r[f]!==null&&r[f].destructorFunction===void 0){l=!0;break}for(var v=r[0].name!=="void",h="",y="",f=0;f<o-2;++f)h+=(f!==0?", ":"")+"arg"+f,y+=(f!==0?", ":"")+"arg"+f+"Wired";var p="return function "+hr(e)+"("+h+`) {
if (arguments.length !== `+(o-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(o-2)+` args!');
}
`;l&&(p+=`var destructors = [];
`);var x=l?"destructors":"null",P=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],j=[$,n,i,rt,r[0],r[1]];u&&(p+="var thisWired = classParam.toWireType("+x+`, this);
`);for(var f=0;f<o-2;++f)p+="var arg"+f+"Wired = argType"+f+".toWireType("+x+", arg"+f+"); // "+r[f+2].name+`
`,P.push("argType"+f),j.push(r[f+2]);if(u&&(y="thisWired"+(y.length>0?", ":"")+y),p+=(v?"var rv = ":"")+"invoker(fn"+(y.length>0?", ":"")+y+`);
`,l)p+=`runDestructors(destructors);
`;else for(var f=u?1:2;f<r.length;++f){var I=f===1?"thisWired":"arg"+(f-2)+"Wired";r[f].destructorFunction!==null&&(p+=I+"_dtor("+I+"); // "+r[f].name+`
`,P.push(I+"_dtor"),j.push(r[f].destructorFunction))}v&&(p+=`var ret = retType.fromWireType(rv);
return ret;
`),p+=`}
`,P.push(p);var N=Jt(Function,P).apply(null,j);return N}function Cr(e,r){for(var t=[],n=0;n<e;n++)t.push(g[(r>>2)+n]);return t}function Oa(e,r,t,n,i,o,u){var l=Cr(t,n);r=Z(r),o=oe(i,o),ce([],[e],function(f){f=f[0];var v=f.name+"."+r;function h(){Be("Cannot call "+v+" due to unbound types",l)}r.startsWith("@@")&&(r=Symbol[r.substring(2)]);var y=f.registeredClass.constructor;return y[r]===void 0?(h.argCount=t-1,y[r]=h):(Zr(y,r,v),y[r].overloadTable[t-1]=h),ce([],l,function(p){var x=[p[0],null].concat(p.slice(1)),P=Er(v,x,null,o,u);return y[r].overloadTable===void 0?(P.argCount=t-1,y[r]=P):y[r].overloadTable[t-1]=P,[]}),[]})}function Ia(e,r,t,n,i,o){Xe(r>0);var u=Cr(r,t);i=oe(n,i),ce([],[e],function(l){l=l[0];var f="constructor "+l.name;if(l.registeredClass.constructor_body===void 0&&(l.registeredClass.constructor_body=[]),l.registeredClass.constructor_body[r-1]!==void 0)throw new $e("Cannot register multiple constructors with identical number of parameters ("+(r-1)+") for class '"+l.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return l.registeredClass.constructor_body[r-1]=function(){Be("Cannot construct "+l.name+" due to unbound types",u)},ce([],u,function(v){return v.splice(1,0,null),l.registeredClass.constructor_body[r-1]=Er(f,v,null,i,o),[]}),[]})}function Ba(e,r,t,n,i,o,u,l){var f=Cr(t,n);r=Z(r),o=oe(i,o),ce([],[e],function(v){v=v[0];var h=v.name+"."+r;r.startsWith("@@")&&(r=Symbol[r.substring(2)]),l&&v.registeredClass.pureVirtualFunctions.push(r);function y(){Be("Cannot call "+h+" due to unbound types",f)}var p=v.registeredClass.instancePrototype,x=p[r];return x===void 0||x.overloadTable===void 0&&x.className!==v.name&&x.argCount===t-2?(y.argCount=t-2,y.className=v.name,p[r]=y):(Zr(p,r,h),p[r].overloadTable[t-2]=y),ce([],f,function(P){var j=Er(h,P,v,o,u);return p[r].overloadTable===void 0?(j.argCount=t-2,p[r]=j):p[r].overloadTable[t-2]=j,[]}),[]})}function Zt(e,r,t){return e instanceof Object||$(t+' with invalid "this": '+e),e instanceof r.registeredClass.constructor||$(t+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||$("cannot call emscripten binding method "+t+" on deleted object"),br(e.$$.ptr,e.$$.ptrType.registeredClass,r.registeredClass)}function Na(e,r,t,n,i,o,u,l,f,v){r=Z(r),i=oe(n,i),ce([],[e],function(h){h=h[0];var y=h.name+"."+r,p={get:function(){Be("Cannot access "+y+" due to unbound types",[t,u])},enumerable:!0,configurable:!0};return f?p.set=function(){Be("Cannot access "+y+" due to unbound types",[t,u])}:p.set=function(x){$(y+" is a read-only property")},Object.defineProperty(h.registeredClass.instancePrototype,r,p),ce([],f?[t,u]:[t],function(x){var P=x[0],j={get:function(){var N=Zt(this,h,y+" getter");return P.fromWireType(i(o,N))},enumerable:!0};if(f){f=oe(l,f);var I=x[1];j.set=function(N){var k=Zt(this,h,y+" setter"),D=[];f(v,k,I.toWireType(D,N)),rt(D)}}return Object.defineProperty(h.registeredClass.instancePrototype,r,j),[]}),[]})}var tt=[],de=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function nt(e){e>4&&--de[e].refcount===0&&(de[e]=void 0,tt.push(e))}function Ua(){for(var e=0,r=5;r<de.length;++r)de[r]!==void 0&&++e;return e}function Ga(){for(var e=5;e<de.length;++e)if(de[e]!==void 0)return de[e];return null}function Va(){a.count_emval_handles=Ua,a.get_first_emval=Ga}var K={toValue:function(e){return e||$("Cannot use deleted val. handle = "+e),de[e].value},toHandle:function(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var r=tt.length?tt.pop():de.length;return de[r]={refcount:1,value:e},r}}}};function $a(e,r){r=Z(r),pe(e,{name:r,fromWireType:function(t){var n=K.toValue(t);return nt(t),n},toWireType:function(t,n){return K.toHandle(n)},argPackAdvance:8,readValueFromPointer:yr,destructorFunction:null})}function Wa(e,r,t){switch(r){case 0:return function(n){var i=t?X:q;return this.fromWireType(i[n])};case 1:return function(n){var i=t?ue:Ge;return this.fromWireType(i[n>>1])};case 2:return function(n){var i=t?g:ne;return this.fromWireType(i[n>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function za(e,r,t,n){var i=_r(t);r=Z(r);function o(){}o.values={},pe(e,{name:r,constructor:o,fromWireType:function(u){return this.constructor.values[u]},toWireType:function(u,l){return l.value},argPackAdvance:8,readValueFromPointer:Wa(r,i,n),destructorFunction:null}),et(r,o)}function Sr(e,r){var t=Ie[e];return t===void 0&&$(r+" has unknown type "+Kt(e)),t}function Ha(e,r,t){var n=Sr(e,"enum");r=Z(r);var i=n.constructor,o=Object.create(n.constructor.prototype,{value:{value:t},constructor:{value:pr(n.name+"_"+r,function(){})}});i.values[t]=o,i[r]=o}function it(e){if(e===null)return"null";var r=typeof e;return r==="object"||r==="array"||r==="function"?e.toString():""+e}function qa(e,r){switch(r){case 2:return function(t){return this.fromWireType(J[t>>2])};case 3:return function(t){return this.fromWireType(Pt[t>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Qa(e,r,t){var n=_r(t);r=Z(r),pe(e,{name:r,fromWireType:function(i){return i},toWireType:function(i,o){return o},argPackAdvance:8,readValueFromPointer:qa(r,n),destructorFunction:null})}function Ya(e,r,t,n,i,o){var u=Cr(r,t);e=Z(e),i=oe(n,i),et(e,function(){Be("Cannot call "+e+" due to unbound types",u)},r-1),ce([],u,function(l){var f=[l[0],null].concat(l.slice(1));return Yt(e,Er(e,f,null,i,o),r-1),[]})}function Xa(e,r,t){switch(r){case 0:return t?function(i){return X[i]}:function(i){return q[i]};case 1:return t?function(i){return ue[i>>1]}:function(i){return Ge[i>>1]};case 2:return t?function(i){return g[i>>2]}:function(i){return ne[i>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Ka(e,r,t,n,i){r=Z(r);var o=_r(t),u=function(y){return y};if(n===0){var l=32-8*t;u=function(y){return y<<l>>>l}}var f=r.includes("unsigned"),v=function(y,p){},h;f?h=function(y,p){return v(p,this.name),p>>>0}:h=function(y,p){return v(p,this.name),p},pe(e,{name:r,fromWireType:u,toWireType:h,argPackAdvance:8,readValueFromPointer:Xa(r,o,n!==0),destructorFunction:null})}function Ja(e,r,t){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],i=n[r];function o(u){u=u>>2;var l=ne,f=l[u],v=l[u+1];return new i(fr,v,f)}t=Z(t),pe(e,{name:t,fromWireType:o,argPackAdvance:8,readValueFromPointer:o},{ignoreDuplicateRegistrations:!0})}function Za(e,r,t,n,i,o,u,l,f,v,h,y){t=Z(t),o=oe(i,o),l=oe(u,l),v=oe(f,v),y=oe(h,y),ce([e],[r],function(p){p=p[0];var x=new ge(t,p.registeredClass,!1,!1,!0,p,n,o,l,v,y);return[x]})}function eo(e,r){r=Z(r);var t=r==="std::string";pe(e,{name:r,fromWireType:function(n){var i=ne[n>>2],o;if(t)for(var u=n+4,l=0;l<=i;++l){var f=n+4+l;if(l==i||q[f]==0){var v=f-u,h=Ce(u,v);o===void 0?o=h:(o+=String.fromCharCode(0),o+=h),u=f+1}}else{for(var y=new Array(i),l=0;l<i;++l)y[l]=String.fromCharCode(q[n+4+l]);o=y.join("")}return ye(n),o},toWireType:function(n,i){i instanceof ArrayBuffer&&(i=new Uint8Array(i));var o,u=typeof i=="string";u||i instanceof Uint8Array||i instanceof Uint8ClampedArray||i instanceof Int8Array||$("Cannot pass non-string to std::string"),t&&u?o=function(){return De(i)}:o=function(){return i.length};var l=o(),f=je(4+l+1);if(ne[f>>2]=l,t&&u)Pe(i,f+4,l+1);else if(u)for(var v=0;v<l;++v){var h=i.charCodeAt(v);h>255&&(ye(f),$("String has UTF-16 code units that do not fit in 8 bits")),q[f+4+v]=h}else for(var v=0;v<l;++v)q[f+4+v]=i[v];return n!==null&&n.push(ye,f),f},argPackAdvance:8,readValueFromPointer:yr,destructorFunction:function(n){ye(n)}})}function ro(e,r,t){t=Z(t);var n,i,o,u,l;r===2?(n=ai,i=oi,u=si,o=function(){return Ge},l=1):r===4&&(n=ui,i=li,u=fi,o=function(){return ne},l=2),pe(e,{name:t,fromWireType:function(f){for(var v=ne[f>>2],h=o(),y,p=f+4,x=0;x<=v;++x){var P=f+4+x*r;if(x==v||h[P>>l]==0){var j=P-p,I=n(p,j);y===void 0?y=I:(y+=String.fromCharCode(0),y+=I),p=P+r}}return ye(f),y},toWireType:function(f,v){typeof v!="string"&&$("Cannot pass non-string to C++ string type "+t);var h=u(v),y=je(4+h+r);return ne[y>>2]=h>>l,i(v,y+4,h+r),f!==null&&f.push(ye,y),y},argPackAdvance:8,readValueFromPointer:yr,destructorFunction:function(f){ye(f)}})}function to(e,r){r=Z(r),pe(e,{isVoid:!0,name:r,argPackAdvance:0,fromWireType:function(){},toWireType:function(t,n){}})}function no(e,r,t){e=K.toValue(e),r=Sr(r,"emval::as");var n=[],i=K.toHandle(n);return g[t>>2]=i,r.toWireType(n,e)}function en(e,r){for(var t=new Array(e),n=0;n<e;++n)t[n]=Sr(g[(r>>2)+n],"parameter "+n);return t}function io(e,r,t,n){e=K.toValue(e);for(var i=en(r,t),o=new Array(r),u=0;u<r;++u){var l=i[u];o[u]=l.readValueFromPointer(n),n+=l.argPackAdvance}var f=e.apply(void 0,o);return K.toHandle(f)}var ao={};function at(e){var r=ao[e];return r===void 0?Z(e):r}var ot=[];function oo(e,r,t,n){e=ot[e],r=K.toValue(r),t=at(t),e(r,t,null,n)}function so(e){var r=ot.length;return ot.push(e),r}var rn=[];function uo(e,r){var t=en(e,r),n=t[0],i=n.name+"_$"+t.slice(1).map(function(P){return P.name}).join("_")+"$",o=rn[i];if(o!==void 0)return o;for(var u=["retType"],l=[n],f="",v=0;v<e-1;++v)f+=(v!==0?", ":"")+"arg"+v,u.push("argType"+v),l.push(t[1+v]);for(var h=hr("methodCaller_"+i),y="return function "+h+`(handle, name, destructors, args) {
`,p=0,v=0;v<e-1;++v)y+="    var arg"+v+" = argType"+v+".readValueFromPointer(args"+(p?"+"+p:"")+`);
`,p+=t[v+1].argPackAdvance;y+="    var rv = handle[name]("+f+`);
`;for(var v=0;v<e-1;++v)t[v+1].deleteObject&&(y+="    argType"+v+".deleteObject(arg"+v+`);
`);n.isVoid||(y+=`    return retType.toWireType(destructors, rv);
`),y+=`};
`,u.push(y);var x=Jt(Function,u).apply(null,l);return o=so(x),rn[i]=o,o}function lo(e){return e=at(e),K.toHandle(a[e])}function fo(e,r){return e=K.toValue(e),r=K.toValue(r),K.toHandle(e[r])}function co(e){e>4&&(de[e].refcount+=1)}function mo(e){return e=K.toValue(e),typeof e=="number"}function _o(e){return K.toHandle(at(e))}function vo(e){var r=K.toValue(e);rt(r),nt(e)}function ho(e,r,t){e=K.toValue(e),r=K.toValue(r),t=K.toValue(t),e[r]=t}function po(e,r){e=Sr(e,"_emval_take_value");var t=e.readValueFromPointer(r);return K.toHandle(t)}function go(){he("")}function st(e,r){if(b.mainLoop.timingMode=e,b.mainLoop.timingValue=r,!b.mainLoop.func)return 1;if(b.mainLoop.running||(b.mainLoop.running=!0),e==0)b.mainLoop.scheduler=function(){var u=Math.max(0,b.mainLoop.tickStartTime+r-Ze())|0;setTimeout(b.mainLoop.runner,u)},b.mainLoop.method="timeout";else if(e==1)b.mainLoop.scheduler=function(){b.requestAnimationFrame(b.mainLoop.runner)},b.mainLoop.method="rAF";else if(e==2){if(typeof setImmediate>"u"){var t=[],n="setimmediate",i=function(o){(o.data===n||o.data.target===n)&&(o.stopPropagation(),t.shift()())};addEventListener("message",i,!0),setImmediate=function(u){t.push(u),postMessage(n,"*")}}b.mainLoop.scheduler=function(){setImmediate(b.mainLoop.runner)},b.mainLoop.method="immediate"}return 0}function tn(e){Xu(e)}function bo(){if(!qr())try{tn(Te)}catch(e){It(e)}}function yo(e,r,t,n,i){Xe(!b.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),b.mainLoop.func=e,b.mainLoop.arg=n;var o=b.mainLoop.currentlyRunningMainloop;function u(){return o<b.mainLoop.currentlyRunningMainloop?(bo(),!1):!0}if(b.mainLoop.running=!1,b.mainLoop.runner=function(){if(!Ee){if(b.mainLoop.queue.length>0){var f=Date.now(),v=b.mainLoop.queue.shift();if(v.func(v.arg),b.mainLoop.remainingBlockers){var h=b.mainLoop.remainingBlockers,y=h%1==0?h-1:Math.floor(h);v.counted?b.mainLoop.remainingBlockers=y:(y=y+.5,b.mainLoop.remainingBlockers=(8*h+y)/9)}if(re('main loop blocker "'+v.name+'" took '+(Date.now()-f)+" ms"),b.mainLoop.updateStatus(),!u())return;setTimeout(b.mainLoop.runner,0);return}if(!!u()){if(b.mainLoop.currentFrameNumber=b.mainLoop.currentFrameNumber+1|0,b.mainLoop.timingMode==1&&b.mainLoop.timingValue>1&&b.mainLoop.currentFrameNumber%b.mainLoop.timingValue!=0){b.mainLoop.scheduler();return}else b.mainLoop.timingMode==0&&(b.mainLoop.tickStartTime=Ze());b.mainLoop.runIter(e),u()&&(typeof SDL=="object"&&SDL.audio&&SDL.audio.queueNewAudioData&&SDL.audio.queueNewAudioData(),b.mainLoop.scheduler())}}},i||(r&&r>0?st(0,1e3/r):st(1,1),b.mainLoop.scheduler()),t)throw"unwind"}function ut(e,r){if(!(Lt||Ee)){if(r){e();return}try{e()}catch(t){It(t)}}}function nn(e,r){return setTimeout(function(){ut(e)},r)}var b={mainLoop:{running:!1,scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){b.mainLoop.scheduler=null,b.mainLoop.currentlyRunningMainloop++},resume:function(){b.mainLoop.currentlyRunningMainloop++;var e=b.mainLoop.timingMode,r=b.mainLoop.timingValue,t=b.mainLoop.func;b.mainLoop.func=null,yo(t,0,!1,b.mainLoop.arg,!0),st(e,r),b.mainLoop.scheduler()},updateStatus:function(){if(a.setStatus){var e=a.statusMessage||"Please wait...",r=b.mainLoop.remainingBlockers,t=b.mainLoop.expectedBlockers;r?r<t?a.setStatus(e+" ("+(t-r)+"/"+t+")"):a.setStatus(e):a.setStatus("")}},runIter:function(e){if(!Ee){if(a.preMainLoop){var r=a.preMainLoop();if(r===!1)return}ut(e),a.postMainLoop&&a.postMainLoop()}}},isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(a.preloadPlugins||(a.preloadPlugins=[]),b.initted)return;b.initted=!0;try{new Blob,b.hasBlobConstructor=!0}catch{b.hasBlobConstructor=!1,re("warning: no blob constructor, cannot create blobs with mimetypes")}b.BlobBuilder=typeof MozBlobBuilder<"u"?MozBlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:b.hasBlobConstructor?null:re("warning: no BlobBuilder"),b.URLObject=typeof window<"u"?window.URL?window.URL:window.webkitURL:void 0,!a.noImageDecoding&&typeof b.URLObject>"u"&&(re("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),a.noImageDecoding=!0);var e={};e.canHandle=function(o){return!a.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(o)},e.handle=function(o,u,l,f){var v=null;if(b.hasBlobConstructor)try{v=new Blob([o],{type:b.getMimetype(u)}),v.size!==o.length&&(v=new Blob([new Uint8Array(o).buffer],{type:b.getMimetype(u)}))}catch(x){ke("Blob constructor present but fails: "+x+"; falling back to blob builder")}if(!v){var h=new b.BlobBuilder;h.append(new Uint8Array(o).buffer),v=h.getBlob()}var y=b.URLObject.createObjectURL(v),p=new Image;p.onload=()=>{Xe(p.complete,"Image "+u+" could not be decoded");var x=document.createElement("canvas");x.width=p.width,x.height=p.height;var P=x.getContext("2d");P.drawImage(p,0,0),a.preloadedImages[u]=x,b.URLObject.revokeObjectURL(y),l&&l(o)},p.onerror=x=>{re("Image "+y+" could not be decoded"),f&&f()},p.src=y},a.preloadPlugins.push(e);var r={};r.canHandle=function(o){return!a.noAudioDecoding&&o.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},r.handle=function(o,u,l,f){var v=!1;function h(j){v||(v=!0,a.preloadedAudios[u]=j,l&&l(o))}function y(){v||(v=!0,a.preloadedAudios[u]=new Audio,f&&f())}if(b.hasBlobConstructor){try{var p=new Blob([o],{type:b.getMimetype(u)})}catch{return y()}var x=b.URLObject.createObjectURL(p),P=new Audio;P.addEventListener("canplaythrough",function(){h(P)},!1),P.onerror=function(I){if(v)return;re("warning: browser could not fully decode audio "+u+", trying slower base64 approach");function N(k){for(var D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",U="=",R="",B=0,Y=0,ee=0;ee<k.length;ee++)for(B=B<<8|k[ee],Y+=8;Y>=6;){var xe=B>>Y-6&63;Y-=6,R+=D[xe]}return Y==2?(R+=D[(B&3)<<4],R+=U+U):Y==4&&(R+=D[(B&15)<<2],R+=U),R}P.src="data:audio/x-"+u.substr(-3)+";base64,"+N(o),h(P)},P.src=x,nn(function(){h(P)},1e4)}else return y()},a.preloadPlugins.push(r);function t(){b.pointerLock=document.pointerLockElement===a.canvas||document.mozPointerLockElement===a.canvas||document.webkitPointerLockElement===a.canvas||document.msPointerLockElement===a.canvas}var n=a.canvas;n&&(n.requestPointerLock=n.requestPointerLock||n.mozRequestPointerLock||n.webkitRequestPointerLock||n.msRequestPointerLock||function(){},n.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},n.exitPointerLock=n.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",t,!1),document.addEventListener("mozpointerlockchange",t,!1),document.addEventListener("webkitpointerlockchange",t,!1),document.addEventListener("mspointerlockchange",t,!1),a.elementPointerLock&&n.addEventListener("click",function(i){!b.pointerLock&&a.canvas.requestPointerLock&&(a.canvas.requestPointerLock(),i.preventDefault())},!1))},createContext:function(e,r,t,n){if(r&&a.ctx&&e==a.canvas)return a.ctx;var i,o;if(r){var u={antialias:!1,alpha:!1,majorVersion:typeof WebGL2RenderingContext<"u"?2:1};if(n)for(var l in n)u[l]=n[l];typeof S<"u"&&(o=S.createContext(e,u),o&&(i=S.getContext(o).GLctx))}else i=e.getContext("2d");return i?(t&&(r||Xe(typeof w>"u","cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),a.ctx=i,r&&S.makeContextCurrent(o),a.useWebGL=r,b.moduleContextCreatedCallbacks.forEach(function(f){f()}),b.init()),i):null},destroyContext:function(e,r,t){},fullscreenHandlersInstalled:!1,lockPointer:void 0,resizeCanvas:void 0,requestFullscreen:function(e,r){b.lockPointer=e,b.resizeCanvas=r,typeof b.lockPointer>"u"&&(b.lockPointer=!0),typeof b.resizeCanvas>"u"&&(b.resizeCanvas=!1);var t=a.canvas;function n(){b.isFullscreen=!1;var o=t.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===o?(t.exitFullscreen=b.exitFullscreen,b.lockPointer&&t.requestPointerLock(),b.isFullscreen=!0,b.resizeCanvas?b.setFullscreenCanvasSize():b.updateCanvasDimensions(t)):(o.parentNode.insertBefore(t,o),o.parentNode.removeChild(o),b.resizeCanvas?b.setWindowedCanvasSize():b.updateCanvasDimensions(t)),a.onFullScreen&&a.onFullScreen(b.isFullscreen),a.onFullscreen&&a.onFullscreen(b.isFullscreen)}b.fullscreenHandlersInstalled||(b.fullscreenHandlersInstalled=!0,document.addEventListener("fullscreenchange",n,!1),document.addEventListener("mozfullscreenchange",n,!1),document.addEventListener("webkitfullscreenchange",n,!1),document.addEventListener("MSFullscreenChange",n,!1));var i=document.createElement("div");t.parentNode.insertBefore(i,t),i.appendChild(t),i.requestFullscreen=i.requestFullscreen||i.mozRequestFullScreen||i.msRequestFullscreen||(i.webkitRequestFullscreen?function(){i.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:null)||(i.webkitRequestFullScreen?function(){i.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),i.requestFullscreen()},exitFullscreen:function(){if(!b.isFullscreen)return!1;var e=document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){};return e.apply(document,[]),!0},nextRAF:0,fakeRequestAnimationFrame:function(e){var r=Date.now();if(b.nextRAF===0)b.nextRAF=r+1e3/60;else for(;r+2>=b.nextRAF;)b.nextRAF+=1e3/60;var t=Math.max(b.nextRAF-r,0);setTimeout(e,t)},requestAnimationFrame:function(e){if(typeof requestAnimationFrame=="function"){requestAnimationFrame(e);return}var r=b.fakeRequestAnimationFrame;r(e)},safeSetTimeout:function(e){return nn(e)},safeRequestAnimationFrame:function(e){return b.requestAnimationFrame(function(){ut(e)})},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(e)},getMovementX:function(e){return e.movementX||e.mozMovementX||e.webkitMovementX||0},getMovementY:function(e){return e.movementY||e.mozMovementY||e.webkitMovementY||0},getMouseWheelDelta:function(e){var r=0;switch(e.type){case"DOMMouseScroll":r=e.detail/3;break;case"mousewheel":r=e.wheelDelta/120;break;case"wheel":switch(r=e.deltaY,e.deltaMode){case 0:r/=100;break;case 1:r/=3;break;case 2:r*=80;break;default:throw"unrecognized mouse wheel delta mode: "+e.deltaMode}break;default:throw"unrecognized mouse wheel event: "+e.type}return r},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent:function(e){if(b.pointerLock)e.type!="mousemove"&&"mozMovementX"in e?b.mouseMovementX=b.mouseMovementY=0:(b.mouseMovementX=b.getMovementX(e),b.mouseMovementY=b.getMovementY(e)),typeof SDL<"u"?(b.mouseX=SDL.mouseX+b.mouseMovementX,b.mouseY=SDL.mouseY+b.mouseMovementY):(b.mouseX+=b.mouseMovementX,b.mouseY+=b.mouseMovementY);else{var r=a.canvas.getBoundingClientRect(),t=a.canvas.width,n=a.canvas.height,i=typeof window.scrollX<"u"?window.scrollX:window.pageXOffset,o=typeof window.scrollY<"u"?window.scrollY:window.pageYOffset;if(e.type==="touchstart"||e.type==="touchend"||e.type==="touchmove"){var u=e.touch;if(u===void 0)return;var l=u.pageX-(i+r.left),f=u.pageY-(o+r.top);l=l*(t/r.width),f=f*(n/r.height);var v={x:l,y:f};if(e.type==="touchstart")b.lastTouches[u.identifier]=v,b.touches[u.identifier]=v;else if(e.type==="touchend"||e.type==="touchmove"){var h=b.touches[u.identifier];h||(h=v),b.lastTouches[u.identifier]=h,b.touches[u.identifier]=v}return}var y=e.pageX-(i+r.left),p=e.pageY-(o+r.top);y=y*(t/r.width),p=p*(n/r.height),b.mouseMovementX=y-b.mouseX,b.mouseMovementY=p-b.mouseY,b.mouseX=y,b.mouseY=p}},resizeListeners:[],updateResizeListeners:function(){var e=a.canvas;b.resizeListeners.forEach(function(r){r(e.width,e.height)})},setCanvasSize:function(e,r,t){var n=a.canvas;b.updateCanvasDimensions(n,e,r),t||b.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize:function(){if(typeof SDL<"u"){var e=ne[SDL.screen>>2];e=e|8388608,g[SDL.screen>>2]=e}b.updateCanvasDimensions(a.canvas),b.updateResizeListeners()},setWindowedCanvasSize:function(){if(typeof SDL<"u"){var e=ne[SDL.screen>>2];e=e&-8388609,g[SDL.screen>>2]=e}b.updateCanvasDimensions(a.canvas),b.updateResizeListeners()},updateCanvasDimensions:function(e,r,t){r&&t?(e.widthNative=r,e.heightNative=t):(r=e.widthNative,t=e.heightNative);var n=r,i=t;if(a.forcedAspectRatio&&a.forcedAspectRatio>0&&(n/i<a.forcedAspectRatio?n=Math.round(i*a.forcedAspectRatio):i=Math.round(n/a.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e.parentNode&&typeof screen<"u"){var o=Math.min(screen.width/n,screen.height/i);n=Math.round(n*o),i=Math.round(i*o)}b.resizeCanvas?(e.width!=n&&(e.width=n),e.height!=i&&(e.height=i),typeof e.style<"u"&&(e.style.removeProperty("width"),e.style.removeProperty("height"))):(e.width!=r&&(e.width=r),e.height!=t&&(e.height=t),typeof e.style<"u"&&(n!=r||i!=t?(e.style.setProperty("width",n+"px","important"),e.style.setProperty("height",i+"px","important")):(e.style.removeProperty("width"),e.style.removeProperty("height"))))}},m={QUEUE_INTERVAL:25,QUEUE_LOOKAHEAD:.1,DEVICE_NAME:"Emscripten OpenAL",CAPTURE_DEVICE_NAME:"Emscripten OpenAL capture",ALC_EXTENSIONS:{ALC_SOFT_pause_device:!0,ALC_SOFT_HRTF:!0},AL_EXTENSIONS:{AL_EXT_float32:!0,AL_SOFT_loop_points:!0,AL_SOFT_source_length:!0,AL_EXT_source_distance_model:!0,AL_SOFT_source_spatialize:!0},_alcErr:0,alcErr:0,deviceRefCounts:{},alcStringCache:{},paused:!1,stringCache:{},contexts:{},currentCtx:null,buffers:{0:{id:0,refCount:0,audioBuf:null,frequency:0,bytesPerSample:2,channels:1,length:0}},paramArray:[],_nextId:1,newId:function(){return m.freeIds.length>0?m.freeIds.pop():m._nextId++},freeIds:[],scheduleContextAudio:function(e){if(!(b.mainLoop.timingMode===1&&document.visibilityState!="visible"))for(var r in e.sources)m.scheduleSourceAudio(e.sources[r])},scheduleSourceAudio:function(e,r){if(!(b.mainLoop.timingMode===1&&document.visibilityState!="visible")&&e.state===4114){for(var t=m.updateSourceTime(e),n=e.bufStartTime,i=e.bufOffset,o=e.bufsProcessed,u=0;u<e.audioQueue.length;u++){var l=e.audioQueue[u];n=l._startTime+l._duration,i=0,o+=l._skipCount+1}r||(r=m.QUEUE_LOOKAHEAD);for(var f=t+r,v=0;n<f;){if(o>=e.bufQueue.length)if(e.looping)o%=e.bufQueue.length;else break;var h=e.bufQueue[o%e.bufQueue.length];if(h.length===0){if(v++,v===e.bufQueue.length)break}else{var l=e.context.audioCtx.createBufferSource();l.buffer=h.audioBuf,l.playbackRate.value=e.playbackRate,(h.audioBuf._loopStart||h.audioBuf._loopEnd)&&(l.loopStart=h.audioBuf._loopStart,l.loopEnd=h.audioBuf._loopEnd);var y=0;e.type===4136&&e.looping?(y=Number.POSITIVE_INFINITY,l.loop=!0,h.audioBuf._loopStart&&(l.loopStart=h.audioBuf._loopStart),h.audioBuf._loopEnd&&(l.loopEnd=h.audioBuf._loopEnd)):y=(h.audioBuf.duration-i)/e.playbackRate,l._startOffset=i,l._duration=y,l._skipCount=v,v=0,l.connect(e.gain),typeof l.start<"u"?(n=Math.max(n,e.context.audioCtx.currentTime),l.start(n,i)):typeof l.noteOn<"u"&&(n=Math.max(n,e.context.audioCtx.currentTime),l.noteOn(n)),l._startTime=n,e.audioQueue.push(l),n+=y}i=0,o++}}},updateSourceTime:function(e){var r=e.context.audioCtx.currentTime;if(e.state!==4114)return r;isFinite(e.bufStartTime)||(e.bufStartTime=r-e.bufOffset/e.playbackRate,e.bufOffset=0);for(var t=0;e.audioQueue.length;){var n=e.audioQueue[0];if(e.bufsProcessed+=n._skipCount,t=n._startTime+n._duration,r<t)break;e.audioQueue.shift(),e.bufStartTime=t,e.bufOffset=0,e.bufsProcessed++}if(e.bufsProcessed>=e.bufQueue.length&&!e.looping)m.setSourceState(e,4116);else if(e.type===4136&&e.looping){var i=e.bufQueue[0];if(i.length===0)e.bufOffset=0;else{var o=(r-e.bufStartTime)*e.playbackRate,u=i.audioBuf._loopStart||0,l=i.audioBuf._loopEnd||i.audioBuf.duration;l<=u&&(l=i.audioBuf.duration),o<l?e.bufOffset=o:e.bufOffset=u+(o-u)%(l-u)}}else if(e.audioQueue[0])e.bufOffset=(r-e.audioQueue[0]._startTime)*e.playbackRate;else{if(e.type!==4136&&e.looping){var f=m.sourceDuration(e)/e.playbackRate;f>0&&(e.bufStartTime+=Math.floor((r-e.bufStartTime)/f)*f)}for(var v=0;v<e.bufQueue.length;v++){if(e.bufsProcessed>=e.bufQueue.length)if(e.looping)e.bufsProcessed%=e.bufQueue.length;else{m.setSourceState(e,4116);break}var i=e.bufQueue[e.bufsProcessed];if(i.length>0){if(t=e.bufStartTime+i.audioBuf.duration/e.playbackRate,r<t){e.bufOffset=(r-e.bufStartTime)*e.playbackRate;break}e.bufStartTime=t}e.bufOffset=0,e.bufsProcessed++}}return r},cancelPendingSourceAudio:function(e){m.updateSourceTime(e);for(var r=1;r<e.audioQueue.length;r++){var t=e.audioQueue[r];t.stop()}e.audioQueue.length>1&&(e.audioQueue.length=1)},stopSourceAudio:function(e){for(var r=0;r<e.audioQueue.length;r++)e.audioQueue[r].stop();e.audioQueue.length=0},setSourceState:function(e,r){r===4114?((e.state===4114||e.state==4116)&&(e.bufsProcessed=0,e.bufOffset=0),m.stopSourceAudio(e),e.state=4114,e.bufStartTime=Number.NEGATIVE_INFINITY,m.scheduleSourceAudio(e)):r===4115?e.state===4114&&(m.updateSourceTime(e),m.stopSourceAudio(e),e.state=4115):r===4116?e.state!==4113&&(e.state=4116,e.bufsProcessed=e.bufQueue.length,e.bufStartTime=Number.NEGATIVE_INFINITY,e.bufOffset=0,m.stopSourceAudio(e)):r===4113&&e.state!==4113&&(e.state=4113,e.bufsProcessed=0,e.bufStartTime=Number.NEGATIVE_INFINITY,e.bufOffset=0,m.stopSourceAudio(e))},initSourcePanner:function(e){if(e.type!==4144){for(var r=m.buffers[0],t=0;t<e.bufQueue.length;t++)if(e.bufQueue[t].id!==0){r=e.bufQueue[t];break}if(e.spatialize===1||e.spatialize===2&&r.channels===1){if(e.panner)return;e.panner=e.context.audioCtx.createPanner(),m.updateSourceGlobal(e),m.updateSourceSpace(e),e.panner.connect(e.context.gain),e.gain.disconnect(),e.gain.connect(e.panner)}else{if(!e.panner)return;e.panner.disconnect(),e.gain.disconnect(),e.gain.connect(e.context.gain),e.panner=null}}},updateContextGlobal:function(e){for(var r in e.sources)m.updateSourceGlobal(e.sources[r])},updateSourceGlobal:function(e){var r=e.panner;if(!!r){r.refDistance=e.refDistance,r.maxDistance=e.maxDistance,r.rolloffFactor=e.rolloffFactor,r.panningModel=e.context.hrtf?"HRTF":"equalpower";var t=e.context.sourceDistanceModel?e.distanceModel:e.context.distanceModel;switch(t){case 0:r.distanceModel="inverse",r.refDistance=340282e33;break;case 53249:case 53250:r.distanceModel="inverse";break;case 53251:case 53252:r.distanceModel="linear";break;case 53253:case 53254:r.distanceModel="exponential";break}}},updateListenerSpace:function(e){var r=e.audioCtx.listener;r.positionX?(r.positionX.value=e.listener.position[0],r.positionY.value=e.listener.position[1],r.positionZ.value=e.listener.position[2]):r.setPosition(e.listener.position[0],e.listener.position[1],e.listener.position[2]),r.forwardX?(r.forwardX.value=e.listener.direction[0],r.forwardY.value=e.listener.direction[1],r.forwardZ.value=e.listener.direction[2],r.upX.value=e.listener.up[0],r.upY.value=e.listener.up[1],r.upZ.value=e.listener.up[2]):r.setOrientation(e.listener.direction[0],e.listener.direction[1],e.listener.direction[2],e.listener.up[0],e.listener.up[1],e.listener.up[2]);for(var t in e.sources)m.updateSourceSpace(e.sources[t])},updateSourceSpace:function(e){if(!!e.panner){var r=e.panner,t=e.position[0],n=e.position[1],i=e.position[2],o=e.direction[0],u=e.direction[1],l=e.direction[2],f=e.context.listener,v=f.position[0],h=f.position[1],y=f.position[2];if(e.relative){var p=-f.direction[0],x=-f.direction[1],P=-f.direction[2],j=f.up[0],I=f.up[1],N=f.up[2],k=function(Sn,xn,kn){var Tn=Math.sqrt(Sn*Sn+xn*xn+kn*kn);return Tn<Number.EPSILON?0:1/Tn},D=k(p,x,P);p*=D,x*=D,P*=D,D=k(j,I,N),j*=D,I*=D,N*=D;var U=I*P-N*x,R=N*p-j*P,B=j*x-I*p;D=k(U,R,B),U*=D,R*=D,B*=D,j=x*B-P*R,I=P*U-p*B,N=p*R-x*U;var Y=o,ee=u,xe=l;o=Y*U+ee*j+xe*p,u=Y*R+ee*I+xe*x,l=Y*B+ee*N+xe*P,Y=t,ee=n,xe=i,t=Y*U+ee*j+xe*p,n=Y*R+ee*I+xe*x,i=Y*B+ee*N+xe*P,t+=v,n+=h,i+=y}r.positionX?(r.positionX.value=t,r.positionY.value=n,r.positionZ.value=i):r.setPosition(t,n,i),r.orientationX?(r.orientationX.value=o,r.orientationY.value=u,r.orientationZ.value=l):r.setOrientation(o,u,l);var Ju=e.dopplerShift,pn=e.velocity[0],gn=e.velocity[1],bn=e.velocity[2],yn=f.velocity[0],wn=f.velocity[1],En=f.velocity[2];if(t===v&&n===h&&i===y||pn===yn&&gn===wn&&bn===En)e.dopplerShift=1;else{var Or=e.context.speedOfSound,Ir=e.context.dopplerFactor,Br=v-t,Nr=h-n,Ur=y-i,Cn=Math.sqrt(Br*Br+Nr*Nr+Ur*Ur),_t=(Br*yn+Nr*wn+Ur*En)/Cn,vt=(Br*pn+Nr*gn+Ur*bn)/Cn;_t=Math.min(_t,Or/Ir),vt=Math.min(vt,Or/Ir),e.dopplerShift=(Or-Ir*_t)/(Or-Ir*vt)}e.dopplerShift!==Ju&&m.updateSourceRate(e)}},updateSourceRate:function(e){if(e.state===4114){m.cancelPendingSourceAudio(e);var r=e.audioQueue[0];if(!r)return;var t;e.type===4136&&e.looping?t=Number.POSITIVE_INFINITY:t=(r.buffer.duration-r._startOffset)/e.playbackRate,r._duration=t,r.playbackRate.value=e.playbackRate,m.scheduleSourceAudio(e)}},sourceDuration:function(e){for(var r=0,t=0;t<e.bufQueue.length;t++){var n=e.bufQueue[t].audioBuf;r+=n?n.duration:0}return r},sourceTell:function(e){m.updateSourceTime(e);for(var r=0,t=0;t<e.bufsProcessed;t++)e.bufQueue[t].audioBuf&&(r+=e.bufQueue[t].audioBuf.duration);return r+=e.bufOffset,r},sourceSeek:function(e,r){var t=e.state==4114;if(t&&m.setSourceState(e,4113),e.bufQueue[e.bufsProcessed].audioBuf!==null){for(e.bufsProcessed=0;r>e.bufQueue[e.bufsProcessed].audioBuf.duration;)r-=e.bufQueue[e.bufsProcessed].audiobuf.duration,e.bufsProcessed++;e.bufOffset=r}t&&m.setSourceState(e,4114)},getGlobalParam:function(e,r){if(!m.currentCtx)return null;switch(r){case 49152:return m.currentCtx.dopplerFactor;case 49155:return m.currentCtx.speedOfSound;case 53248:return m.currentCtx.distanceModel;default:return m.currentCtx.err=40962,null}},setGlobalParam:function(e,r,t){if(!!m.currentCtx)switch(r){case 49152:if(!Number.isFinite(t)||t<0){m.currentCtx.err=40963;return}m.currentCtx.dopplerFactor=t,m.updateListenerSpace(m.currentCtx);break;case 49155:if(!Number.isFinite(t)||t<=0){m.currentCtx.err=40963;return}m.currentCtx.speedOfSound=t,m.updateListenerSpace(m.currentCtx);break;case 53248:switch(t){case 0:case 53249:case 53250:case 53251:case 53252:case 53253:case 53254:m.currentCtx.distanceModel=t,m.updateContextGlobal(m.currentCtx);break;default:m.currentCtx.err=40963;return}break;default:m.currentCtx.err=40962;return}},getListenerParam:function(e,r){if(!m.currentCtx)return null;switch(r){case 4100:return m.currentCtx.listener.position;case 4102:return m.currentCtx.listener.velocity;case 4111:return m.currentCtx.listener.direction.concat(m.currentCtx.listener.up);case 4106:return m.currentCtx.gain.gain.value;default:return m.currentCtx.err=40962,null}},setListenerParam:function(e,r,t){if(!!m.currentCtx){if(t===null){m.currentCtx.err=40962;return}var n=m.currentCtx.listener;switch(r){case 4100:if(!Number.isFinite(t[0])||!Number.isFinite(t[1])||!Number.isFinite(t[2])){m.currentCtx.err=40963;return}n.position[0]=t[0],n.position[1]=t[1],n.position[2]=t[2],m.updateListenerSpace(m.currentCtx);break;case 4102:if(!Number.isFinite(t[0])||!Number.isFinite(t[1])||!Number.isFinite(t[2])){m.currentCtx.err=40963;return}n.velocity[0]=t[0],n.velocity[1]=t[1],n.velocity[2]=t[2],m.updateListenerSpace(m.currentCtx);break;case 4106:if(!Number.isFinite(t)||t<0){m.currentCtx.err=40963;return}m.currentCtx.gain.gain.value=t;break;case 4111:if(!Number.isFinite(t[0])||!Number.isFinite(t[1])||!Number.isFinite(t[2])||!Number.isFinite(t[3])||!Number.isFinite(t[4])||!Number.isFinite(t[5])){m.currentCtx.err=40963;return}n.direction[0]=t[0],n.direction[1]=t[1],n.direction[2]=t[2],n.up[0]=t[3],n.up[1]=t[4],n.up[2]=t[5],m.updateListenerSpace(m.currentCtx);break;default:m.currentCtx.err=40962;return}}},getBufferParam:function(e,r,t){if(!!m.currentCtx){var n=m.buffers[r];if(!n||r===0){m.currentCtx.err=40961;return}switch(t){case 8193:return n.frequency;case 8194:return n.bytesPerSample*8;case 8195:return n.channels;case 8196:return n.length*n.bytesPerSample*n.channels;case 8213:return n.length===0?[0,0]:[(n.audioBuf._loopStart||0)*n.frequency,(n.audioBuf._loopEnd||n.length)*n.frequency];default:return m.currentCtx.err=40962,null}}},setBufferParam:function(e,r,t,n){if(!!m.currentCtx){var i=m.buffers[r];if(!i||r===0){m.currentCtx.err=40961;return}if(n===null){m.currentCtx.err=40962;return}switch(t){case 8196:if(n!==0){m.currentCtx.err=40963;return}break;case 8213:if(n[0]<0||n[0]>i.length||n[1]<0||n[1]>i.Length||n[0]>=n[1]){m.currentCtx.err=40963;return}if(i.refCount>0){m.currentCtx.err=40964;return}i.audioBuf&&(i.audioBuf._loopStart=n[0]/i.frequency,i.audioBuf._loopEnd=n[1]/i.frequency);break;default:m.currentCtx.err=40962;return}}},getSourceParam:function(e,r,t){if(!m.currentCtx)return null;var n=m.currentCtx.sources[r];if(!n)return m.currentCtx.err=40961,null;switch(t){case 514:return n.relative;case 4097:return n.coneInnerAngle;case 4098:return n.coneOuterAngle;case 4099:return n.pitch;case 4100:return n.position;case 4101:return n.direction;case 4102:return n.velocity;case 4103:return n.looping;case 4105:return n.type===4136?n.bufQueue[0].id:0;case 4106:return n.gain.gain.value;case 4109:return n.minGain;case 4110:return n.maxGain;case 4112:return n.state;case 4117:return n.bufQueue.length===1&&n.bufQueue[0].id===0?0:n.bufQueue.length;case 4118:return n.bufQueue.length===1&&n.bufQueue[0].id===0||n.looping?0:n.bufsProcessed;case 4128:return n.refDistance;case 4129:return n.rolloffFactor;case 4130:return n.coneOuterGain;case 4131:return n.maxDistance;case 4132:return m.sourceTell(n);case 4133:var i=m.sourceTell(n);return i>0&&(i*=n.bufQueue[0].frequency),i;case 4134:var i=m.sourceTell(n);return i>0&&(i*=n.bufQueue[0].frequency*n.bufQueue[0].bytesPerSample),i;case 4135:return n.type;case 4628:return n.spatialize;case 8201:for(var l=0,o=0,u=0;u<n.bufQueue.length;u++)l+=n.bufQueue[u].length,n.bufQueue[u].id!==0&&(o=n.bufQueue[u].bytesPerSample*n.bufQueue[u].channels);return l*o;case 8202:for(var l=0,u=0;u<n.bufQueue.length;u++)l+=n.bufQueue[u].length;return l;case 8203:return m.sourceDuration(n);case 53248:return n.distanceModel;default:return m.currentCtx.err=40962,null}},setSourceParam:function(e,r,t,n){if(!!m.currentCtx){var i=m.currentCtx.sources[r];if(!i){m.currentCtx.err=40961;return}if(n===null){m.currentCtx.err=40962;return}switch(t){case 514:if(n===1)i.relative=!0,m.updateSourceSpace(i);else if(n===0)i.relative=!1,m.updateSourceSpace(i);else{m.currentCtx.err=40963;return}break;case 4097:if(!Number.isFinite(n)){m.currentCtx.err=40963;return}i.coneInnerAngle=n,i.panner&&(i.panner.coneInnerAngle=n%360);break;case 4098:if(!Number.isFinite(n)){m.currentCtx.err=40963;return}i.coneOuterAngle=n,i.panner&&(i.panner.coneOuterAngle=n%360);break;case 4099:if(!Number.isFinite(n)||n<=0){m.currentCtx.err=40963;return}if(i.pitch===n)break;i.pitch=n,m.updateSourceRate(i);break;case 4100:if(!Number.isFinite(n[0])||!Number.isFinite(n[1])||!Number.isFinite(n[2])){m.currentCtx.err=40963;return}i.position[0]=n[0],i.position[1]=n[1],i.position[2]=n[2],m.updateSourceSpace(i);break;case 4101:if(!Number.isFinite(n[0])||!Number.isFinite(n[1])||!Number.isFinite(n[2])){m.currentCtx.err=40963;return}i.direction[0]=n[0],i.direction[1]=n[1],i.direction[2]=n[2],m.updateSourceSpace(i);break;case 4102:if(!Number.isFinite(n[0])||!Number.isFinite(n[1])||!Number.isFinite(n[2])){m.currentCtx.err=40963;return}i.velocity[0]=n[0],i.velocity[1]=n[1],i.velocity[2]=n[2],m.updateSourceSpace(i);break;case 4103:if(n===1){if(i.looping=!0,m.updateSourceTime(i),i.type===4136&&i.audioQueue.length>0){var o=i.audioQueue[0];o.loop=!0,o._duration=Number.POSITIVE_INFINITY}}else if(n===0){i.looping=!1;var u=m.updateSourceTime(i);if(i.type===4136&&i.audioQueue.length>0){var o=i.audioQueue[0];o.loop=!1,o._duration=i.bufQueue[0].audioBuf.duration/i.playbackRate,o._startTime=u-i.bufOffset/i.playbackRate}}else{m.currentCtx.err=40963;return}break;case 4105:if(i.state===4114||i.state===4115){m.currentCtx.err=40964;return}if(n===0){for(var l in i.bufQueue)i.bufQueue[l].refCount--;i.bufQueue.length=1,i.bufQueue[0]=m.buffers[0],i.bufsProcessed=0,i.type=4144}else{var f=m.buffers[n];if(!f){m.currentCtx.err=40963;return}for(var l in i.bufQueue)i.bufQueue[l].refCount--;i.bufQueue.length=0,f.refCount++,i.bufQueue=[f],i.bufsProcessed=0,i.type=4136}m.initSourcePanner(i),m.scheduleSourceAudio(i);break;case 4106:if(!Number.isFinite(n)||n<0){m.currentCtx.err=40963;return}i.gain.gain.value=n;break;case 4109:if(!Number.isFinite(n)||n<0||n>Math.min(i.maxGain,1)){m.currentCtx.err=40963;return}i.minGain=n;break;case 4110:if(!Number.isFinite(n)||n<Math.max(0,i.minGain)||n>1){m.currentCtx.err=40963;return}i.maxGain=n;break;case 4128:if(!Number.isFinite(n)||n<0){m.currentCtx.err=40963;return}i.refDistance=n,i.panner&&(i.panner.refDistance=n);break;case 4129:if(!Number.isFinite(n)||n<0){m.currentCtx.err=40963;return}i.rolloffFactor=n,i.panner&&(i.panner.rolloffFactor=n);break;case 4130:if(!Number.isFinite(n)||n<0||n>1){m.currentCtx.err=40963;return}i.coneOuterGain=n,i.panner&&(i.panner.coneOuterGain=n);break;case 4131:if(!Number.isFinite(n)||n<0){m.currentCtx.err=40963;return}i.maxDistance=n,i.panner&&(i.panner.maxDistance=n);break;case 4132:if(n<0||n>m.sourceDuration(i)){m.currentCtx.err=40963;return}m.sourceSeek(i,n);break;case 4133:var y=m.sourceDuration(i);if(y>0){var v;for(var h in i.bufQueue)if(h){v=i.bufQueue[h].frequency;break}n/=v}if(n<0||n>y){m.currentCtx.err=40963;return}m.sourceSeek(i,n);break;case 4134:var y=m.sourceDuration(i);if(y>0){var p;for(var h in i.bufQueue)if(h){var f=i.bufQueue[h];p=f.frequency*f.bytesPerSample*f.channels;break}n/=p}if(n<0||n>y){m.currentCtx.err=40963;return}m.sourceSeek(i,n);break;case 4628:if(n!==0&&n!==1&&n!==2){m.currentCtx.err=40963;return}i.spatialize=n,m.initSourcePanner(i);break;case 8201:case 8202:case 8203:m.currentCtx.err=40964;break;case 53248:switch(n){case 0:case 53249:case 53250:case 53251:case 53252:case 53253:case 53254:i.distanceModel=n,m.currentCtx.sourceDistanceModel&&m.updateContextGlobal(m.currentCtx);break;default:m.currentCtx.err=40963;return}break;default:m.currentCtx.err=40962;return}}},captures:{},sharedCaptureAudioCtx:null,requireValidCaptureDevice:function(e,r){if(e===0)return m.alcErr=40961,null;var t=m.captures[e];if(!t)return m.alcErr=40961,null;var n=t.mediaStreamError;return n?(m.alcErr=40961,null):t}};function wo(e,r,t,n,i){if(!!m.currentCtx){var o=m.buffers[e];if(!o){m.currentCtx.err=40963;return}if(i<=0){m.currentCtx.err=40963;return}var u=null;try{switch(r){case 4352:if(n>0){u=m.currentCtx.audioCtx.createBuffer(1,n,i);for(var l=u.getChannelData(0),f=0;f<n;++f)l[f]=q[t++]*.0078125-1}o.bytesPerSample=1,o.channels=1,o.length=n;break;case 4353:if(n>0){u=m.currentCtx.audioCtx.createBuffer(1,n>>1,i);var l=u.getChannelData(0);t>>=1;for(var f=0;f<n>>1;++f)l[f]=ue[t++]*30517578125e-15}o.bytesPerSample=2,o.channels=1,o.length=n>>1;break;case 4354:if(n>0){u=m.currentCtx.audioCtx.createBuffer(2,n>>1,i);for(var l=u.getChannelData(0),v=u.getChannelData(1),f=0;f<n>>1;++f)l[f]=q[t++]*.0078125-1,v[f]=q[t++]*.0078125-1}o.bytesPerSample=1,o.channels=2,o.length=n>>1;break;case 4355:if(n>0){u=m.currentCtx.audioCtx.createBuffer(2,n>>2,i);var l=u.getChannelData(0),v=u.getChannelData(1);t>>=1;for(var f=0;f<n>>2;++f)l[f]=ue[t++]*30517578125e-15,v[f]=ue[t++]*30517578125e-15}o.bytesPerSample=2,o.channels=2,o.length=n>>2;break;case 65552:if(n>0){u=m.currentCtx.audioCtx.createBuffer(1,n>>2,i);var l=u.getChannelData(0);t>>=2;for(var f=0;f<n>>2;++f)l[f]=J[t++]}o.bytesPerSample=4,o.channels=1,o.length=n>>2;break;case 65553:if(n>0){u=m.currentCtx.audioCtx.createBuffer(2,n>>3,i);var l=u.getChannelData(0),v=u.getChannelData(1);t>>=2;for(var f=0;f<n>>3;++f)l[f]=J[t++],v[f]=J[t++]}o.bytesPerSample=4,o.channels=2,o.length=n>>3;break;default:m.currentCtx.err=40963;return}o.frequency=i,o.audioBuf=u}catch{m.currentCtx.err=40963;return}}}function Eo(e,r){if(!!m.currentCtx){for(var t=0;t<e;++t){var n=g[r+t*4>>2];if(n!==0){if(!m.buffers[n]){m.currentCtx.err=40961;return}if(m.buffers[n].refCount){m.currentCtx.err=40964;return}}}for(var t=0;t<e;++t){var n=g[r+t*4>>2];n!==0&&(m.deviceRefCounts[m.buffers[n].deviceId]--,delete m.buffers[n],m.freeIds.push(n))}}}function an(e,r,t){switch(r){case 514:case 4097:case 4098:case 4103:case 4105:case 4128:case 4129:case 4131:case 4132:case 4133:case 4134:case 4628:case 8201:case 8202:case 53248:m.setSourceParam("alSourcei",e,r,t);break;default:m.setSourceParam("alSourcei",e,r,null);break}}function Co(e,r){if(!!m.currentCtx){for(var t=0;t<e;++t){var n=g[r+t*4>>2];if(!m.currentCtx.sources[n]){m.currentCtx.err=40961;return}}for(var t=0;t<e;++t){var n=g[r+t*4>>2];m.setSourceState(m.currentCtx.sources[n],4116),an(n,4105,0),delete m.currentCtx.sources[n],m.freeIds.push(n)}}}function So(e,r){if(!!m.currentCtx)for(var t=0;t<e;++t){var n={deviceId:m.currentCtx.deviceId,id:m.newId(),refCount:0,audioBuf:null,frequency:0,bytesPerSample:2,channels:1,length:0};m.deviceRefCounts[n.deviceId]++,m.buffers[n.id]=n,g[r+t*4>>2]=n.id}}function xo(e,r){if(!!m.currentCtx)for(var t=0;t<e;++t){var n=m.currentCtx.audioCtx.createGain();n.connect(m.currentCtx.gain);var i={context:m.currentCtx,id:m.newId(),type:4144,state:4113,bufQueue:[m.buffers[0]],audioQueue:[],looping:!1,pitch:1,dopplerShift:1,gain:n,minGain:0,maxGain:1,panner:null,bufsProcessed:0,bufStartTime:Number.NEGATIVE_INFINITY,bufOffset:0,relative:!1,refDistance:1,maxDistance:340282e33,rolloffFactor:1,position:[0,0,0],velocity:[0,0,0],direction:[0,0,0],coneOuterGain:0,coneInnerAngle:360,coneOuterAngle:360,distanceModel:53250,spatialize:2,get playbackRate(){return this.pitch*this.dopplerShift}};m.currentCtx.sources[i.id]=i,g[r+t*4>>2]=i.id}}function ko(){if(m.currentCtx){var e=m.currentCtx.err;return m.currentCtx.err=0,e}else return 40964}function To(e,r,t){var n=m.getSourceParam("alGetSourcei",e,r);if(n!==null){if(!t){m.currentCtx.err=40963;return}switch(r){case 514:case 4097:case 4098:case 4103:case 4105:case 4112:case 4117:case 4118:case 4128:case 4129:case 4131:case 4132:case 4133:case 4134:case 4135:case 4628:case 8201:case 8202:case 53248:g[t>>2]=n;break;default:m.currentCtx.err=40962;return}}}function Po(e){if(!m.currentCtx)return 0;if(m.stringCache[e])return m.stringCache[e];var r;switch(e){case 0:r="No Error";break;case 40961:r="Invalid Name";break;case 40962:r="Invalid Enum";break;case 40963:r="Invalid Value";break;case 40964:r="Invalid Operation";break;case 40965:r="Out of Memory";break;case 45057:r="Emscripten";break;case 45058:r="1.1";break;case 45059:r="WebAudio";break;case 45060:r="";for(var t in m.AL_EXTENSIONS)r=r.concat(t),r=r.concat(" ");r=r.trim();break;default:return m.currentCtx.err=40962,0}return r=xt(He(r),St),m.stringCache[e]=r,r}function Do(e){if(!!m.currentCtx){var r=m.currentCtx.sources[e];if(!r){m.currentCtx.err=40961;return}m.setSourceState(r,4115)}}function Fo(e){if(!!m.currentCtx){var r=m.currentCtx.sources[e];if(!r){m.currentCtx.err=40961;return}m.setSourceState(r,4114)}}function Ao(e){if(!!m.currentCtx){var r=m.currentCtx.sources[e];if(!r){m.currentCtx.err=40961;return}m.setSourceState(r,4116)}}function jo(e,r,t){switch(r){case 4097:case 4098:case 4099:case 4106:case 4109:case 4110:case 4128:case 4129:case 4130:case 4131:case 4132:case 4133:case 4134:case 8203:m.setSourceParam("alSourcef",e,r,t);break;default:m.setSourceParam("alSourcef",e,r,null);break}}function Mo(e){return!(e in m.deviceRefCounts)||m.deviceRefCounts[e]>0?0:(delete m.deviceRefCounts[e],m.freeIds.push(e),1)}function Lo(e,r,t){e.addEventListener(r,t,{once:!0})}function on(e,r){r||(r=[document,document.getElementById("canvas")]),["keydown","mousedown","touchstart"].forEach(function(t){r.forEach(function(n){n&&Lo(n,t,function(){e.state==="suspended"&&e.resume()})})})}function Ro(e,r){if(!(e in m.deviceRefCounts))return m.alcErr=40961,0;var t=null,n=[],i=null;if(r>>=2,r)for(var o=0,u=0;o=g[r++],n.push(o),o!==0;)switch(u=g[r++],n.push(u),o){case 4103:t||(t={}),t.sampleRate=u;break;case 4112:case 4113:break;case 6546:switch(u){case 0:i=!1;break;case 1:i=!0;break;case 2:break;default:return m.alcErr=40964,0}break;case 6550:if(u!==0)return m.alcErr=40964,0;break;default:return m.alcErr=40964,0}var l=window.AudioContext||window.webkitAudioContext,f=null;try{t?f=new l(t):f=new l}catch(x){return x.name==="NotSupportedError"?m.alcErr=40964:m.alcErr=40961,0}on(f),typeof f.createGain>"u"&&(f.createGain=f.createGainNode);var v=f.createGain();v.connect(f.destination);var h={deviceId:e,id:m.newId(),attrs:n,audioCtx:f,listener:{position:[0,0,0],velocity:[0,0,0],direction:[0,0,0],up:[0,0,0]},sources:[],interval:setInterval(function(){m.scheduleContextAudio(h)},m.QUEUE_INTERVAL),gain:v,distanceModel:53250,speedOfSound:343.3,dopplerFactor:1,sourceDistanceModel:!1,hrtf:i||!1,_err:0,get err(){return this._err},set err(x){(this._err===0||x===0)&&(this._err=x)}};if(m.deviceRefCounts[e]++,m.contexts[h.id]=h,i!==null)for(var y in m.contexts){var p=m.contexts[y];p.deviceId===e&&(p.hrtf=i,m.updateContextGlobal(p))}return h.id}function Oo(e){var r=m.contexts[e];if(m.currentCtx===r){m.alcErr=40962;return}m.contexts[e].interval&&clearInterval(m.contexts[e].interval),m.deviceRefCounts[r.deviceId]--,delete m.contexts[e],m.freeIds.push(e)}function Io(e){var r=m.alcErr;return m.alcErr=0,r}function Bo(e,r){if(m.alcStringCache[r])return m.alcStringCache[r];var t;switch(r){case 0:t="No Error";break;case 40961:t="Invalid Device";break;case 40962:t="Invalid Context";break;case 40963:t="Invalid Enum";break;case 40964:t="Invalid Value";break;case 40965:t="Out of Memory";break;case 4100:if(typeof AudioContext<"u"||typeof webkitAudioContext<"u")t=m.DEVICE_NAME;else return 0;break;case 4101:typeof AudioContext<"u"||typeof webkitAudioContext<"u"?t=m.DEVICE_NAME.concat("\0"):t="\0";break;case 785:t=m.CAPTURE_DEVICE_NAME;break;case 784:if(e===0)t=m.CAPTURE_DEVICE_NAME.concat("\0");else{var n=m.requireValidCaptureDevice(e,"alcGetString");if(!n)return 0;t=n.deviceName}break;case 4102:if(!e)return m.alcErr=40961,0;t="";for(var i in m.ALC_EXTENSIONS)t=t.concat(i),t=t.concat(" ");t=t.trim();break;default:return m.alcErr=40963,0}return t=xt(He(t),St),m.alcStringCache[r]=t,t}function No(e){return e===0?(m.currentCtx=null,0):(m.currentCtx=m.contexts[e],1)}function Uo(e){if(e){var r=Ce(e);if(r!==m.DEVICE_NAME)return 0}if(typeof AudioContext<"u"||typeof webkitAudioContext<"u"){var t=m.newId();return m.deviceRefCounts[t]=0,t}else return 0}function Go(){return 2147483648}function Vo(e,r,t){q.copyWithin(e,r,r+t)}function $o(e){try{return ie.grow(e-fr.byteLength+65535>>>16),Dt(ie.buffer),1}catch{}}function Wo(e){var r=q.length;e=e>>>0;var t=2147483648;if(e>t)return!1;for(var n=1;n<=4;n*=2){var i=r*(1+.2/n);i=Math.min(i,e+100663296);var o=Math.min(t,mi(Math.max(e,i),65536)),u=$o(o);if(u)return!0}return!1}var lt={};function zo(){return M||"./this.program"}function ar(){if(!ar.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:zo()};for(var t in lt)lt[t]===void 0?delete r[t]:r[t]=lt[t];var n=[];for(var t in r)n.push(t+"="+r[t]);ar.strings=n}return ar.strings}function Ho(e,r){var t=0;return ar().forEach(function(n,i){var o=r+t;g[e+i*4>>2]=o,di(n,o),t+=n.length+1}),0}function qo(e,r){var t=ar();g[e>>2]=t.length;var n=0;return t.forEach(function(i){n+=i.length+1}),g[r>>2]=n,0}function Qo(e){try{var r=V.getStreamFromFD(e);return s.close(r),0}catch(t){if(typeof s>"u"||!(t instanceof s.ErrnoError))throw t;return t.errno}}function Yo(e,r,t,n){try{var i=V.getStreamFromFD(e),o=V.doReadv(i,r,t);return g[n>>2]=o,0}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return u.errno}}function Xo(e,r,t,n,i){try{var o=V.getStreamFromFD(e),u=4294967296,l=t*u+(r>>>0),f=9007199254740992;return l<=-f||l>=f?-61:(s.llseek(o,l,n),ae=[o.position>>>0,(H=o.position,+Math.abs(H)>=1?H>0?(Math.min(+Math.floor(H/4294967296),4294967295)|0)>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],g[i>>2]=ae[0],g[i+4>>2]=ae[1],o.getdents&&l===0&&n===0&&(o.getdents=null),0)}catch(v){if(typeof s>"u"||!(v instanceof s.ErrnoError))throw v;return v.errno}}function Ko(e,r,t,n){try{var i=V.getStreamFromFD(e),o=V.doWritev(i,r,t);return g[n>>2]=o,0}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return u.errno}}function xr(e,r){xr.randomDevice||(xr.randomDevice=Gt());for(var t=0;t<r;t++)X[e+t>>0]=xr.randomDevice();return 0}function Jo(e){var r=Date.now();return g[e>>2]=r/1e3|0,g[e+4>>2]=r%1e3*1e3|0,0}function Zo(e){var r=e.getExtension("ANGLE_instanced_arrays");if(r)return e.vertexAttribDivisor=function(t,n){r.vertexAttribDivisorANGLE(t,n)},e.drawArraysInstanced=function(t,n,i,o){r.drawArraysInstancedANGLE(t,n,i,o)},e.drawElementsInstanced=function(t,n,i,o,u){r.drawElementsInstancedANGLE(t,n,i,o,u)},1}function es(e){var r=e.getExtension("OES_vertex_array_object");if(r)return e.createVertexArray=function(){return r.createVertexArrayOES()},e.deleteVertexArray=function(t){r.deleteVertexArrayOES(t)},e.bindVertexArray=function(t){r.bindVertexArrayOES(t)},e.isVertexArray=function(t){return r.isVertexArrayOES(t)},1}function rs(e){var r=e.getExtension("WEBGL_draw_buffers");if(r)return e.drawBuffers=function(t,n){r.drawBuffersWEBGL(t,n)},1}function ts(e){return!!(e.dibvbi=e.getExtension("WEBGL_draw_instanced_base_vertex_base_instance"))}function ns(e){return!!(e.mdibvbi=e.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance"))}function is(e){return!!(e.multiDrawWebgl=e.getExtension("WEBGL_multi_draw"))}var S={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:[],offscreenCanvases:{},queries:[],samplers:[],transformFeedbacks:[],syncs:[],stringCache:{},stringiCache:{},unpackAlignment:4,recordError:function(r){S.lastError||(S.lastError=r)},getNewId:function(e){for(var r=S.counter++,t=e.length;t<r;t++)e[t]=null;return r},getSource:function(e,r,t,n){for(var i="",o=0;o<r;++o){var u=n?g[n+o*4>>2]:-1;i+=Ce(g[t+o*4>>2],u<0?void 0:u)}return i},createContext:function(e,r){e.getContextSafariWebGL2Fixed||(e.getContextSafariWebGL2Fixed=e.getContext,e.getContext=function(i,o){var u=e.getContextSafariWebGL2Fixed(i,o);return i=="webgl"==u instanceof WebGLRenderingContext?u:null});var t=r.majorVersion>1?e.getContext("webgl2",r):e.getContext("webgl",r);if(!t)return 0;var n=S.registerContext(t,r);return n},registerContext:function(e,r){var t=S.getNewId(S.contexts),n={handle:t,attributes:r,version:r.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=n),S.contexts[t]=n,(typeof r.enableExtensionsByDefault>"u"||r.enableExtensionsByDefault)&&S.initExtensions(n),t},makeContextCurrent:function(e){return S.currentContext=S.contexts[e],a.ctx=w=S.currentContext&&S.currentContext.GLctx,!(e&&!w)},getContext:function(e){return S.contexts[e]},deleteContext:function(e){S.currentContext===S.contexts[e]&&(S.currentContext=null),typeof JSEvents=="object"&&JSEvents.removeAllHandlersOnTarget(S.contexts[e].GLctx.canvas),S.contexts[e]&&S.contexts[e].GLctx.canvas&&(S.contexts[e].GLctx.canvas.GLctxObject=void 0),S.contexts[e]=null},initExtensions:function(e){if(e||(e=S.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var r=e.GLctx;Zo(r),es(r),rs(r),ts(r),ns(r),e.version>=2&&(r.disjointTimerQueryExt=r.getExtension("EXT_disjoint_timer_query_webgl2")),(e.version<2||!r.disjointTimerQueryExt)&&(r.disjointTimerQueryExt=r.getExtension("EXT_disjoint_timer_query")),is(r);var t=r.getSupportedExtensions()||[];t.forEach(function(n){!n.includes("lose_context")&&!n.includes("debug")&&r.getExtension(n)})}}};function as(e){w.activeTexture(e)}function os(e,r){w.attachShader(S.programs[e],S.shaders[r])}function ss(e,r,t){w.bindAttribLocation(S.programs[e],r,Ce(t))}function us(e,r){e==35051?w.currentPixelPackBufferBinding=r:e==35052&&(w.currentPixelUnpackBufferBinding=r),w.bindBuffer(e,S.buffers[r])}function ls(e,r,t,n,i){w.bindBufferRange(e,r,S.buffers[t],n,i)}function fs(e,r){w.bindFramebuffer(e,S.framebuffers[r])}function cs(e,r){w.bindRenderbuffer(e,S.renderbuffers[r])}function ds(e,r){w.bindTexture(e,S.textures[r])}function ms(e){w.bindVertexArray(S.vaos[e])}function _s(e){w.blendEquation(e)}function vs(e,r){w.blendFunc(e,r)}function hs(e,r,t,n){w.blendFuncSeparate(e,r,t,n)}function ps(e,r,t,n,i,o,u,l,f,v){w.blitFramebuffer(e,r,t,n,i,o,u,l,f,v)}function gs(e,r,t,n){S.currentContext.version>=2?t?w.bufferData(e,q,n,t,r):w.bufferData(e,r,n):w.bufferData(e,t?q.subarray(t,t+r):r,n)}function bs(e,r,t,n){if(S.currentContext.version>=2){w.bufferSubData(e,r,q,n,t);return}w.bufferSubData(e,r,q.subarray(n,n+t))}function ys(e){w.clear(e)}function ws(e,r,t){w.clearBufferfv(e,r,J,t>>2)}function Es(e,r,t,n){w.clearColor(e,r,t,n)}function Cs(e){w.clearDepth(e)}function Ss(e,r,t,n){w.colorMask(!!e,!!r,!!t,!!n)}function xs(e){w.compileShader(S.shaders[e])}function ks(e,r,t,n,i,o,u,l){if(S.currentContext.version>=2){w.currentPixelUnpackBufferBinding?w.compressedTexImage2D(e,r,t,n,i,o,u,l):w.compressedTexImage2D(e,r,t,n,i,o,q,l,u);return}w.compressedTexImage2D(e,r,t,n,i,o,l?q.subarray(l,l+u):null)}function Ts(e,r,t,n,i,o,u,l,f){w.currentPixelUnpackBufferBinding?w.compressedTexImage3D(e,r,t,n,i,o,u,l,f):w.compressedTexImage3D(e,r,t,n,i,o,u,q,f,l)}function Ps(e,r,t,n,i,o,u,l){w.copyTexSubImage2D(e,r,t,n,i,o,u,l)}function Ds(){var e=S.getNewId(S.programs),r=w.createProgram();return r.name=e,r.maxUniformLength=r.maxAttributeLength=r.maxUniformBlockNameLength=0,r.uniformIdCounter=1,S.programs[e]=r,e}function Fs(e){var r=S.getNewId(S.shaders);return S.shaders[r]=w.createShader(e),r}function As(e,r){for(var t=0;t<e;t++){var n=g[r+t*4>>2],i=S.buffers[n];!i||(w.deleteBuffer(i),i.name=0,S.buffers[n]=null,n==w.currentPixelPackBufferBinding&&(w.currentPixelPackBufferBinding=0),n==w.currentPixelUnpackBufferBinding&&(w.currentPixelUnpackBufferBinding=0))}}function js(e,r){for(var t=0;t<e;++t){var n=g[r+t*4>>2],i=S.framebuffers[n];!i||(w.deleteFramebuffer(i),i.name=0,S.framebuffers[n]=null)}}function Ms(e){if(!!e){var r=S.programs[e];if(!r){S.recordError(1281);return}w.deleteProgram(r),r.name=0,S.programs[e]=null}}function Ls(e,r){for(var t=0;t<e;t++){var n=g[r+t*4>>2],i=S.renderbuffers[n];!i||(w.deleteRenderbuffer(i),i.name=0,S.renderbuffers[n]=null)}}function Rs(e){if(!!e){var r=S.shaders[e];if(!r){S.recordError(1281);return}w.deleteShader(r),S.shaders[e]=null}}function Os(e,r){for(var t=0;t<e;t++){var n=g[r+t*4>>2],i=S.textures[n];!i||(w.deleteTexture(i),i.name=0,S.textures[n]=null)}}function Is(e,r){for(var t=0;t<e;t++){var n=g[r+t*4>>2];w.deleteVertexArray(S.vaos[n]),S.vaos[n]=null}}function Bs(e){w.depthFunc(e)}function Ns(e){w.depthMask(!!e)}function Us(e){w.disable(e)}function Gs(e,r,t){w.drawArrays(e,r,t)}function Vs(e,r,t,n){w.drawArraysInstanced(e,r,t,n)}var ft=[];function $s(e,r){for(var t=ft[e],n=0;n<e;n++)t[n]=g[r+n*4>>2];w.drawBuffers(t)}function Ws(e,r,t,n){w.drawElements(e,r,t,n)}function zs(e,r,t,n,i){w.drawElementsInstanced(e,r,t,n,i)}function Hs(e){w.enable(e)}function qs(e){w.enableVertexAttribArray(e)}function Qs(e,r,t,n){w.framebufferRenderbuffer(e,r,t,S.renderbuffers[n])}function Ys(e,r,t,n,i){w.framebufferTexture2D(e,r,t,S.textures[n],i)}function Xs(e){w.frontFace(e)}function or(e,r,t,n){for(var i=0;i<e;i++){var o=w[t](),u=o&&S.getNewId(n);o?(o.name=u,n[u]=o):S.recordError(1282),g[r+i*4>>2]=u}}function Ks(e,r){or(e,r,"createBuffer",S.buffers)}function Js(e,r){or(e,r,"createFramebuffer",S.framebuffers)}function Zs(e,r){or(e,r,"createRenderbuffer",S.renderbuffers)}function eu(e,r){or(e,r,"createTexture",S.textures)}function ru(e,r){or(e,r,"createVertexArray",S.vaos)}function tu(e){w.generateMipmap(e)}function nu(){var e=w.getError()||S.lastError;return S.lastError=0,e}function iu(e,r){ne[e>>2]=r,ne[e+4>>2]=(r-ne[e>>2])/4294967296}function au(e,r,t){if(!r){S.recordError(1281);return}var n=void 0;switch(e){case 36346:n=1;break;case 36344:t!=0&&t!=1&&S.recordError(1280);return;case 34814:case 36345:n=0;break;case 34466:var i=w.getParameter(34467);n=i?i.length:0;break;case 33309:if(S.currentContext.version<2){S.recordError(1282);return}var o=w.getSupportedExtensions()||[];n=2*o.length;break;case 33307:case 33308:if(S.currentContext.version<2){S.recordError(1280);return}n=e==33307?3:0;break}if(n===void 0){var u=w.getParameter(e);switch(typeof u){case"number":n=u;break;case"boolean":n=u?1:0;break;case"string":S.recordError(1280);return;case"object":if(u===null)switch(e){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:{n=0;break}default:{S.recordError(1280);return}}else if(u instanceof Float32Array||u instanceof Uint32Array||u instanceof Int32Array||u instanceof Array){for(var l=0;l<u.length;++l)switch(t){case 0:g[r+l*4>>2]=u[l];break;case 2:J[r+l*4>>2]=u[l];break;case 4:X[r+l>>0]=u[l]?1:0;break}return}else try{n=u.name|0}catch(f){S.recordError(1280),te("GL_INVALID_ENUM in glGet"+t+"v: Unknown object returned from WebGL getParameter("+e+")! (error: "+f+")");return}break;default:S.recordError(1280),te("GL_INVALID_ENUM in glGet"+t+"v: Native code calling glGet"+t+"v("+e+") and it returns "+u+" of type "+typeof u+"!");return}}switch(t){case 1:iu(r,n);break;case 0:g[r>>2]=n;break;case 2:J[r>>2]=n;break;case 4:X[r>>0]=n?1:0;break}}function ou(e,r){au(e,r,0)}function su(e,r,t,n){var i=w.getProgramInfoLog(S.programs[e]);i===null&&(i="(unknown error)");var o=r>0&&n?Pe(i,n,r):0;t&&(g[t>>2]=o)}function uu(e,r,t){if(!t){S.recordError(1281);return}if(e>=S.counter){S.recordError(1281);return}if(e=S.programs[e],r==35716){var n=w.getProgramInfoLog(e);n===null&&(n="(unknown error)"),g[t>>2]=n.length+1}else if(r==35719){if(!e.maxUniformLength)for(var i=0;i<w.getProgramParameter(e,35718);++i)e.maxUniformLength=Math.max(e.maxUniformLength,w.getActiveUniform(e,i).name.length+1);g[t>>2]=e.maxUniformLength}else if(r==35722){if(!e.maxAttributeLength)for(var i=0;i<w.getProgramParameter(e,35721);++i)e.maxAttributeLength=Math.max(e.maxAttributeLength,w.getActiveAttrib(e,i).name.length+1);g[t>>2]=e.maxAttributeLength}else if(r==35381){if(!e.maxUniformBlockNameLength)for(var i=0;i<w.getProgramParameter(e,35382);++i)e.maxUniformBlockNameLength=Math.max(e.maxUniformBlockNameLength,w.getActiveUniformBlockName(e,i).length+1);g[t>>2]=e.maxUniformBlockNameLength}else g[t>>2]=w.getProgramParameter(e,r)}function lu(e,r,t,n){var i=w.getShaderInfoLog(S.shaders[e]);i===null&&(i="(unknown error)");var o=r>0&&n?Pe(i,n,r):0;t&&(g[t>>2]=o)}function fu(e,r,t){if(!t){S.recordError(1281);return}if(r==35716){var n=w.getShaderInfoLog(S.shaders[e]);n===null&&(n="(unknown error)");var i=n?n.length+1:0;g[t>>2]=i}else if(r==35720){var o=w.getShaderSource(S.shaders[e]),u=o?o.length+1:0;g[t>>2]=u}else g[t>>2]=w.getShaderParameter(S.shaders[e],r)}function kr(e){var r=De(e)+1,t=je(r);return Pe(e,t,r),t}function cu(e){var r=S.stringCache[e];if(!r){switch(e){case 7939:var t=w.getSupportedExtensions()||[];t=t.concat(t.map(function(f){return"GL_"+f})),r=kr(t.join(" "));break;case 7936:case 7937:case 37445:case 37446:var n=w.getParameter(e);n||S.recordError(1280),r=n&&kr(n);break;case 7938:var i=w.getParameter(7938);S.currentContext.version>=2?i="OpenGL ES 3.0 ("+i+")":i="OpenGL ES 2.0 ("+i+")",r=kr(i);break;case 35724:var o=w.getParameter(35724),u=/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/,l=o.match(u);l!==null&&(l[1].length==3&&(l[1]=l[1]+"0"),o="OpenGL ES GLSL ES "+l[1]+" ("+o+")"),r=kr(o);break;default:S.recordError(1280)}S.stringCache[e]=r}return r}function du(e){return parseInt(e)}function sn(e){return e.slice(-1)=="]"&&e.lastIndexOf("[")}function mu(e){var r=e.uniformLocsById,t=e.uniformSizeAndIdsByName,n,i;if(!r)for(e.uniformLocsById=r={},e.uniformArrayNamesById={},n=0;n<w.getProgramParameter(e,35718);++n){var o=w.getActiveUniform(e,n),u=o.name,l=o.size,f=sn(u),v=f>0?u.slice(0,f):u,h=e.uniformIdCounter;for(e.uniformIdCounter+=l,t[v]=[l,h],i=0;i<l;++i)r[h]=i,e.uniformArrayNamesById[h++]=v}}function _u(e,r){if(r=Ce(r),e=S.programs[e]){mu(e);var t=e.uniformLocsById,n=0,i=r,o=sn(r);o>0&&(n=du(r.slice(o+1))>>>0,i=r.slice(0,o));var u=e.uniformSizeAndIdsByName[i];if(u&&n<u[0]&&(n+=u[1],t[n]=t[n]||w.getUniformLocation(e,r)))return n}else S.recordError(1281);return-1}function vu(e,r,t){for(var n=ft[r],i=0;i<r;i++)n[i]=g[t+i*4>>2];w.invalidateFramebuffer(e,n)}function hu(e){e=S.programs[e],w.linkProgram(e),e.uniformLocsById=0,e.uniformSizeAndIdsByName={}}function pu(e,r){e==3317&&(S.unpackAlignment=r),w.pixelStorei(e,r)}function gu(e,r,t,n){function i(l,f){return l+f-1&-f}var o=e*t,u=i(o,n);return r*u}function bu(e){var r={5:3,6:4,8:2,29502:3,29504:4,26917:2,26918:2,29846:3,29847:4};return r[e-6402]||1}function We(e){return e-=5120,e==0?X:e==1?q:e==2?ue:e==4?g:e==6?J:e==5||e==28922||e==28520||e==30779||e==30782?ne:Ge}function ze(e){return 31-Math.clz32(e.BYTES_PER_ELEMENT)}function ct(e,r,t,n,i,o){var u=We(e),l=ze(u),f=1<<l,v=bu(r)*f,h=gu(t,n,v,S.unpackAlignment);return u.subarray(i>>l,i+h>>l)}function yu(e,r,t,n,i,o,u){if(S.currentContext.version>=2){if(w.currentPixelPackBufferBinding)w.readPixels(e,r,t,n,i,o,u);else{var l=We(o);w.readPixels(e,r,t,n,i,o,l,u>>ze(l))}return}var f=ct(o,i,t,n,u);if(!f){S.recordError(1280);return}w.readPixels(e,r,t,n,i,o,f)}function wu(e,r,t,n){w.renderbufferStorage(e,r,t,n)}function Eu(e,r,t,n,i){w.renderbufferStorageMultisample(e,r,t,n,i)}function Cu(e,r,t,n){var i=S.getSource(e,r,t,n);w.shaderSource(S.shaders[e],i)}function Su(e,r,t,n,i,o,u,l,f){if(S.currentContext.version>=2){if(w.currentPixelUnpackBufferBinding)w.texImage2D(e,r,t,n,i,o,u,l,f);else if(f){var v=We(l);w.texImage2D(e,r,t,n,i,o,u,l,v,f>>ze(v))}else w.texImage2D(e,r,t,n,i,o,u,l,null);return}w.texImage2D(e,r,t,n,i,o,u,l,f?ct(l,u,n,i,f):null)}function xu(e,r,t,n,i,o,u,l,f,v){if(w.currentPixelUnpackBufferBinding)w.texImage3D(e,r,t,n,i,o,u,l,f,v);else if(v){var h=We(f);w.texImage3D(e,r,t,n,i,o,u,l,f,h,v>>ze(h))}else w.texImage3D(e,r,t,n,i,o,u,l,f,null)}function ku(e,r,t){w.texParameteri(e,r,t)}function Tu(e,r,t,n,i){w.texStorage2D(e,r,t,n,i)}function Pu(e,r,t,n,i,o){w.texStorage3D(e,r,t,n,i,o)}function Du(e,r,t,n,i,o,u,l,f){if(S.currentContext.version>=2){if(w.currentPixelUnpackBufferBinding)w.texSubImage2D(e,r,t,n,i,o,u,l,f);else if(f){var v=We(l);w.texSubImage2D(e,r,t,n,i,o,u,l,v,f>>ze(v))}else w.texSubImage2D(e,r,t,n,i,o,u,l,null);return}var h=null;f&&(h=ct(l,u,i,o,f)),w.texSubImage2D(e,r,t,n,i,o,u,l,h)}function Fu(e,r,t,n,i,o,u,l,f,v,h){if(w.currentPixelUnpackBufferBinding)w.texSubImage3D(e,r,t,n,i,o,u,l,f,v,h);else if(h){var y=We(v);w.texSubImage3D(e,r,t,n,i,o,u,l,f,v,y,h>>ze(y))}else w.texSubImage3D(e,r,t,n,i,o,u,l,f,v,null)}function be(e){var r=w.currentProgram;if(r){var t=r.uniformLocsById[e];return typeof t=="number"&&(r.uniformLocsById[e]=t=w.getUniformLocation(r,r.uniformArrayNamesById[e]+(t>0?"["+t+"]":""))),t}else S.recordError(1282)}function Au(e,r){w.uniform1f(be(e),r)}function ju(e,r){w.uniform1i(be(e),r)}function Mu(e,r){w.uniform1ui(be(e),r)}function Lu(e,r,t){w.uniform2f(be(e),r,t)}var Tr=[];function Ru(e,r,t){if(S.currentContext.version>=2){w.uniform2fv(be(e),J,t>>2,r*2);return}if(r<=144)for(var n=Tr[2*r-1],i=0;i<2*r;i+=2)n[i]=J[t+4*i>>2],n[i+1]=J[t+(4*i+4)>>2];else var n=J.subarray(t>>2,t+r*8>>2);w.uniform2fv(be(e),n)}function Ou(e,r,t){if(S.currentContext.version>=2){w.uniform4fv(be(e),J,t>>2,r*4);return}if(r<=72){var n=Tr[4*r-1],i=J;t>>=2;for(var o=0;o<4*r;o+=4){var u=t+o;n[o]=i[u],n[o+1]=i[u+1],n[o+2]=i[u+2],n[o+3]=i[u+3]}}else var n=J.subarray(t>>2,t+r*16>>2);w.uniform4fv(be(e),n)}function Iu(e,r,t,n){if(S.currentContext.version>=2){w.uniformMatrix4fv(be(e),!!t,J,n>>2,r*16);return}if(r<=18){var i=Tr[16*r-1],o=J;n>>=2;for(var u=0;u<16*r;u+=16){var l=n+u;i[u]=o[l],i[u+1]=o[l+1],i[u+2]=o[l+2],i[u+3]=o[l+3],i[u+4]=o[l+4],i[u+5]=o[l+5],i[u+6]=o[l+6],i[u+7]=o[l+7],i[u+8]=o[l+8],i[u+9]=o[l+9],i[u+10]=o[l+10],i[u+11]=o[l+11],i[u+12]=o[l+12],i[u+13]=o[l+13],i[u+14]=o[l+14],i[u+15]=o[l+15]}}else var i=J.subarray(n>>2,n+r*64>>2);w.uniformMatrix4fv(be(e),!!t,i)}function Bu(e){e=S.programs[e],w.useProgram(e),w.currentProgram=e}function Nu(e,r,t,n,i){w.vertexAttribIPointer(e,r,t,n,i)}function Uu(e,r,t,n,i,o){w.vertexAttribPointer(e,r,t,!!n,i,o)}function Gu(e,r,t,n){w.viewport(e,r,t,n)}function Vu(){var e=new Date().getFullYear(),r=new Date(e,0,1),t=new Date(e,6,1),n=r.getTimezoneOffset(),i=t.getTimezoneOffset(),o=Math.max(n,i);g[mn()>>2]=o*60,g[dn()>>2]=Number(n!=i);function u(y){var p=y.toTimeString().match(/\(([A-Za-z ]+)\)$/);return p?p[1]:"GMT"}var l=u(r),f=u(t),v=Hr(l),h=Hr(f);i<n?(g[qe()>>2]=v,g[qe()+4>>2]=h):(g[qe()>>2]=h,g[qe()+4>>2]=v)}function Pr(){Pr.called||(Pr.called=!0,Vu())}function $u(e,r){Pr();var t=new Date(g[e>>2]*1e3);g[r>>2]=t.getSeconds(),g[r+4>>2]=t.getMinutes(),g[r+8>>2]=t.getHours(),g[r+12>>2]=t.getDate(),g[r+16>>2]=t.getMonth(),g[r+20>>2]=t.getFullYear()-1900,g[r+24>>2]=t.getDay();var n=new Date(t.getFullYear(),0,1),i=(t.getTime()-n.getTime())/(1e3*60*60*24)|0;g[r+28>>2]=i,g[r+36>>2]=-(t.getTimezoneOffset()*60);var o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),u=n.getTimezoneOffset(),l=(o!=u&&t.getTimezoneOffset()==Math.min(u,o))|0;g[r+32>>2]=l;var f=g[qe()+(l?4:0)>>2];return g[r+40>>2]=f,r}function Wu(e){Pr();var r=new Date(g[e+20>>2]+1900,g[e+16>>2],g[e+12>>2],g[e+8>>2],g[e+4>>2],g[e>>2],0),t=g[e+32>>2],n=r.getTimezoneOffset(),i=new Date(r.getFullYear(),0,1),o=new Date(r.getFullYear(),6,1).getTimezoneOffset(),u=i.getTimezoneOffset(),l=Math.min(u,o);if(t<0)g[e+32>>2]=Number(o!=u&&l==n);else if(t>0!=(l==n)){var f=Math.max(u,o),v=t>0?l:f;r.setTime(r.getTime()+(v-n)*6e4)}g[e+24>>2]=r.getDay();var h=(r.getTime()-i.getTime())/(1e3*60*60*24)|0;return g[e+28>>2]=h,g[e>>2]=r.getSeconds(),g[e+4>>2]=r.getMinutes(),g[e+8>>2]=r.getHours(),g[e+12>>2]=r.getDate(),g[e+16>>2]=r.getMonth(),r.getTime()/1e3|0}function zu(e){}function Dr(e){return e%4===0&&(e%100!==0||e%400===0)}function dt(e,r){for(var t=0,n=0;n<=r;t+=e[n++]);return t}var Fr=[31,29,31,30,31,30,31,31,30,31,30,31],Ar=[31,28,31,30,31,30,31,31,30,31,30,31];function jr(e,r){for(var t=new Date(e.getTime());r>0;){var n=Dr(t.getFullYear()),i=t.getMonth(),o=(n?Fr:Ar)[i];if(r>o-t.getDate())r-=o-t.getDate()+1,t.setDate(1),i<11?t.setMonth(i+1):(t.setMonth(0),t.setFullYear(t.getFullYear()+1));else return t.setDate(t.getDate()+r),t}return t}function Hu(e,r,t,n){var i=g[n+40>>2],o={tm_sec:g[n>>2],tm_min:g[n+4>>2],tm_hour:g[n+8>>2],tm_mday:g[n+12>>2],tm_mon:g[n+16>>2],tm_year:g[n+20>>2],tm_wday:g[n+24>>2],tm_yday:g[n+28>>2],tm_isdst:g[n+32>>2],tm_gmtoff:g[n+36>>2],tm_zone:i?Ce(i):""},u=Ce(t),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var f in l)u=u.replace(new RegExp(f,"g"),l[f]);var v=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];function y(k,D,U){for(var R=typeof k=="number"?k.toString():k||"";R.length<D;)R=U[0]+R;return R}function p(k,D){return y(k,D,"0")}function x(k,D){function U(B){return B<0?-1:B>0?1:0}var R;return(R=U(k.getFullYear()-D.getFullYear()))===0&&(R=U(k.getMonth()-D.getMonth()))===0&&(R=U(k.getDate()-D.getDate())),R}function P(k){switch(k.getDay()){case 0:return new Date(k.getFullYear()-1,11,29);case 1:return k;case 2:return new Date(k.getFullYear(),0,3);case 3:return new Date(k.getFullYear(),0,2);case 4:return new Date(k.getFullYear(),0,1);case 5:return new Date(k.getFullYear()-1,11,31);case 6:return new Date(k.getFullYear()-1,11,30)}}function j(k){var D=jr(new Date(k.tm_year+1900,0,1),k.tm_yday),U=new Date(D.getFullYear(),0,4),R=new Date(D.getFullYear()+1,0,4),B=P(U),Y=P(R);return x(B,D)<=0?x(Y,D)<=0?D.getFullYear()+1:D.getFullYear():D.getFullYear()-1}var I={"%a":function(k){return v[k.tm_wday].substring(0,3)},"%A":function(k){return v[k.tm_wday]},"%b":function(k){return h[k.tm_mon].substring(0,3)},"%B":function(k){return h[k.tm_mon]},"%C":function(k){var D=k.tm_year+1900;return p(D/100|0,2)},"%d":function(k){return p(k.tm_mday,2)},"%e":function(k){return y(k.tm_mday,2," ")},"%g":function(k){return j(k).toString().substring(2)},"%G":function(k){return j(k)},"%H":function(k){return p(k.tm_hour,2)},"%I":function(k){var D=k.tm_hour;return D==0?D=12:D>12&&(D-=12),p(D,2)},"%j":function(k){return p(k.tm_mday+dt(Dr(k.tm_year+1900)?Fr:Ar,k.tm_mon-1),3)},"%m":function(k){return p(k.tm_mon+1,2)},"%M":function(k){return p(k.tm_min,2)},"%n":function(){return`
`},"%p":function(k){return k.tm_hour>=0&&k.tm_hour<12?"AM":"PM"},"%S":function(k){return p(k.tm_sec,2)},"%t":function(){return"	"},"%u":function(k){return k.tm_wday||7},"%U":function(k){var D=new Date(k.tm_year+1900,0,1),U=D.getDay()===0?D:jr(D,7-D.getDay()),R=new Date(k.tm_year+1900,k.tm_mon,k.tm_mday);if(x(U,R)<0){var B=dt(Dr(R.getFullYear())?Fr:Ar,R.getMonth()-1)-31,Y=31-U.getDate(),ee=Y+B+R.getDate();return p(Math.ceil(ee/7),2)}return x(U,D)===0?"01":"00"},"%V":function(k){var D=new Date(k.tm_year+1900,0,4),U=new Date(k.tm_year+1901,0,4),R=P(D),B=P(U),Y=jr(new Date(k.tm_year+1900,0,1),k.tm_yday);if(x(Y,R)<0)return"53";if(x(B,Y)<=0)return"01";var ee;return R.getFullYear()<k.tm_year+1900?ee=k.tm_yday+32-R.getDate():ee=k.tm_yday+1-R.getDate(),p(Math.ceil(ee/7),2)},"%w":function(k){return k.tm_wday},"%W":function(k){var D=new Date(k.tm_year,0,1),U=D.getDay()===1?D:jr(D,D.getDay()===0?1:7-D.getDay()+1),R=new Date(k.tm_year+1900,k.tm_mon,k.tm_mday);if(x(U,R)<0){var B=dt(Dr(R.getFullYear())?Fr:Ar,R.getMonth()-1)-31,Y=31-U.getDate(),ee=Y+B+R.getDate();return p(Math.ceil(ee/7),2)}return x(U,D)===0?"01":"00"},"%y":function(k){return(k.tm_year+1900).toString().substring(2)},"%Y":function(k){return k.tm_year+1900},"%z":function(k){var D=k.tm_gmtoff,U=D>=0;return D=Math.abs(D)/60,D=D/60*100+D%60,(U?"+":"-")+String("0000"+D).slice(-4)},"%Z":function(k){return k.tm_zone},"%%":function(){return"%"}};for(var f in I)u.includes(f)&&(u=u.replace(new RegExp(f,"g"),I[f](o)));var N=He(u,!1);return N.length>r?0:(ci(N,e),N.length-1)}function qu(e,r,t,n){return Hu(e,r,t,n)}function Qu(e){var r=Date.now()/1e3|0;return e&&(g[e>>2]=r),r}var un=function(e,r,t,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=s.nextInode++,this.name=r,this.mode=t,this.node_ops={},this.stream_ops={},this.rdev=n},Mr=365,Lr=146;Object.defineProperties(un.prototype,{read:{get:function(){return(this.mode&Mr)===Mr},set:function(e){e?this.mode|=Mr:this.mode&=~Mr}},write:{get:function(){return(this.mode&Lr)===Lr},set:function(e){e?this.mode|=Lr:this.mode&=~Lr}},isFolder:{get:function(){return s.isDir(this.mode)}},isDevice:{get:function(){return s.isChrdev(this.mode)}}}),s.FSNode=un,s.staticInit(),a.FS_createPath=s.createPath,a.FS_createDataFile=s.createDataFile,a.FS_createPreloadedFile=s.createPreloadedFile,a.FS_createLazyFile=s.createLazyFile,a.FS_createDevice=s.createDevice,a.FS_unlink=s.unlink,aa(),$e=a.BindingError=Yr(Error,"BindingError"),Wt=a.InternalError=Yr(Error,"InternalError"),ha(),Aa(),Ta(),Xt=a.UnboundTypeError=Yr(Error,"UnboundTypeError"),Va(),a.requestFullscreen=function(r,t){b.requestFullscreen(r,t)},a.requestAnimationFrame=function(r){b.requestAnimationFrame(r)},a.setCanvasSize=function(r,t,n){b.setCanvasSize(r,t,n)},a.pauseMainLoop=function(){b.mainLoop.pause()},a.resumeMainLoop=function(){b.mainLoop.resume()},a.getUserMedia=function(){b.getUserMedia()},a.createContext=function(r,t,n,i){return b.createContext(r,t,n,i)};for(var w,Ae=0;Ae<32;++Ae)ft.push(new Array(Ae));for(var Yu=new Float32Array(288),Ae=0;Ae<288;++Ae)Tr[Ae]=Yu.subarray(0,Ae+1);function He(e,r,t){var n=t>0?t:De(e)+1,i=new Array(n),o=lr(e,i,0,i.length);return r&&(i.length=o),i}var ln={__clock_gettime:Ai,__cxa_allocate_exception:ji,__cxa_rethrow:Mi,__cxa_throw:Ri,__gmtime_r:Oi,__syscall_fcntl64:Ui,__syscall_fstatat64:Gi,__syscall_ftruncate64:Vi,__syscall_getcwd:$i,__syscall_getdents64:Wi,__syscall_ioctl:zi,__syscall_lstat64:Hi,__syscall_mkdir:qi,__syscall_mmap2:Yi,__syscall_munmap:Ki,__syscall_open:Ji,__syscall_readlink:Zi,__syscall_stat64:ea,__syscall_unlink:ra,_dlopen_js:ta,_dlsym_js:na,_embind_register_bigint:ia,_embind_register_bool:ua,_embind_register_class:Ra,_embind_register_class_class_function:Oa,_embind_register_class_constructor:Ia,_embind_register_class_function:Ba,_embind_register_class_property:Na,_embind_register_emval:$a,_embind_register_enum:za,_embind_register_enum_value:Ha,_embind_register_float:Qa,_embind_register_function:Ya,_embind_register_integer:Ka,_embind_register_memory_view:Ja,_embind_register_smart_ptr:Za,_embind_register_std_string:eo,_embind_register_std_wstring:ro,_embind_register_void:to,_emval_as:no,_emval_call:io,_emval_call_void_method:oo,_emval_decref:nt,_emval_get_method_caller:uo,_emval_get_module_property:lo,_emval_get_property:fo,_emval_incref:co,_emval_is_number:mo,_emval_new_cstring:_o,_emval_run_destructors:vo,_emval_set_property:ho,_emval_take_value:po,abort:go,alBufferData:wo,alDeleteBuffers:Eo,alDeleteSources:Co,alGenBuffers:So,alGenSources:xo,alGetError:ko,alGetSourcei:To,alGetString:Po,alSourcePause:Do,alSourcePlay:Fo,alSourceStop:Ao,alSourcef:jo,alSourcei:an,alcCloseDevice:Mo,alcCreateContext:Ro,alcDestroyContext:Oo,alcGetError:Io,alcGetString:Bo,alcMakeContextCurrent:No,alcOpenDevice:Uo,clock_gettime:Nt,create_video:xi,delete_video:ki,emscripten_get_heap_max:Go,emscripten_get_now:Ze,emscripten_memcpy_big:Vo,emscripten_resize_heap:Wo,environ_get:Ho,environ_sizes_get:qo,exit:tn,fd_close:Qo,fd_read:Yo,fd_seek:Xo,fd_write:Ko,get_camera_texture:Ti,get_current_hostname:Pi,getentropy:xr,gettimeofday:Jo,glActiveTexture:as,glAttachShader:os,glBindAttribLocation:ss,glBindBuffer:us,glBindBufferRange:ls,glBindFramebuffer:fs,glBindRenderbuffer:cs,glBindTexture:ds,glBindVertexArray:ms,glBlendEquation:_s,glBlendFunc:vs,glBlendFuncSeparate:hs,glBlitFramebuffer:ps,glBufferData:gs,glBufferSubData:bs,glClear:ys,glClearBufferfv:ws,glClearColor:Es,glClearDepthf:Cs,glColorMask:Ss,glCompileShader:xs,glCompressedTexImage2D:ks,glCompressedTexImage3D:Ts,glCopyTexSubImage2D:Ps,glCreateProgram:Ds,glCreateShader:Fs,glDeleteBuffers:As,glDeleteFramebuffers:js,glDeleteProgram:Ms,glDeleteRenderbuffers:Ls,glDeleteShader:Rs,glDeleteTextures:Os,glDeleteVertexArrays:Is,glDepthFunc:Bs,glDepthMask:Ns,glDisable:Us,glDrawArrays:Gs,glDrawArraysInstanced:Vs,glDrawBuffers:$s,glDrawElements:Ws,glDrawElementsInstanced:zs,glEnable:Hs,glEnableVertexAttribArray:qs,glFramebufferRenderbuffer:Qs,glFramebufferTexture2D:Ys,glFrontFace:Xs,glGenBuffers:Ks,glGenFramebuffers:Js,glGenRenderbuffers:Zs,glGenTextures:eu,glGenVertexArrays:ru,glGenerateMipmap:tu,glGetError:nu,glGetIntegerv:ou,glGetProgramInfoLog:su,glGetProgramiv:uu,glGetShaderInfoLog:lu,glGetShaderiv:fu,glGetString:cu,glGetUniformLocation:_u,glInvalidateFramebuffer:vu,glLinkProgram:hu,glPixelStorei:pu,glReadPixels:yu,glRenderbufferStorage:wu,glRenderbufferStorageMultisample:Eu,glShaderSource:Cu,glTexImage2D:Su,glTexImage3D:xu,glTexParameteri:ku,glTexStorage2D:Tu,glTexStorage3D:Pu,glTexSubImage2D:Du,glTexSubImage3D:Fu,glUniform1f:Au,glUniform1i:ju,glUniform1ui:Mu,glUniform2f:Lu,glUniform2fv:Ru,glUniform4fv:Ou,glUniformMatrix4fv:Iu,glUseProgram:Bu,glVertexAttribIPointer:Nu,glVertexAttribPointer:Uu,glViewport:Gu,gmtime_r:er,is_electron:Di,localtime_r:$u,mktime:Wu,setTempRet0:zu,strftime_l:qu,time:Qu};Si(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.__wasm_call_ctors).apply(null,arguments)};var je=a._malloc=function(){return(je=a._malloc=a.asm.malloc).apply(null,arguments)},fn=a.___errno_location=function(){return(fn=a.___errno_location=a.asm.__errno_location).apply(null,arguments)},ye=a._free=function(){return(ye=a._free=a.asm.free).apply(null,arguments)},cn=a.___getTypeName=function(){return(cn=a.___getTypeName=a.asm.__getTypeName).apply(null,arguments)};a.___embind_register_native_and_builtin_types=function(){return(a.___embind_register_native_and_builtin_types=a.asm.__embind_register_native_and_builtin_types).apply(null,arguments)};var qe=a.__get_tzname=function(){return(qe=a.__get_tzname=a.asm._get_tzname).apply(null,arguments)},dn=a.__get_daylight=function(){return(dn=a.__get_daylight=a.asm._get_daylight).apply(null,arguments)},mn=a.__get_timezone=function(){return(mn=a.__get_timezone=a.asm._get_timezone).apply(null,arguments)},_n=a.stackAlloc=function(){return(_n=a.stackAlloc=a.asm.stackAlloc).apply(null,arguments)},vn=a._memalign=function(){return(vn=a._memalign=a.asm.memalign).apply(null,arguments)};a.dynCall_ji=function(){return(a.dynCall_ji=a.asm.dynCall_ji).apply(null,arguments)},a.dynCall_jjj=function(){return(a.dynCall_jjj=a.asm.dynCall_jjj).apply(null,arguments)},a.dynCall_jii=function(){return(a.dynCall_jii=a.asm.dynCall_jii).apply(null,arguments)},a.dynCall_jiii=function(){return(a.dynCall_jiii=a.asm.dynCall_jiii).apply(null,arguments)},a.dynCall_viiij=function(){return(a.dynCall_viiij=a.asm.dynCall_viiij).apply(null,arguments)},a.dynCall_viijjiii=function(){return(a.dynCall_viijjiii=a.asm.dynCall_viijjiii).apply(null,arguments)},a.dynCall_iiiiji=function(){return(a.dynCall_iiiiji=a.asm.dynCall_iiiiji).apply(null,arguments)},a.dynCall_iiiijii=function(){return(a.dynCall_iiiijii=a.asm.dynCall_iiiijii).apply(null,arguments)},a.dynCall_iijjj=function(){return(a.dynCall_iijjj=a.asm.dynCall_iijjj).apply(null,arguments)},a.dynCall_viij=function(){return(a.dynCall_viij=a.asm.dynCall_viij).apply(null,arguments)},a.dynCall_iiffj=function(){return(a.dynCall_iiffj=a.asm.dynCall_iiffj).apply(null,arguments)},a.dynCall_jijjiii=function(){return(a.dynCall_jijjiii=a.asm.dynCall_jijjiii).apply(null,arguments)},a.dynCall_vij=function(){return(a.dynCall_vij=a.asm.dynCall_vij).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.dynCall_jiji).apply(null,arguments)},a.dynCall_iiiijj=function(){return(a.dynCall_iiiijj=a.asm.dynCall_iiiijj).apply(null,arguments)},a.dynCall_viijj=function(){return(a.dynCall_viijj=a.asm.dynCall_viijj).apply(null,arguments)},a.dynCall_viiijjjj=function(){return(a.dynCall_viiijjjj=a.asm.dynCall_viiijjjj).apply(null,arguments)},a.dynCall_vijjiii=function(){return(a.dynCall_vijjiii=a.asm.dynCall_vijjiii).apply(null,arguments)},a.dynCall_viiiji=function(){return(a.dynCall_viiiji=a.asm.dynCall_viiiji).apply(null,arguments)},a.dynCall_viiijii=function(){return(a.dynCall_viiijii=a.asm.dynCall_viiijii).apply(null,arguments)},a.dynCall_iiiiiij=function(){return(a.dynCall_iiiiiij=a.asm.dynCall_iiiiiij).apply(null,arguments)},a.dynCall_viji=function(){return(a.dynCall_viji=a.asm.dynCall_viji).apply(null,arguments)},a.dynCall_vijii=function(){return(a.dynCall_vijii=a.asm.dynCall_vijii).apply(null,arguments)},a.dynCall_vijij=function(){return(a.dynCall_vijij=a.asm.dynCall_vijij).apply(null,arguments)},a.dynCall_vijiii=function(){return(a.dynCall_vijiii=a.asm.dynCall_vijiii).apply(null,arguments)},a.dynCall_vijiiif=function(){return(a.dynCall_vijiiif=a.asm.dynCall_vijiiif).apply(null,arguments)},a.dynCall_viiiij=function(){return(a.dynCall_viiiij=a.asm.dynCall_viiiij).apply(null,arguments)},a.dynCall_viiiiji=function(){return(a.dynCall_viiiiji=a.asm.dynCall_viiiiji).apply(null,arguments)},a.dynCall_iiiji=function(){return(a.dynCall_iiiji=a.asm.dynCall_iiiji).apply(null,arguments)},a.dynCall_viiijj=function(){return(a.dynCall_viiijj=a.asm.dynCall_viiijj).apply(null,arguments)},a.dynCall_viijii=function(){return(a.dynCall_viijii=a.asm.dynCall_viijii).apply(null,arguments)},a.dynCall_iiiiij=function(){return(a.dynCall_iiiiij=a.asm.dynCall_iiiiij).apply(null,arguments)},a.dynCall_iiiiijj=function(){return(a.dynCall_iiiiijj=a.asm.dynCall_iiiiijj).apply(null,arguments)},a.dynCall_iiiiiijj=function(){return(a.dynCall_iiiiiijj=a.asm.dynCall_iiiiiijj).apply(null,arguments)},a.dynCall_jijiii=function(){return(a.dynCall_jijiii=a.asm.dynCall_jijiii).apply(null,arguments)},a.dynCall_jijiiii=function(){return(a.dynCall_jijiiii=a.asm.dynCall_jijiiii).apply(null,arguments)},a.dynCall_jijii=function(){return(a.dynCall_jijii=a.asm.dynCall_jijii).apply(null,arguments)},a.dynCall_jijiiiiii=function(){return(a.dynCall_jijiiiiii=a.asm.dynCall_jijiiiiii).apply(null,arguments)},a.dynCall_jijj=function(){return(a.dynCall_jijj=a.asm.dynCall_jijj).apply(null,arguments)},a.dynCall_iijijjji=function(){return(a.dynCall_iijijjji=a.asm.dynCall_iijijjji).apply(null,arguments)},a.dynCall_iiiij=function(){return(a.dynCall_iiiij=a.asm.dynCall_iiiij).apply(null,arguments)},a.dynCall_iiji=function(){return(a.dynCall_iiji=a.asm.dynCall_iiji).apply(null,arguments)},a.dynCall_jijij=function(){return(a.dynCall_jijij=a.asm.dynCall_jijij).apply(null,arguments)},a.dynCall_iijijji=function(){return(a.dynCall_iijijji=a.asm.dynCall_iijijji).apply(null,arguments)},a.dynCall_jij=function(){return(a.dynCall_jij=a.asm.dynCall_jij).apply(null,arguments)},a.addRunDependency=cr,a.removeRunDependency=Je,a.FS_createPath=s.createPath,a.FS_createDataFile=s.createDataFile,a.FS_createPreloadedFile=s.createPreloadedFile,a.FS_createLazyFile=s.createLazyFile,a.FS_createDevice=s.createDevice,a.FS_unlink=s.unlink,a.FS=s,a.GL=S;var Rr;function hn(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}Ke=function e(){Rr||mt(),Rr||(Ke=e)};function mt(e){if(Re>0||(vi(),Re>0))return;function r(){Rr||(Rr=!0,a.calledRun=!0,!Ee&&(hi(),E(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),gi()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),r()},1)):r()}a.run=mt;function Xu(e,r){Te=e,qr()||pi(),Ku(e)}function Ku(e){Te=e,qr()||(a.onExit&&a.onExit(e),Ee=!0),A(e,new hn(e))}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return mt(),on=function(){},a.ready}})();const wl=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),El=_=>(_!==""&&!_.endsWith("/")&&(_+="/"),c=>_+c),Cl=_=>c=>_[c],Sl=async(_,c={})=>{var a,d,E,C;if(await wl())(d=c.info)===null||d===void 0||d.call(c,'The platform supports SIMD. Going to use "BanubaSDK.simd.wasm"');else return(a=c.info)===null||a===void 0||a.call(c,'The platform does not support SIMD. Using "BanubaSDK.wasm"'),_;const F=_("BanubaSDK.simd.wasm");return F?await fetch(F,{method:"HEAD"}).then(A=>A.ok)?A=>{const[O,L]=A.split(".");if(L!=="wasm")return _(A);const W=[O,"simd",L].join(".");return _(W)}:((C=c.warn)===null||C===void 0||C.call(c,`Unable to fetch "BanubaSDK.simd.wasm" from the "${F}". Using "BanubaSDK.wasm" as a fallback`),_):((E=c.warn)===null||E===void 0||E.call(c,'"BanubaSDK.simd.wasm" is missing in the "locateFile" option. Using "BanubaSDK.wasm" as a fallback'),_)},xl=(()=>{try{return new URL(".",import.meta.url).toString()}catch{return""}})(),kl=async(_,c)=>(typeof _>"u"&&(_=xl),typeof _=="string"&&(_=El(_)),typeof _=="object"&&(_=Cl(_)),_=await Sl(_,c),_),Wr=(()=>{const _=[];return{start(){_.push([])},add(c){const a=_[_.length-1];a&&a.push(c)},remove(c){const a=_[_.length-1];if(!a)return;const d=a.findIndex(E=>E===c);d!==-1&&a.splice(d,1)},end(){const c=_.pop();if(c)for(const a of c)a.isDeleted()||a.delete()}}})();class Tl{register(c){Wr.add(c)}unregister(){}}const bt=_=>(Wr.remove(_),_),me=_=>{try{Wr.start();const c=_();return Pl(c)?bt(c):c}finally{Wr.end()}};function Pl(_){return _==null||typeof _!="object"?!1:["isAliasOf","clone","delete","isDeleted","deleteLater"].every(c=>c in _)}var Ne;(function(_){_.ERROR="error",_.WARNING="warn",_.INFO="info",_.DEBUG="debug"})(Ne||(Ne={}));function Dl(_){var c;const a=(c=Object.keys(Ne).reverse().find(E=>typeof _[Ne[E]]=="function"))!==null&&c!==void 0?c:"ERROR",d=E=>{for(const T in Ne)if(E.includes(T)){const F=_[Ne[T]];if(typeof F=="function"){F.call(_,E);return}}const C=_[Ne.DEBUG];typeof C=="function"&&C.call(_,E)};return{logLevel:a,print:d,printErr:d}}async function Yn({clientToken:_,locateFile:c,canvas:a=Fl(),logger:d={warn:console.warn,error:console.error},...E}){var C;const T=await kl(c,d),{logLevel:F,print:M,printErr:A}=Dl(d),O=await new Promise((L,W)=>yl({locateFile:T,FinalizationGroup:Tl,print:M,printErr:A,onAbort:Q=>{Q instanceof WebAssembly.CompileError&&W(new Error(`Failed to compile "BanubaSDK.wasm": the file "${T("BanubaSDK.wasm")}" is invalid. This error is usually caused by misconfigured "locateFile" option, see https://docs.banuba.com/face-ar-sdk-v1/generated/typedoc/modules.html#SDKOptions. Original Error: `+Q))},...E}).then(L,W));try{me(()=>{O.UtilityManager.initialize(new O.VectorString,_),O.UtilityManager.setLogLevel(O.SeverityLevel[F])})}catch(L){throw typeof L=="number"&&(L=new Error(O.getExceptionMessage(L))),L}return O.createContext(a,!0,!0,{alpha:!0,antialias:!1,depth:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!1}),O.canvas=a,typeof WebGL2RenderingContext>"u"&&(["WEBGL_depth_texture","ANGLE_depth_texture","GL_ANGLE_depth_texture","OES_texture_half_float"].every(W=>{var Q;return(Q=O.canvas.getContext("webgl"))===null||Q===void 0?void 0:Q.getExtension(W)})||(C=d.warn)===null||C===void 0||C.call(d,"Depth textures are not supported on the current device.")),O}function Fl(){const _=document.createElement("canvas");return _.style.maxWidth="100%",_.style.objectFit="cover",_}const Al=(_,c,a)=>fetch(_,c).then(d=>{if(!d.body)return d;let E=0;const C=Number(d.headers.get("content-length")||0),T=d.body.getReader();return new Response(new ReadableStream({async start(F){for(var M;;){const{done:A,value:O}=await T.read();if(A?E=C:E+=O.byteLength,(M=a?.onProgress)===null||M===void 0||M.call(a,{total:C,transferred:E}),A)break;F.enqueue(O)}F.close()}}),d)});var jl=`this.self=function(){"use strict";var w=Uint8Array,x=Uint16Array,_=Uint32Array,$=new w([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),L=new w([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ur=new w([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),q=function(r,e){for(var n=new x(31),a=0;a<31;++a)n[a]=e+=1<<r[a-1];for(var f=new _(n[30]),a=1;a<30;++a)for(var l=n[a];l<n[a+1];++l)f[l]=l-n[a]<<5|a;return[n,f]},j=q($,2),b=j[0],hr=j[1];b[28]=258,hr[258]=28;for(var cr=q(L,0),wr=cr[0],P=new x(32768),o=0;o<32768;++o){var F=(o&43690)>>>1|(o&21845)<<1;F=(F&52428)>>>2|(F&13107)<<2,F=(F&61680)>>>4|(F&3855)<<4,P[o]=((F&65280)>>>8|(F&255)<<8)>>>1}for(var A=function(r,e,n){for(var a=r.length,f=0,l=new x(e);f<a;++f)r[f]&&++l[r[f]-1];var h=new x(e);for(f=0;f<e;++f)h[f]=h[f-1]+l[f-1]<<1;var t;if(n){t=new x(1<<e);var i=15-e;for(f=0;f<a;++f)if(r[f])for(var v=f<<4|r[f],u=e-r[f],g=h[r[f]-1]++<<u,S=g|(1<<u)-1;g<=S;++g)t[P[g]>>>i]=v}else for(t=new x(a),f=0;f<a;++f)r[f]&&(t[f]=P[h[r[f]-1]++]>>>15-r[f]);return t},M=new w(288),o=0;o<144;++o)M[o]=8;for(var o=144;o<256;++o)M[o]=9;for(var o=256;o<280;++o)M[o]=7;for(var o=280;o<288;++o)M[o]=8;for(var d=new w(32),o=0;o<32;++o)d[o]=5;var gr=A(M,9,1),sr=A(d,5,1),R=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},m=function(r,e,n){var a=e/8|0;return(r[a]|r[a+1]<<8)>>(e&7)&n},Y=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},Cr=function(r){return(r+7)/8|0},W=function(r,e,n){(e==null||e<0)&&(e=0),(n==null||n>r.length)&&(n=r.length);var a=new(r.BYTES_PER_ELEMENT==2?x:r.BYTES_PER_ELEMENT==4?_:w)(n-e);return a.set(r.subarray(e,n)),a},mr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],s=function(r,e,n){var a=new Error(e||mr[r]);if(a.code=r,Error.captureStackTrace&&Error.captureStackTrace(a,s),!n)throw a;return a},pr=function(r,e,n){var a=r.length;if(!a||n&&n.f&&!n.l)return e||new w(0);var f=!e||n,l=!n||n.i;n||(n={}),e||(e=new w(a*3));var h=function(or){var lr=e.length;if(or>lr){var tr=new w(Math.max(lr*2,or));tr.set(e),e=tr}},t=n.f||0,i=n.p||0,v=n.b||0,u=n.l,g=n.d,S=n.m,k=n.n,B=a*8;do{if(!u){t=m(r,i,1);var U=m(r,i+1,3);if(i+=3,U)if(U==1)u=gr,g=sr,S=9,k=5;else if(U==2){var J=m(r,i,31)+257,rr=m(r,i+10,15)+4,er=J+m(r,i+5,31)+1;i+=14;for(var D=new w(er),K=new w(19),C=0;C<rr;++C)K[ur[C]]=m(r,i+C*3,7);i+=rr*3;for(var nr=R(K),Ur=(1<<nr)-1,Dr=A(K,nr,1),C=0;C<er;){var ar=Dr[m(r,i,Ur)];i+=ar&15;var c=ar>>>4;if(c<16)D[C++]=c;else{var y=0,O=0;for(c==16?(O=3+m(r,i,3),i+=2,y=D[C-1]):c==17?(O=3+m(r,i,7),i+=3):c==18&&(O=11+m(r,i,127),i+=7);O--;)D[C++]=y}}var fr=D.subarray(0,J),z=D.subarray(J);S=R(fr),k=R(z),u=A(fr,S,1),g=A(z,k,1)}else s(1);else{var c=Cr(i)+4,H=r[c-4]|r[c-3]<<8,I=c+H;if(I>a){l&&s(0);break}f&&h(v+H),e.set(r.subarray(c,I),v),n.b=v+=H,n.p=i=I*8,n.f=t;continue}if(i>B){l&&s(0);break}}f&&h(v+131072);for(var Nr=(1<<S)-1,Or=(1<<k)-1,Q=i;;Q=i){var y=u[Y(r,i)&Nr],T=y>>>4;if(i+=y&15,i>B){l&&s(0);break}if(y||s(2),T<256)e[v++]=T;else if(T==256){Q=i,u=null;break}else{var ir=T-254;if(T>264){var C=T-257,N=$[C];ir=m(r,i,(1<<N)-1)+b[C],i+=N}var V=g[Y(r,i)&Or],Z=V>>>4;V||s(3),i+=V&15;var z=wr[Z];if(Z>3){var N=L[Z];z+=Y(r,i)&(1<<N)-1,i+=N}if(i>B){l&&s(0);break}f&&h(v+131072);for(var vr=v+ir;v<vr;v+=4)e[v]=e[v-z],e[v+1]=e[v+1-z],e[v+2]=e[v+2-z],e[v+3]=e[v+3-z];v=vr}}n.l=u,n.p=Q,n.b=v,n.f=t,u&&(t=1,n.m=S,n.d=g,n.n=k)}while(!t);return v==e.length?e:W(e,0,v)},Er=new w(0),E=function(r,e){return r[e]|r[e+1]<<8},p=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},X=function(r,e){return p(r,e)+p(r,e+4)*4294967296};function Sr(r,e){return pr(r,e)}var G=typeof TextDecoder<"u"&&new TextDecoder,kr=0;try{G.decode(Er,{stream:!0}),kr=1}catch{}var Fr=function(r){for(var e="",n=0;;){var a=r[n++],f=(a>127)+(a>223)+(a>239);if(n+f>r.length)return[e,W(r,n-1)];f?f==3?(a=((a&15)<<18|(r[n++]&63)<<12|(r[n++]&63)<<6|r[n++]&63)-65536,e+=String.fromCharCode(55296|a>>10,56320|a&1023)):f&1?e+=String.fromCharCode((a&31)<<6|r[n++]&63):e+=String.fromCharCode((a&15)<<12|(r[n++]&63)<<6|r[n++]&63):e+=String.fromCharCode(a)}};function zr(r,e){if(e){for(var n="",a=0;a<r.length;a+=16384)n+=String.fromCharCode.apply(null,r.subarray(a,a+16384));return n}else{if(G)return G.decode(r);var f=Fr(r),l=f[0],h=f[1];return h.length&&s(8),l}}var xr=function(r,e){return e+30+E(r,e+26)+E(r,e+28)},yr=function(r,e,n){var a=E(r,e+28),f=zr(r.subarray(e+46,e+46+a),!(E(r,e+8)&2048)),l=e+46+a,h=p(r,e+20),t=n&&h==4294967295?Tr(r,l):[h,p(r,e+24),p(r,e+42)],i=t[0],v=t[1],u=t[2];return[E(r,e+10),i,v,f,l+E(r,e+30)+E(r,e+32),u]},Tr=function(r,e){for(;E(r,e)!=1;e+=4+E(r,e+2));return[X(r,e+12),X(r,e+4),X(r,e+20)]};function Ar(r,e){for(var n={},a=r.length-22;p(r,a)!=101010256;--a)(!a||r.length-a>65558)&&s(13);var f=E(r,a+8);if(!f)return{};var l=p(r,a+16),h=l==4294967295;h&&(a=p(r,a-12),p(r,a)!=101075792&&s(13),f=p(r,a+32),l=p(r,a+48));for(var t=e&&e.filter,i=0;i<f;++i){var v=yr(r,l,h),u=v[0],g=v[1],S=v[2],k=v[3],B=v[4],U=v[5],c=xr(r,U);l=B,(!t||t({name:k,size:g,originalSize:S,compression:u}))&&(u?u==8?n[k]=Sr(r.subarray(c,c+g),new w(S)):s(14,"unknown compression type "+u):n[k]=W(r,c,c+g))}return n}const Mr=r=>Ar(r,{filter:({name:e,size:n})=>!(n===0||e.startsWith("__MACOSX/"))});onmessage=({data:r})=>{let e;try{e={id:r.id,data:Mr(r.data)}}catch(n){e={id:r.id,error:n.message}}postMessage(e)};var Br="";return Br}();
`;const yt=new Dn(jl),Ml=async _=>new Promise((c,a)=>{const d=Qn(),E=new Uint8Array(_),C={id:d,data:E},T=({data:F})=>{F.id===C.id&&(yt.removeEventListener("message",T),"error"in F&&a(new Error(F.error)),"data"in F&&c(F.data))};yt.addEventListener("message",T),yt.postMessage(C,[_])}),wt="/";class Xn{constructor(c){Object.defineProperty(this,"_source",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_fs",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_mountpoint",{enumerable:!0,configurable:!0,writable:!0,value:wt}),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._source=c}static async preload(c,a){if(Array.isArray(c)){const E=a?.onProgress;return await Promise.all(c.map((C,T)=>{const F=E?{onProgress:(...M)=>E(T,...M)}:{};return this.preload(C,F)}))}const d=new this(c);return await d.load(a),d}async _fetch(c,a){return await Al(c,{},a).then(d=>{if(d.ok)return d.blob();throw new Error(`${d.status}: Failed to fetch ${c}`)}).then(d=>{if(d.size>0)return d;throw new Error(`The source must not be empty. Received ${d.size} bytes size source.`)})}async _unzip(c){if(!c.type.includes("zip"))throw new TypeError(`The source type must be "application/zip"-like. Received: "${c.type}".`);return await Kn(c).then(Ml).then(a=>Object.entries(a)).then(a=>Object.fromEntries(a))}async load(c){let a=this._source;return typeof a=="string"&&(a=new Request(a)),a instanceof Request&&(a=await this._fetch(a,c)),a instanceof Blob&&(a=await this._unzip(a)),a instanceof Object&&a.constructor===Object&&await Promise.all(Object.entries(a).map(([d,E])=>this.writeFile(d,E))),this._source=null,this._data}_fsWriteFile(c,a){!this._fs||(c=`${this._mountpoint}${c.startsWith("/")?c.substring(1):c}`,Et.write(this._fs,c,a))}async writeFile(c,a){const d=new Uint8Array(a instanceof Blob?await Kn(a):a);this._data[c]=d,this._fsWriteFile(c,this._data[c])}mount(c,a=wt){this._fs=c,this._mountpoint=a.endsWith("/")?a:`${a}/`,Object.entries(this._data).forEach(([d,E])=>this._fsWriteFile(d,E))}unmount(){this._fs=null,this._mountpoint=wt}}function Kn(_){return"arrayBuffer"in _?_.arrayBuffer():new Promise(c=>{const a=new FileReader;a.onload=()=>c(a.result),a.readAsArrayBuffer(_)})}var Et;(function(_){_.write=(c,a,d)=>{const E=a.split("/");E[0]===""&&E.shift(),E.length>1&&E.reduce((C,T)=>(_.exists(c,C)||c.mkdir(C),`${C}/${T}`)),c.writeFile(a,d)},_.exists=(c,a)=>{try{return c.lstat(a),!0}catch(d){if(d.errno===44||d.code==="ENOENT")return!1;throw d}}})(Et||(Et={}));const Jn=(_,c=a=>console.warn(a))=>function(a,d,E){const C=E.value;if(typeof C!="function")throw new TypeError("Only functions can be marked as deprecated");function T(...F){return c.call(this,`DEPRECATION: ${a.constructor.name}.${d}() is deprecated. ${_}`),C.call(this,...F)}return{...E,deprecationWarning:T}};function Zn(){try{return new EventTarget}catch{return document.createDocumentFragment()}}class Ll{constructor(){Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._emitter=Zn()}addEventListener(...c){this._emitter.addEventListener(...c)}removeEventListener(...c){this._emitter.removeEventListener(...c)}dispatchEvent(...c){var a;return(a=this._emitter.dispatchEvent(...c))!==null&&a!==void 0?a:!0}removeAllEventListeners(){this._emitter=Zn()}}class ei{constructor(c){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:`effects/${Qn()}`}),Object.defineProperty(this,"_player",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_resource",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._resource=new Rl(c)}static async preload(c,a){if(Array.isArray(c)){const E=a?.onProgress;return await Promise.all(c.map((C,T)=>{const F=E?{onProgress:(...M)=>E(T,...M)}:{};return this.preload(C,F)}))}const d=new this(c);return await d._load(a),d}async _load(c){await this._resource.load(c)}async _bind(c){await this._resource.load(),this._player=c,this._resource.mount(this._player._sdk.FS,this.name)}_unbind(){this._resource.unmount(),this._player=null}async writeFile(c,a){return this._resource.writeFile(c,a)}callJsMethod(c,a=""){if(!this._player){console.warn("The method won't evaluate: the effect is not applied to a player.");return}const d=this._player._effectManager;return me(()=>d.current().callJsMethod(c,a))}async evalJs(c){if(!this._player){console.warn("The script won't evaluate: the effect is not applied to a player.");return}const a=this._player._effectManager;return new Promise(d=>{me(()=>a.current().evalJs(c,d))})}}ur([Jn("Please, use Effect.evalJs() instead.")],ei.prototype,"callJsMethod",null);class Rl extends Xn{async _unzip(c){let a=await super._unzip(c);const E=Object.keys(a).map(F=>F.split("/").find(Boolean)),C=E[0];return E.every(F=>F===C)&&(a=Object.fromEntries(Object.entries(a).map(([F,M])=>[F.replace(`${C}/`,""),M]))),a}}class ri{constructor(c){Object.defineProperty(this,"_buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._buffer=new ArrayBuffer(c)}get buffer(){return this._buffer}get byteLength(){return this._buffer.byteLength}get byteOffset(){return 0}set(){}}class Ol{constructor(c){Object.defineProperty(this,"ptr",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"length",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.length=c,this.data=new ri(c)}}class Il{constructor(c,a,d){Object.defineProperty(this,"_sdk",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"_byteOffset",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"_byteLength",{enumerable:!0,configurable:!0,writable:!0,value:d})}get buffer(){return this._sdk.HEAPU8.buffer}get byteLength(){return this._byteLength}get byteOffset(){return this._byteOffset}set(c){return this._sdk.HEAPU8.set(c,this._byteOffset)}}class Bl{constructor(c,a=1){Object.defineProperty(this,"_sdk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_free",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inuse",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._sdk=c,this._free=new Array(a).fill(null).map(()=>({ptr:NaN,length:0}))}allocate(c){const a=this._free.shift();if(a)this._inuse.push(a);else return null;return a.length!==c&&(isNaN(a.ptr)||this._sdk._free(a.ptr),a.ptr=this._sdk._malloc(c),a.length=c,a.data=new Il(this._sdk,a.ptr,a.length)),a}release(c){let a;do(a=this._inuse.shift())&&this._free.push(a);while(a&&a.ptr!==c)}reset(){this._free.push(...this._inuse.splice(0,this._inuse.length)),this._free.forEach(c=>{isNaN(c.ptr)||this._sdk._free(c.ptr),c.ptr=NaN,c.length=0})}}var _e;const ti={devicePixelRatio:typeof devicePixelRatio<"u"?devicePixelRatio:1,faceSearchMode:"GOOD",consistencyMode:"SYNCHRONOUS",cameraOrientation:0,maxFaces:1,logger:console};let ve=_e=class extends Ll{constructor(c,a={}){super(),Object.defineProperty(this,"_sdk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_preferences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_meta",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_memory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_releaser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_player",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_effectManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_state",{enumerable:!0,configurable:!0,writable:!0,value:"paused"}),Object.defineProperty(this,"_frames",{enumerable:!0,configurable:!0,writable:!0,value:async function*(){}()});const{width:d,height:E}=c.canvas;this._sdk=c,this._preferences={...ti,fps:30,...a},this._meta={currentFrame:{index:-1,width:d,height:E},upcomingFrame:{index:-1,width:d,height:E}},this._memory=new Bl(this._sdk,5),this._releaser=C=>this._memory.release(C),this._player=me(()=>this._sdk.EffectPlayer.create(new this._sdk.EffectPlayerConfiguration(d,E,!0,this._sdk.FaceSearchMode[this._preferences.faceSearchMode],!1,!1))),this._player.surfaceCreated(this._sdk.canvas.width,this._sdk.canvas.height),this._player.setMaxFaces(this._preferences.maxFaces),this._player.setRenderConsistencyMode(this._sdk.ConsistencyMode[this._preferences.consistencyMode]),this._player.addFrameDurationListener((C,T)=>this.dispatchEvent(new CustomEvent(_e.FRAME_PROCESSED_EVENT,{detail:{instantDuration:C,averagedDuration:T}})),(C,T)=>this.dispatchEvent(new CustomEvent(_e.FRAME_RECEIVED_EVENT,{detail:{instantDuration:C,averagedDuration:T}})),(C,T)=>this.dispatchEvent(new CustomEvent(_e.FRAME_RENDERED_EVENT,{detail:{instantDuration:C,averagedDuration:T}}))),this._player.addFrameDataListener(C=>{me(()=>{this.dispatchEvent(new CustomEvent(_e.FRAME_DATA_EVENT,{detail:C})),C.delete()})}),this._effectManager=this._player.effectManager(),this._effectManager.addEffectActivatedListener(()=>{me(()=>{const C=this._effectManager.current();this.dispatchEvent(new CustomEvent(_e.EFFECT_ACTIVATED_EVENT,{detail:C})),C.delete()})}),this.setVolume(0)}get isPlaying(){return this._state==="playing"}static async create(c){const a=await Yn(c);return new this(a,c)}use(c,a){this._frames=c[Symbol.asyncIterator]({allocate:d=>(this._memory.allocate(d)||new Ol(d)).data,...a})}async applyEffect(c){const a=this,d=c.name;return await c._bind(a),new Promise(E=>{this.addEventListener(_e.EFFECT_ACTIVATED_EVENT,({detail:T})=>{T=bt(T.clone()),E(T),sr(()=>T.delete())},{once:!0}),this.addEventListener(_e.EFFECT_ACTIVATED_EVENT,C),me(()=>{this._effectManager.load(d)});function C({detail:T}){T.url()!==`/${d}`&&(a.removeEventListener(_e.EFFECT_ACTIVATED_EVENT,C),c._unbind())}})}async clearEffect(){return new Promise(c=>{this.addEventListener(_e.EFFECT_ACTIVATED_EVENT,()=>c(),{once:!0}),me(()=>{this._effectManager.load("")})})}async addModule(...c){await Promise.all(c.map(a=>a._bind(this)))}callJsMethod(c,a=""){return me(()=>this._effectManager.current().callJsMethod(c,a))}setVolume(c){this._effectManager.setEffectVolume(c),this.dispatchEvent(new CustomEvent("volumechange",{detail:c}))}_setSurfaceSize(c,a,d=this._preferences.devicePixelRatio){const E=Math.round(window.devicePixelRatio),[C,T]=[screen.width*E,screen.height*E],F=Math.max(1,C/c),M=Math.max(1,T/a),A=Math.max(F,M);d=Math.min(d,A),c*=d,a*=d,this._sdk.setCanvasSize(c,a),this._effectManager.setEffectSize(c,a),this._player.surfaceChanged(c,a)}_pushFrame({data:c,width:a,height:d,format:E="RGBA"},C=[]){if(c instanceof ri)return;const{upcomingFrame:T}=this._meta,F=T.index+1;me(()=>{const M=this._sdk.FrameData.makeFromBpc8(c.byteOffset,this._releaser,a,d,this._sdk.CameraOrientation[`DEG_${this._preferences.cameraOrientation}`],this._sdk.PixelFormat[E],!1,0);if(C.length>0){const A=new this._sdk.VectorFeatureParameter;for(const[O=0,L=0,W=0,Q=0]of C)A.push_back(new this._sdk.FeatureParameter(O,L,W,Q));M.addFeatureParameters(A)}this._player.pushFrameDataWithNumber(M,F),this._player.recognizerProcessFromBuffer(),T.index=F,T.width=a,T.height=d})}_draw(){try{const{currentFrame:c,upcomingFrame:a}=this._meta;(c.width!==a.width||c.height!==a.height)&&this._setSurfaceSize(c.width=a.width,c.height=a.height);const d=this._player.draw(),E=this._sdk.ctx;return E instanceof WebGLRenderingContext||E.bindFramebuffer(E.READ_FRAMEBUFFER,null),d!==-1&&(c.index=d),d}catch(c){throw this._memory.reset(),c}}play({fps:c}={}){typeof c<"u"&&(this._preferences.fps=c),this._state==="pausing"&&(this._state="playing"),this._state!=="playing"&&(this._state="playing",(async()=>{for(;;){const{value:a}=await this._frames.next(this._preferences.fps);if(a||(this._state="paused"),this._state!=="playing")return;this._pushFrame(a)}})(),(async()=>{let a=0;const d=E=>{var C,T,F,M;if(this._state==="pausing"&&(this._state="paused"),this._state!=="playing")return;Qe(d);const A=1e3/this._preferences.fps,O=.1*A;if(!(E-a<A-O)){a=E;try{this._draw()}catch(L){if(L instanceof WebAssembly.RuntimeError)throw this._state="paused",L;this.clearEffect(),(T=(C=this._preferences.logger).warn)===null||T===void 0||T.call(C,"The effect was force cleared due to the exception:"),(M=(F=this._preferences.logger).error)===null||M===void 0||M.call(F,L)}}};Qe(d)})())}async pause(){for(this._state==="playing"&&(this._state="pausing");this._state==="pausing";)await new Promise(c=>Qe(c));if(this._state!=="paused")throw new Error("The pause request was canceled")}async destroy(){await this.pause(),this.removeAllEventListeners(),await this.clearEffect(),this._player.surfaceDestroyed(),this._player.delete(),this._effectManager.delete(),this._memory.reset();for(const c in this)c.startsWith("_")&&c!=="_state"&&Object.defineProperty(this,c,{get(){throw new Error("The player is destroyed.")},set(){throw new Error("The player is destroyed.")}})}};Object.defineProperty(ve,"FRAME_RECEIVED_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"framereceived"}),Object.defineProperty(ve,"FRAME_PROCESSED_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"frameprocessed"}),Object.defineProperty(ve,"FRAME_RENDERED_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"framerendered"}),Object.defineProperty(ve,"FRAME_DATA_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"framedata"}),Object.defineProperty(ve,"EFFECT_ACTIVATED_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"effectactivated"}),ur([Jn("Please, use Effect.evalJs() instead.")],ve.prototype,"callJsMethod",null),ve=_e=ur([ni],ve);function ni(_,c,a){if(a){let T=function(...F){let M;try{if(M=C.call(this,...F),!(M instanceof Promise))return M}catch(A){throw typeof A=="number"&&(A=new Error(this._sdk.getExceptionMessage(A))),A}return M.catch(A=>{throw typeof A=="number"&&(A=new Error(this._sdk.getExceptionMessage(A))),A})};const C=a.value;return typeof C!="function"||C===_.constructor?a:{...a,value:T}}const d=_.prototype,E=Object.getOwnPropertyDescriptors(d);for(const C in E)Object.defineProperty(d,C,ni(d,C,E[C]));return _}class Nl{constructor(c){Object.defineProperty(this,"_resource",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._resource=new Xn(c)}static async preload(c,a){if(Array.isArray(c)){const E=a?.onProgress;return await Promise.all(c.map((C,T)=>{const F=E?{onProgress:(...M)=>E(T,...M)}:{};return this.preload(C,F)}))}const d=new this(c);return await d._load(a),d}async _load(c){await this._resource.load(c)}async _bind(c){await this._resource.load(),this._resource.mount(c._sdk.FS)}}const zr=_=>{if(!(_ instanceof ve))throw new Error(`The "player" must be a Player instance, but "${_}" is received. Make sure you haven't forgot to place "await" before Player.create() call.`)},Ct=new WeakMap,Ul=(_,c)=>{zr(_);const a=typeof c=="string"?document.querySelector(c):c;if(!(a instanceof HTMLElement))throw new Error("Target container is not a DOM element");if(a instanceof HTMLMediaElement||a instanceof HTMLCanvasElement)throw new Error("Target container must be a plain html element like `div`");Ct.set(a,_),a.appendChild(_._sdk.canvas),_.play()},Gl=_=>{const c=typeof _=="string"?document.querySelector(_):_;if(!(c instanceof HTMLElement))throw new Error("Target container is not a DOM element");const a=Ct.get(c);a&&c.removeChild(a._sdk.canvas),Ct.delete(c)},Vl={render:Ul,unmount:Gl};class $l{constructor(c){Object.defineProperty(this,"_player",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),zr(c),this._player=c}async takePhoto(c){var a,d;const E=this._player._sdk.canvas,C=this._player._meta.currentFrame,T=(a=c?.width)!==null&&a!==void 0?a:C.width,F=(d=c?.height)!==null&&d!==void 0?d:C.height,M=zl(E,T,F);return await new Promise((A,O)=>{var L;return M.toBlob(W=>W?A(W):O(new Error("Unexpected error: Unable to create Blob")),(L=c?.type)!==null&&L!==void 0?L:"image/jpeg",c?.quality)})}}const Wl=/(iP(hone|od|ad).*)|(Version\/)14.*Safari/.test(typeof navigator>"u"?"":navigator.userAgent),zl=(_,c=_.width,a=_.height)=>{if(c!==_.width||a!==_.height||Wl){const E=Hl(c,a);return E.getContext("2d").drawImage(_,0,0,E.width,E.height),E}return _},Hl=(_,c)=>{let a;return typeof OffscreenCanvas>"u"?(a=document.createElement("canvas"),a.width=_,a.height=c):(a=new OffscreenCanvas(_,c),a.toBlob=function(d,E,C){this.convertToBlob({type:E,quality:C}).then(d).catch(T=>d(null))}),a},ql=typeof MediaStream<"u"?MediaStream:class{constructor(){throw new Error("The environment does not support MediaStream API")}};class Ye extends ql{constructor(c){zr(c),super();const a=Ye.cache.get(c);if(!a||!a.active){let d=c._sdk.canvas;if(((d.getContext("webgl2")||d.getContext("webgl")).getContextAttributes()||{}).alpha){const T=d,F=document.createElement("canvas"),M=qn.createRenderingContext(F,{alpha:!1}),A=typeof WebGL2RenderingContext<"u";c.addEventListener(ve.FRAME_RENDERED_EVENT,()=>{let O=0,L=0,W=T.width,Q=T.height;A&&([L,Q]=[Q,-Q]),M.drawImage(T,O,L,W,Q)}),d=F}d.captureStream().getTracks().forEach(T=>this.addTrack(T)),Ye.cache.set(c,this)}return Ye.cache.get(c)}getVideoTrack(c=0){return this.getVideoTracks()[c]}getAudioTrack(c=0){return this.getAudioTracks()[c]}stop(){this.getTracks().forEach(c=>c.stop())}}Object.defineProperty(Ye,"cache",{enumerable:!0,configurable:!0,writable:!0,value:new WeakMap});const Ql=typeof MediaRecorder<"u"?MediaRecorder:class{constructor(){throw new Error("The environment does not support MediaRecorder API")}};class Yl extends Ql{constructor(c,a){zr(c);const d=c._sdk.canvas.captureStream();super(d,a)}async stop(){return new Promise((c,a)=>{const d=C=>{super.removeEventListener("dataavailable",d),super.removeEventListener("error",E),c(C.data)},E=C=>{super.removeEventListener("dataavailable",d),super.removeEventListener("error",E),a(C.error)};super.addEventListener("dataavailable",d),super.addEventListener("error",E),super.stop()})}}const Xl="1.5.2";export{Vl as Dom,ei as Effect,$n as Image,$l as ImageCapture,Me as MediaStream,Ye as MediaStreamCapture,Nl as Module,ve as Player,Xl as VERSION,gt as Video,Yl as VideoRecorder,gl as Webcam,Yn as createSDK,ti as defaultPlayerOptions,$r as defaultVideoConstraints,zn as defaultVideoOptions,bt as keep,me as tidy,ol as timers,qn as utils};
