/* eslint-disable */
(function($,He){typeof exports=="object"&&typeof module<"u"?He(exports):typeof define=="function"&&define.amd?define(["exports"],He):($=typeof globalThis<"u"?globalThis:$||self,He($.BanubaSDK={}))})(this,function($){"use strict";let He=0;const kr=()=>He++;class Sr{constructor(f){if(typeof window>"u")return this;const o=URL.createObjectURL(new Blob([f],{type:"text/javascript"})),d=new globalThis.Worker(o);return URL.revokeObjectURL(o),d}}var oa=`this.self=function(){"use strict";onmessage=({data:e})=>{const t={id:e.id};setTimeout(postMessage,e.timeout,t)};var s="";return s}();
`;const Pr=new Sr(oa),Wt=new Map,Tr=(m,f)=>{const o=kr(),d={id:o,timeout:f};return Wt.set(d.id,m),Pr.postMessage(d),o};Pr.onmessage=({data:m})=>{const f=Wt.get(m.id);Wt.delete(m.id),f()};const Dr=1e3/60,ct=[];let Fr=0;const Ar=m=>{const f=kr();if(ct.length===0){const o=performance.now(),d=Dr-(o-Fr)%Dr;Tr(()=>{const w=Fr=performance.now(),C=[...ct];ct.length=0,C.forEach(P=>P(w))},d)}return ct.push(m),f};var ia=Object.freeze(Object.defineProperty({__proto__:null,setTimeout:Tr,requestAnimationFrame:Ar},Symbol.toStringTag,{value:"Module"}));const sa=(...m)=>window.setTimeout(...m),lt=new Map,ua=m=>{const f=window.requestAnimationFrame((...o)=>{lt.delete(f),m(...o)});return lt.set(f,m),f};typeof document<"u"&&document.addEventListener("visibilitychange",()=>{document.visibilityState!=="visible"&&lt.forEach((m,f)=>{lt.delete(f),cancelAnimationFrame(f),Ar(m)})});var ca=Object.freeze(Object.defineProperty({__proto__:null,setTimeout:sa,requestAnimationFrame:ua},Symbol.toStringTag,{value:"Module"}));const jr=()=>document.visibilityState==="visible"?ca:ia,Ne=m=>jr().requestAnimationFrame(m),Xe=(m,f)=>jr().setTimeout(m,f),la={requestAnimationFrame:Ne,setTimeout:Xe},fa=()=>new Promise(m=>Ne(m)),Lr=(m=-1)=>function(f,o,d){const w=d,C=w.value;return{...w,value:async function*(...P){const F=C.apply(this,P);let R=0,j=0;for(;;){const O=1e3/m,I=.1*O;for(;(j=performance.now())-R<O-I;)await fa();R=j;const{done:q,value:ee}=await F.next();if(q)return ee;const ve=yield ee;typeof ve<"u"&&(m=ve)}}}},Mr=async(m,f={})=>new Promise(o=>{const d=document.createElement("video");if(d.muted=!0,d.controls=!1,d.playsInline=!0,Object.assign(d,f),m instanceof globalThis.MediaStream)d.srcObject=m,d.addEventListener("ended",()=>d.srcObject=null,{once:!0}),m.addEventListener("inactive",()=>d.dispatchEvent(new CustomEvent("ended")),{once:!0});else{if(typeof m!="string"){const C=m=URL.createObjectURL(m);d.addEventListener("emptied",()=>URL.revokeObjectURL(C),{once:!0})}d.crossOrigin="anonymous",d.src=m,d.addEventListener("ended",()=>d.src="",{once:!0})}d.style.position="fixed",d.style.zIndex="-9999999",d.style.opacity="0.0000000001",document.body.appendChild(d),d.addEventListener("emptied",()=>d.remove(),{once:!0});const w=setInterval(()=>d.readyState,300);d.addEventListener("play",()=>clearInterval(w),{once:!0}),d.addEventListener("play",()=>o(d),{once:!0}),d.addEventListener("loadedmetadata",()=>d.play(),{once:!0})}),Rr=(m=300,f=150)=>{let o;return typeof OffscreenCanvas>"u"?(o=document.createElement("canvas"),o.width=m,o.height=f):o=new OffscreenCanvas(m,f),o},da=(m,f={})=>{const o=m||Rr(),d=o.getContext("2d",f);return{get width(){return o.width},get height(){return o.height},get format(){return"RGBA"},drawImage:async(w,C,P,F,R)=>{var j,O;o.width=(j=w.videoWidth)!==null&&j!==void 0?j:w.width,o.height=(O=w.videoHeight)!==null&&O!==void 0?O:w.height,d.save(),d.translate(C,P),d.scale(Math.sign(F),Math.sign(R)),w instanceof ImageData?d.putImageData(w,C,P):d.drawImage(w,0,0,Math.abs(F),Math.abs(R)),d.restore()},getImageData:async(w,C,P,F,R)=>{const{width:j,height:O,data:I}=d.getImageData(w,C,P,F);return R.set(I),{width:j,height:O,data:R,format:"RGBA"}},dispose:()=>{}}};var ma=`#version 300 es
#define GLSLIFY 1
uniform vec2 u_scale;out vec2 v_tex_uv;void main(){float x=-1.0+float((gl_VertexID&1)<<2);float y=-1.0+float((gl_VertexID&2)<<1);v_tex_uv.x=(x+1.0)*0.5;v_tex_uv.y=(y+1.0)*0.5;gl_Position=vec4(x,y,0,1);gl_Position.xy*=u_scale;}`,pa=`#version 300 es
precision mediump float;
#define GLSLIFY 1
in vec2 v_tex_uv;uniform sampler2D u_texture;out vec4 fragColor;void main(){fragColor=texture(u_texture,v_tex_uv);}`;const ha={alpha:!0,antialias:!1,depth:!1,desynchronized:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1},va=(m,f={})=>{const o=m||Rr(),d=o.getContext("webgl2",{...ha,...f});if(d==null)return null;const w=Or(d,d.VERTEX_SHADER,ma),C=Or(d,d.FRAGMENT_SHADER,pa),P=ga(d,w,C),F=Ir(d,d.TEXTURE0),R=Ir(d,d.TEXTURE1);let j=null;m instanceof HTMLCanvasElement||(j=d.createFramebuffer(),d.bindFramebuffer(d.FRAMEBUFFER,j),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,R,0));const O=d.createBuffer();d.bindBuffer(d.PIXEL_PACK_BUFFER,O),d.bufferData(d.PIXEL_PACK_BUFFER,0,d.STREAM_READ);const I=d.getUniformLocation(P,"u_scale"),q=d.getParameter(d.IMPLEMENTATION_COLOR_READ_FORMAT),ee=d.getParameter(d.IMPLEMENTATION_COLOR_READ_TYPE),ve=q===d.RGB?"RGB":"RGBA",pt=ve.length;ve==="RGB"&&d.pixelStorei(d.PACK_ALIGNMENT,1);let ie;return{get width(){return d.drawingBufferWidth},get height(){return d.drawingBufferHeight},get format(){return ve},async drawImage(te,Se,de,ue,ne){d.activeTexture(d.TEXTURE0),d.texImage2D(d.TEXTURE_2D,0,q,q,ee,te);const Ee=Math.sign(ue),Pe=Math.sign(ne);(I.x!==Ee||I.y!==Pe)&&d.uniform2fv(I,new Float32Array([I.x=Ee,I.y=Pe])),ue<0&&(ue=Math.abs(ue)),ne<0&&(ne=Math.abs(ne)),(o.width!==ue||o.height!==ne)&&(d.activeTexture(d.TEXTURE1),d.texImage2D(d.TEXTURE_2D,0,q,o.width=ue,o.height=ne,0,q,ee,null),d.viewport(0,0,o.width,o.height)),d.drawArrays(d.TRIANGLES,0,3)},getImageData:async(te,Se,de,ue,ne)=>(ie!==de*ue*pt&&d.bufferData(d.PIXEL_PACK_BUFFER,ie=de*ue*pt,d.STREAM_READ),d.readPixels(te,Se,de,ue,q,ee,0),await ya(d),d.getBufferSubData(d.PIXEL_PACK_BUFFER,0,new DataView(ne.buffer),ne.byteOffset,ie),{width:de,height:ue,data:ne,format:ve}),dispose(){d.bindBuffer(d.PIXEL_PACK_BUFFER,null),d.activeTexture(d.TEXTURE1),j&&d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0),d.bindFramebuffer(d.FRAMEBUFFER,null),d.bindTexture(d.TEXTURE_2D,null),d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,null),d.useProgram(null),d.deleteBuffer(O),d.deleteFramebuffer(j),d.deleteTexture(F),d.deleteTexture(R),d.deleteProgram(P),d.deleteShader(w),d.deleteShader(C)}}};function ga(m,f,o){const d=m.createProgram();return m.attachShader(d,f),m.attachShader(d,o),m.linkProgram(d),m.useProgram(d),d}function Or(m,f,o){const d=m.createShader(f);return m.shaderSource(d,o),m.compileShader(d),d}function Ir(m,f){const o=m.createTexture();return m.activeTexture(f),m.bindTexture(m.TEXTURE_2D,o),m.texImage2D(m.TEXTURE_2D,0,m.RGB,1,1,0,m.RGB,m.UNSIGNED_BYTE,null),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),o}const ba=(m,f)=>{const o=m.clientWaitSync(f,0,0);return o===m.CONDITION_SATISFIED||o===m.ALREADY_SIGNALED};async function ya(m){const f=m.fenceSync(m.SYNC_GPU_COMMANDS_COMPLETE,0);m.flush(),await new Promise(o=>function d(){ba(m,f)?o():Xe(d,2)}()),m.deleteSync(f)}const Qt=(m,f)=>{let o=va(m,f);return o==null&&(o=da(m,f)),o},_a={horizontalFlip:!1,resize:(m,f)=>[m,f],crop:(m,f)=>[0,0,m,f]},Br=(m={})=>{const{resize:f,crop:o,horizontalFlip:d}={..._a,...m};return{dxywh(w){var C,P;const F=(C=w.videoWidth)!==null&&C!==void 0?C:w.width,R=(P=w.videoHeight)!==null&&P!==void 0?P:w.height;let[j,O]=[0,0],[I,q]=f(F,R);return d&&([j,I]=[I,-I]),[j,O,I,q]},sxywh(w){var C,P;const F=(C=w.videoWidth)!==null&&C!==void 0?C:w.width,R=(P=w.videoHeight)!==null&&P!==void 0?P:w.height,[j,O,I,q]=o(F,R);return[j,O,I,q]}}};function Ke(m,f,o,d){var w=arguments.length,C=w<3?f:d===null?d=Object.getOwnPropertyDescriptor(f,o):d,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(m,f,o,d);else for(var F=m.length-1;F>=0;F--)(P=m[F])&&(C=(w<3?P(C):w>3?P(f,o,C):P(f,o))||C);return w>3&&C&&Object.defineProperty(f,o,C),C}var Nr;class Ur{constructor(f){Object.defineProperty(this,"_src",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._src=typeof f=="string"?f:URL.createObjectURL(f)}async*[Nr=Symbol.asyncIterator]({allocate:f,...o}){const d=document.createElement("img");await new Promise((j,O)=>{d.onload=j,d.onerror=O,d.crossOrigin="anonymous",d.src=this._src});const w=Qt(),C=Br(o);w.drawImage(d,...C.dxywh(d));const P=C.sxywh(w),F=new Uint8ClampedArray(P[2]*P[3]*w.format.length),R=await w.getImageData(...P,F);for(w.dispose(),URL.revokeObjectURL(d.src),d.src="";;){const j=f(P[2]*P[3]*w.format.length);await new Promise(O=>Xe(O)),j.set(F),yield{...R,data:j}}}}Ke([Lr(30)],Ur.prototype,Nr,null);var zr;const Gr={loop:!1};class Ht{constructor(f,o){Object.defineProperty(this,"_video",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_ctx",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_src",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._src=f,this._options={...Gr,...o}}async*[zr=Symbol.asyncIterator]({allocate:f,...o}){var d,w;const C=(d=this._video)!==null&&d!==void 0?d:this._video=await Mr(this._src,this._options),P=(w=this._ctx)!==null&&w!==void 0?w:this._ctx=Qt(),F=Br(o);let R=!1;C.addEventListener("pause",()=>C.play()),C.addEventListener("ended",()=>this.stop(),{once:!0}),C.addEventListener("emptied",()=>R=!0,{once:!0}),C.addEventListener("emptied",()=>q.then(()=>P.dispose()),{once:!0}),P.drawImage(C,...F.dxywh(C));let j=F.sxywh(P),O=f(j[2]*j[3]*P.format.length),I=P.getImageData(...j,O),q;for(;!R;)P.drawImage(C,...F.dxywh(C)),j=F.sxywh(P),O=f(j[2]*j[3]*P.format.length),q=P.getImageData(...j,O),await new Promise(ee=>Xe(ee)),yield I,await(I=q),await new Promise(ee=>Ne(ee))}stop(){this._video&&(this._video.srcObject=null,this._video.src=""),this._ctx=null,this._video=null}}Ke([Lr(30)],Ht.prototype,zr,null);class ke{constructor(f){if(Object.defineProperty(this,"_video",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_stream",{enumerable:!0,configurable:!0,writable:!0,value:null}),!ke.cache.has(f))ke.cache.set(f,this);else return ke.cache.get(f);this._stream=f}async*[Symbol.asyncIterator](f){var o;const d=((o=this._video)!==null&&o!==void 0?o:this._video=new Ht(this._stream))[Symbol.asyncIterator](f);let w;for(;;){const{done:C,value:P}=await d.next(w);if(C)break;w=yield P}this.stop()}stop(){var f,o,d;const w=(d=(o=(f=this._stream)===null||f===void 0?void 0:f.getVideoTracks)===null||o===void 0?void 0:o.call(f))!==null&&d!==void 0?d:[];for(const C of w)C.stop();this._stream&&ke.cache.delete(this._stream),this._stream=null,this._video=null}}Object.defineProperty(ke,"cache",{enumerable:!0,configurable:!0,writable:!0,value:new WeakMap});const wa=typeof screen<"u"&&screen.height>screen.width,ft={facingMode:"user",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080},resizeMode:{ideal:"crop-and-scale"}};wa&&(delete ft.width,delete ft.height);class Ea{constructor(f){Object.defineProperty(this,"_stream",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_constraints",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._constraints={...ft,...f}}async start(){var f;return(f=this._stream)!==null&&f!==void 0||(this._stream=await $r(this._constraints)),this}async*[Symbol.asyncIterator]({horizontalFlip:f=!0,...o}){var d;const w=((d=this._stream)!==null&&d!==void 0?d:this._stream=await $r(this._constraints))[Symbol.asyncIterator]({horizontalFlip:f,...o});let C;for(;;){const{done:P,value:F}=await w.next(C);if(P)break;C=yield F}this.stop()}stop(){var f;(f=this._stream)===null||f===void 0||f.stop(),this._stream=null}}const $r=async m=>{if(typeof navigator.mediaDevices>"u")throw new Error(`SecureContext is required to access webcam
It's likely you need to set up HTTPS/TLS for your website
See https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#Encryption_based_security for details `);return new ke(await navigator.mediaDevices.getUserMedia({video:m}))},Vr={createRenderingContext:Qt,createVideoElement:Mr};let Ca="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",qr=(m=21)=>{let f="",o=m;for(;o--;)f+=Ca[Math.random()*64|0];return f};var xa=(()=>{var m=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(o){o=o||{};var o=typeof o<"u"?o:{},d=Object.assign,w,C;o.ready=new Promise(function(e,t){w=e,C=t}),o.expectedDataFileDownloads||(o.expectedDataFileDownloads=0),o.expectedDataFileDownloads++,function(){if(!o.ENVIRONMENT_IS_PTHREAD){var e=function(t){typeof window=="object"?window.encodeURIComponent(window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/"):typeof process>"u"&&typeof location<"u"&&encodeURIComponent(location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/");var r="BanubaSDK.data",n="BanubaSDK.data";typeof o.locateFilePackage=="function"&&!o.locateFile&&(o.locateFile=o.locateFilePackage,te("warning: you defined Module.locateFilePackage, that has been renamed to Module.locateFile (using your locateFilePackage for now)"));var a=o.locateFile?o.locateFile(n,""):n,i=t.remote_package_size;t.package_uuid;function u(v,b,g,S){var D=new XMLHttpRequest;D.open("GET",v,!0),D.responseType="arraybuffer",D.onprogress=function(L){var M=v,U=b;if(L.total&&(U=L.total),L.loaded){D.addedTotal?o.dataFileDownloads[M].loaded=L.loaded:(D.addedTotal=!0,o.dataFileDownloads||(o.dataFileDownloads={}),o.dataFileDownloads[M]={loaded:L.loaded,total:U});var x=0,T=0,B=0;for(var A in o.dataFileDownloads){var Q=o.dataFileDownloads[A];x+=Q.total,T+=Q.loaded,B++}x=Math.ceil(x*o.expectedDataFileDownloads/B),o.setStatus&&o.setStatus("Downloading data... ("+T+"/"+x+")")}else o.dataFileDownloads||o.setStatus&&o.setStatus("Downloading data...")},D.onerror=function(L){throw new Error("NetworkError for: "+v)},D.onload=function(L){if(D.status==200||D.status==304||D.status==206||D.status==0&&D.response){var M=D.response;g(M)}else throw new Error(D.statusText+" : "+D.responseURL)},D.send(null)}var c=null,l=o.getPreloadedPackage?o.getPreloadedPackage(a,i):null;l||u(a,i,function(v){c?(c(v),c=null):l=v});function h(){function v(L,M){if(!L)throw M+new Error().stack}o.FS_createPath("/","bnb_shaders",!0,!0),o.FS_createPath("/bnb_shaders","bnb",!0,!0),o.FS_createPath("/bnb_shaders/bnb","lib",!0,!0),o.FS_createPath("/","frx",!0,!0),o.FS_createPath("/","bnb_js",!0,!0);function b(L,M,U){this.start=L,this.end=M,this.audio=U}b.prototype={requests:{},open:function(L,M){this.name=M,this.requests[M]=this,o.addRunDependency("fp "+this.name)},send:function(){},onload:function(){var L=this.byteArray.subarray(this.start,this.end);this.finish(L)},finish:function(L){var M=this;o.FS_createDataFile(this.name,null,L,!0,!0,!0),o.removeRunDependency("fp "+M.name),this.requests[this.name]=null}};for(var g=t.files,S=0;S<g.length;++S)new b(g[S].start,g[S].end,g[S].audio||0).open("GET",g[S].filename);function D(L){v(L,"Loading data file failed."),v(L instanceof ArrayBuffer,"bad input to processPackageData");var M=new Uint8Array(L);b.prototype.byteArray=M;for(var U=t.files,x=0;x<U.length;++x)b.prototype.requests[U[x].filename].onload();o.removeRunDependency("datafile_BanubaSDK.data")}o.addRunDependency("datafile_BanubaSDK.data"),o.preloadResults||(o.preloadResults={}),o.preloadResults[r]={fromCache:!1},l?(D(l),l=null):c=D}o.calledRun?h():(o.preRun||(o.preRun=[]),o.preRun.push(h))};e({files:[{filename:"/bnb_shaders/.empty",start:0,end:19},{filename:"/bnb_shaders/bnb/anim_transform.glsl",start:19,end:182},{filename:"/bnb_shaders/bnb/color_spaces.glsl",start:182,end:4481},{filename:"/bnb_shaders/bnb/decode_int1010102.glsl",start:4481,end:5680},{filename:"/bnb_shaders/bnb/get_bone.glsl",start:5680,end:6484},{filename:"/bnb_shaders/bnb/get_transform.glsl",start:6484,end:7937},{filename:"/bnb_shaders/bnb/glsl.frag",start:7937,end:8703},{filename:"/bnb_shaders/bnb/glsl.vert",start:8703,end:9754},{filename:"/bnb_shaders/bnb/lut.glsl",start:9754,end:14639},{filename:"/bnb_shaders/bnb/math.glsl",start:14639,end:15012},{filename:"/bnb_shaders/bnb/matrix_operations.glsl",start:15012,end:18773},{filename:"/bnb_shaders/bnb/morph_transform.glsl",start:18773,end:19831},{filename:"/bnb_shaders/bnb/quat_rotation.glsl",start:19831,end:21225},{filename:"/bnb_shaders/bnb/samplers_declaration.glsl",start:21225,end:23969},{filename:"/bnb_shaders/bnb/texture_bicubic.glsl",start:23969,end:25504},{filename:"/bnb_shaders/bnb/textures_lookup.glsl",start:25504,end:28214},{filename:"/bnb_shaders/bnb/transform_uv.glsl",start:28214,end:30651},{filename:"/bnb_shaders/bnb/version.glsl",start:30651,end:30955},{filename:"/bnb_shaders/bnb/lib/apply_light_streaks.frag",start:30955,end:31267},{filename:"/bnb_shaders/bnb/lib/apply_light_streaks.vert",start:31267,end:31522},{filename:"/bnb_shaders/bnb/lib/auto_morph.frag",start:31522,end:31635},{filename:"/bnb_shaders/bnb/lib/auto_morph.vert",start:31635,end:32271},{filename:"/bnb_shaders/bnb/lib/auto_morph_fisheye.frag",start:32271,end:32384},{filename:"/bnb_shaders/bnb/lib/auto_morph_fisheye.vert",start:32384,end:32915},{filename:"/bnb_shaders/bnb/lib/beauty_morph.frag",start:32915,end:33033},{filename:"/bnb_shaders/bnb/lib/beauty_morph.vert",start:33033,end:34198},{filename:"/bnb_shaders/bnb/lib/bg_mask_assosiation.frag",start:34198,end:34543},{filename:"/bnb_shaders/bnb/lib/bg_mask_assosiation.vert",start:34543,end:34924},{filename:"/bnb_shaders/bnb/lib/bg_mask_smoothing.frag",start:34924,end:35923},{filename:"/bnb_shaders/bnb/lib/bg_mask_smoothing.vert",start:35923,end:36128},{filename:"/bnb_shaders/bnb/lib/camera.frag",start:36128,end:37575},{filename:"/bnb_shaders/bnb/lib/camera.vert",start:37575,end:37896},{filename:"/bnb_shaders/bnb/lib/copy_pixels.frag",start:37896,end:38070},{filename:"/bnb_shaders/bnb/lib/copy_pixels.vert",start:38070,end:38325},{filename:"/bnb_shaders/bnb/lib/dual_filter_blur_downscale.frag",start:38325,end:38968},{filename:"/bnb_shaders/bnb/lib/dual_filter_blur_downscale.vert",start:38968,end:39173},{filename:"/bnb_shaders/bnb/lib/dual_filter_blur_upscale.frag",start:39173,end:40085},{filename:"/bnb_shaders/bnb/lib/dual_filter_blur_upscale.vert",start:40085,end:40426},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_0.frag",start:40426,end:41412},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_0.vert",start:41412,end:42003},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_1.frag",start:42003,end:42989},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_1.vert",start:42989,end:43580},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_2.frag",start:43580,end:44566},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_2.vert",start:44566,end:45157},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_3.frag",start:45157,end:46143},{filename:"/bnb_shaders/bnb/lib/filter_light_streaks_3.vert",start:46143,end:46734},{filename:"/bnb_shaders/bnb/lib/gltf.frag",start:46734,end:49111},{filename:"/bnb_shaders/bnb/lib/gltf.vert",start:49111,end:50494},{filename:"/bnb_shaders/bnb/lib/improved_dual_filter_blur_downscale.frag",start:50494,end:51883},{filename:"/bnb_shaders/bnb/lib/init_light_streaks.frag",start:51883,end:52213},{filename:"/bnb_shaders/bnb/lib/init_light_streaks.vert",start:52213,end:52468},{filename:"/bnb_shaders/bnb/lib/mesh_morph.frag",start:52468,end:52586},{filename:"/bnb_shaders/bnb/lib/mesh_morph.vert",start:52586,end:54683},{filename:"/bnb_shaders/bnb/lib/morph_apply.frag",start:54683,end:55026},{filename:"/bnb_shaders/bnb/lib/morph_apply.vert",start:55026,end:57214},{filename:"/bnb_shaders/bnb/lib/morph_blur.frag",start:57214,end:58537},{filename:"/bnb_shaders/bnb/lib/morph_blur.vert",start:58537,end:58869},{filename:"/bnb_shaders/bnb/lib/retouch.frag",start:58869,end:62620},{filename:"/bnb_shaders/bnb/lib/retouch.vert",start:62620,end:63202},{filename:"/bnb_shaders/bnb/lib/static_pos.frag",start:63202,end:63313},{filename:"/bnb_shaders/bnb/lib/static_pos.vert",start:63313,end:63591},{filename:"/bnb_shaders/bnb/lib/uv_morph.frag",start:63591,end:63704},{filename:"/bnb_shaders/bnb/lib/uv_morph.vert",start:63704,end:64235},{filename:"/bnb_shaders/bnb/lib/vbg.frag",start:64235,end:65296},{filename:"/bnb_shaders/bnb/lib/vbg.vert",start:65296,end:66556},{filename:"/resources-versions.txt",start:66556,end:68679},{filename:"/watermark.png",start:68679,end:71165},{filename:"/watermark_blurred.png",start:71165,end:93598},{filename:"/frx/frx.js",start:93598,end:96120},{filename:"/bnb_js/.empty",start:96120,end:96140},{filename:"/bnb_js/background.js",start:96140,end:99473},{filename:"/bnb_js/console.js",start:99473,end:100033},{filename:"/bnb_js/global.js",start:100033,end:100414},{filename:"/bnb_js/legacy.js",start:100414,end:104691},{filename:"/bnb_js/light_streaks.js",start:104691,end:114398},{filename:"/bnb_js/timers.js",start:114398,end:117717}],remote_package_size:117717,package_uuid:"5fa9bc21-03b5-4a50-846a-726ea62f505b"})}}();var P=o.FinalizationGroup,F=d({},o),R="./this.program",j=(e,t)=>{throw t},O=!0,I="";function q(e){return o.locateFile?o.locateFile(e,I):I+e}var ee,ve,pt;typeof document<"u"&&document.currentScript&&(I=document.currentScript.src),m&&(I=m),I.indexOf("blob:")!==0?I=I.substr(0,I.replace(/[?#].*/,"").lastIndexOf("/")+1):I="",ee=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},ve=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){if(n.status==200||n.status==0&&n.response){t(n.response);return}r()},n.onerror=r,n.send(null)};var ie=o.print||console.log.bind(console),te=o.printErr||console.warn.bind(console);d(o,F),F=null,o.arguments,o.thisProgram&&(R=o.thisProgram),o.quit&&(j=o.quit);function Se(e){Se.shown||(Se.shown={}),Se.shown[e]||(Se.shown[e]=1,te(e))}var de;o.wasmBinary&&(de=o.wasmBinary);var ue=o.noExitRuntime||!0;typeof WebAssembly!="object"&&ge("no native wasm support detected");var ne,Ee=!1,Pe;function Je(e,t){e||ge(t)}var tn=0,Za=1;function rn(e,t){var r;return t==Za?r=qn(e.length):r=je(e.length),e.subarray||e.slice?W.set(e,r):W.set(new Uint8Array(e),r),r}var nn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ze(e,t,r){for(var n=t+r,a=t;e[a]&&!(a>=n);)++a;if(a-t>16&&e.subarray&&nn)return nn.decode(e.subarray(t,a));for(var i="";t<a;){var u=e[t++];if(!(u&128)){i+=String.fromCharCode(u);continue}var c=e[t++]&63;if((u&224)==192){i+=String.fromCharCode((u&31)<<6|c);continue}var l=e[t++]&63;if((u&240)==224?u=(u&15)<<12|c<<6|l:u=(u&7)<<18|c<<12|l<<6|e[t++]&63,u<65536)i+=String.fromCharCode(u);else{var h=u-65536;i+=String.fromCharCode(55296|h>>10,56320|h&1023)}}return i}function Ce(e,t){return e?ze(W,e,t):""}function ht(e,t,r,n){if(!(n>0))return 0;for(var a=r,i=r+n-1,u=0;u<e.length;++u){var c=e.charCodeAt(u);if(c>=55296&&c<=57343){var l=e.charCodeAt(++u);c=65536+((c&1023)<<10)|l&1023}if(c<=127){if(r>=i)break;t[r++]=c}else if(c<=2047){if(r+1>=i)break;t[r++]=192|c>>6,t[r++]=128|c&63}else if(c<=65535){if(r+2>=i)break;t[r++]=224|c>>12,t[r++]=128|c>>6&63,t[r++]=128|c&63}else{if(r+3>=i)break;t[r++]=240|c>>18,t[r++]=128|c>>12&63,t[r++]=128|c>>6&63,t[r++]=128|c&63}}return t[r]=0,r-a}function Te(e,t,r){return ht(e,W,t,r)}function De(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&(n=65536+((n&1023)<<10)|e.charCodeAt(++r)&1023),n<=127?++t:n<=2047?t+=2:n<=65535?t+=3:t+=4}return t}var an=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function eo(e,t){for(var r=e,n=r>>1,a=n+t/2;!(n>=a)&&Ge[n];)++n;if(r=n<<1,r-e>32&&an)return an.decode(W.subarray(e,r));for(var i="",u=0;!(u>=t/2);++u){var c=ce[e+u*2>>1];if(c==0)break;i+=String.fromCharCode(c)}return i}function to(e,t,r){if(r===void 0&&(r=2147483647),r<2)return 0;r-=2;for(var n=t,a=r<e.length*2?r/2:e.length,i=0;i<a;++i){var u=e.charCodeAt(i);ce[t>>1]=u,t+=2}return ce[t>>1]=0,t-n}function ro(e){return e.length*2}function no(e,t){for(var r=0,n="";!(r>=t/4);){var a=y[e+r*4>>2];if(a==0)break;if(++r,a>=65536){var i=a-65536;n+=String.fromCharCode(55296|i>>10,56320|i&1023)}else n+=String.fromCharCode(a)}return n}function ao(e,t,r){if(r===void 0&&(r=2147483647),r<4)return 0;for(var n=t,a=n+r-4,i=0;i<e.length;++i){var u=e.charCodeAt(i);if(u>=55296&&u<=57343){var c=e.charCodeAt(++i);u=65536+((u&1023)<<10)|c&1023}if(y[t>>2]=u,t+=4,t+4>a)break}return y[t>>2]=0,t-n}function oo(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&++r,t+=4}return t}function tr(e){var t=De(e)+1,r=je(t);return r&&ht(e,H,r,t),r}function io(e,t){H.set(e,t)}function so(e,t,r){for(var n=0;n<e.length;++n)H[t++>>0]=e.charCodeAt(n);r||(H[t>>0]=0)}function uo(e,t){return e%t>0&&(e+=t-e%t),e}var vt,H,W,ce,Ge,y,re,J,on;function sn(e){vt=e,o.HEAP8=H=new Int8Array(e),o.HEAP16=ce=new Int16Array(e),o.HEAP32=y=new Int32Array(e),o.HEAPU8=W=new Uint8Array(e),o.HEAPU16=Ge=new Uint16Array(e),o.HEAPU32=re=new Uint32Array(e),o.HEAPF32=J=new Float32Array(e),o.HEAPF64=on=new Float64Array(e)}o.INITIAL_MEMORY;var un,cn=[],ln=[],fn=[],dn=!1,co=0;function rr(){return ue||co>0}function lo(){if(o.preRun)for(typeof o.preRun=="function"&&(o.preRun=[o.preRun]);o.preRun.length;)ho(o.preRun.shift());nr(cn)}function fo(){!o.noFSInit&&!s.init.initialized&&s.init(),s.ignorePermissions=!1,nr(ln)}function mo(){dn=!0}function po(){if(o.postRun)for(typeof o.postRun=="function"&&(o.postRun=[o.postRun]);o.postRun.length;)go(o.postRun.shift());nr(fn)}function ho(e){cn.unshift(e)}function vo(e){ln.unshift(e)}function go(e){fn.unshift(e)}var Me=0,Ze=null;function Qc(e){return e}function gt(e){Me++,o.monitorRunDependencies&&o.monitorRunDependencies(Me)}function et(e){if(Me--,o.monitorRunDependencies&&o.monitorRunDependencies(Me),Me==0&&Ze){var t=Ze;Ze=null,t()}}o.preloadedImages={},o.preloadedAudios={};function ge(e){o.onAbort&&o.onAbort(e),e="Aborted("+e+")",te(e),Ee=!0,Pe=1,e+=". Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw C(t),t}var bo="data:application/octet-stream;base64,";function mn(e){return e.startsWith(bo)}var me;me="BanubaSDK.wasm",mn(me)||(me=q(me));function pn(e){try{if(e==me&&de)return new Uint8Array(de);if(!pt)throw"both async and sync fetching of the wasm failed"}catch(t){ge(t)}}function yo(){return!de&&O&&typeof fetch=="function"?fetch(me,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+me+"'";return e.arrayBuffer()}).catch(function(){return pn(me)}):Promise.resolve().then(function(){return pn(me)})}function _o(){var e={env:Un,wasi_snapshot_preview1:Un};function t(u,c){var l=u.exports;o.asm=l,ne=o.asm.memory,sn(ne.buffer),un=o.asm.__indirect_function_table,vo(o.asm.__wasm_call_ctors),et()}gt();function r(u){t(u.instance)}function n(u){return yo().then(function(c){return WebAssembly.instantiate(c,e)}).then(function(c){return c}).then(u,function(c){te("failed to asynchronously prepare wasm: "+c),ge(c)})}function a(){return!de&&typeof WebAssembly.instantiateStreaming=="function"&&!mn(me)&&typeof fetch=="function"?fetch(me,{credentials:"same-origin"}).then(function(u){var c=WebAssembly.instantiateStreaming(u,e);return c.then(r,function(l){return te("wasm streaming compile failed: "+l),te("falling back to ArrayBuffer instantiation"),n(r)})}):n(r)}if(o.instantiateWasm)try{var i=o.instantiateWasm(e,t);return i}catch(u){return te("Module.instantiateWasm callback failed with error: "+u),!1}return a().catch(C),{}}var Y,ae;function wo(e){const t=Ce(e),r=s.readFile(t),n=document.createElement("video"),a=URL.createObjectURL(new Blob([r],{type:"video/mp4"})),i=o.proxyVideoRequestsTo;return n.muted=!0,n.autoplay=!1,n.controls=!1,n.playsInline=!0,n.src=i?i+encodeURIComponent(a):a,X.toHandle(n)}function Eo(e){const t=X.toValue(e);URL.revokeObjectURL(t.src),t.src=""}function Co(){return o.useCamTexture&&o.texture?(o.camTextureId||(o.camTextureId=k.getNewId(k.textures),o.texture.name=o.camTextureId,k.textures[o.camTextureId]=o.texture),o.camTextureId):0}function xo(){var e=window.location.hostname,t=De(e)+1,r=je(t);return Te(e,r,t),r}function ko(){return/electron/i.test(navigator.userAgent)}function nr(e){for(;e.length>0;){var t=e.shift();if(typeof t=="function"){t(o);continue}var r=t.func;typeof r=="number"?t.arg===void 0?yt(r)():yt(r)(t.arg):r(t.arg===void 0?null:t.arg)}}var bt=[];function yt(e){var t=bt[e];return t||(e>=bt.length&&(bt.length=e+1),bt[e]=t=un.get(e)),t}function hn(e){if(e instanceof Wn||e=="unwind")return Pe;j(1,e)}var tt;tt=()=>performance.now();var So=!0;function vn(e){return y[zn()>>2]=e,e}function gn(e,t){var r;if(e===0)r=Date.now();else if((e===1||e===4)&&So)r=tt();else return vn(28),-1;return y[t>>2]=r/1e3|0,y[t+4>>2]=r%1e3*1e3*1e3|0,0}function Po(e,t){return gn(e,t)}function To(e){return je(e+16)+16}var bn=[];function Do(){var e=bn.pop();e||ge("no exception to throw");var t=e.get_exception_info(),r=e.get_base_ptr();throw t.get_rethrown()?e.free():(bn.push(e),t.set_rethrown(!0),t.set_caught(!1)),r}function Fo(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(t){y[this.ptr+4>>2]=t},this.get_type=function(){return y[this.ptr+4>>2]},this.set_destructor=function(t){y[this.ptr+8>>2]=t},this.get_destructor=function(){return y[this.ptr+8>>2]},this.set_refcount=function(t){y[this.ptr>>2]=t},this.set_caught=function(t){t=t?1:0,H[this.ptr+12>>0]=t},this.get_caught=function(){return H[this.ptr+12>>0]!=0},this.set_rethrown=function(t){t=t?1:0,H[this.ptr+13>>0]=t},this.get_rethrown=function(){return H[this.ptr+13>>0]!=0},this.init=function(t,r){this.set_type(t),this.set_destructor(r),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=y[this.ptr>>2];y[this.ptr>>2]=t+1},this.release_ref=function(){var t=y[this.ptr>>2];return y[this.ptr>>2]=t-1,t===1}}function Ao(e,t,r){var n=new Fo(e);throw n.init(t,r),e}function rt(e,t){var r=new Date(y[e>>2]*1e3);y[t>>2]=r.getUTCSeconds(),y[t+4>>2]=r.getUTCMinutes(),y[t+8>>2]=r.getUTCHours(),y[t+12>>2]=r.getUTCDate(),y[t+16>>2]=r.getUTCMonth(),y[t+20>>2]=r.getUTCFullYear()-1900,y[t+24>>2]=r.getUTCDay(),y[t+36>>2]=0,y[t+32>>2]=0;var n=Date.UTC(r.getUTCFullYear(),0,1,0,0,0,0),a=(r.getTime()-n)/(1e3*60*60*24)|0;return y[t+28>>2]=a,rt.GMTString||(rt.GMTString=tr("GMT")),y[t+40>>2]=rt.GMTString,t}function jo(e,t){return rt(e,t)}var V={splitPath:function(e){var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return t.exec(e).slice(1)},normalizeArray:function(e,t){for(var r=0,n=e.length-1;n>=0;n--){var a=e[n];a==="."?e.splice(n,1):a===".."?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:function(e){var t=e.charAt(0)==="/",r=e.substr(-1)==="/";return e=V.normalizeArray(e.split("/").filter(function(n){return!!n}),!t).join("/"),!e&&!t&&(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=V.splitPath(e),r=t[0],n=t[1];return!r&&!n?".":(n&&(n=n.substr(0,n.length-1)),r+n)},basename:function(e){if(e==="/")return"/";e=V.normalize(e),e=e.replace(/\/$/,"");var t=e.lastIndexOf("/");return t===-1?e:e.substr(t+1)},extname:function(e){return V.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return V.normalize(e.join("/"))},join2:function(e,t){return V.normalize(e+"/"+t)}};function yn(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}else return function(){ge("randomDevice")}}var xe={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:s.cwd();if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t=n.charAt(0)==="/"}return e=V.normalizeArray(e.split("/").filter(function(a){return!!a}),!t).join("/"),(t?"/":"")+e||"."},relative:function(e,t){e=xe.resolve(e).substr(1),t=xe.resolve(t).substr(1);function r(h){for(var v=0;v<h.length&&h[v]==="";v++);for(var b=h.length-1;b>=0&&h[b]==="";b--);return v>b?[]:h.slice(v,b-v+1)}for(var n=r(e.split("/")),a=r(t.split("/")),i=Math.min(n.length,a.length),u=i,c=0;c<i;c++)if(n[c]!==a[c]){u=c;break}for(var l=[],c=u;c<n.length;c++)l.push("..");return l=l.concat(a.slice(u)),l.join("/")}},Re={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){Re.ttys[e]={input:[],output:[],ops:t},s.registerDevice(e,Re.stream_ops)},stream_ops:{open:function(e){var t=Re.ttys[e.node.rdev];if(!t)throw new s.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,r,n,a){if(!e.tty||!e.tty.ops.get_char)throw new s.ErrnoError(60);for(var i=0,u=0;u<n;u++){var c;try{c=e.tty.ops.get_char(e.tty)}catch{throw new s.ErrnoError(29)}if(c===void 0&&i===0)throw new s.ErrnoError(6);if(c==null)break;i++,t[r+u]=c}return i&&(e.node.timestamp=Date.now()),i},write:function(e,t,r,n,a){if(!e.tty||!e.tty.ops.put_char)throw new s.ErrnoError(60);try{for(var i=0;i<n;i++)e.tty.ops.put_char(e.tty,t[r+i])}catch{throw new s.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),i}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if(typeof window<"u"&&typeof window.prompt=="function"?(t=window.prompt("Input: "),t!==null&&(t+=`
`)):typeof readline=="function"&&(t=readline(),t!==null&&(t+=`
`)),!t)return null;e.input=We(t,!0)}return e.input.shift()},put_char:function(e,t){t===null||t===10?(ie(ze(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(ie(ze(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){t===null||t===10?(te(ze(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(te(ze(e.output,0)),e.output=[])}}};function Lo(e,t){W.fill(0,e,e+t)}function Mo(e,t){return Math.ceil(e/t)*t}function _n(e){e=Mo(e,65536);var t=Yn(65536,e);return t?(Lo(t,e),t):0}var N={ops_table:null,mount:function(e){return N.createNode(null,"/",16895,0)},createNode:function(e,t,r,n){if(s.isBlkdev(r)||s.isFIFO(r))throw new s.ErrnoError(63);N.ops_table||(N.ops_table={dir:{node:{getattr:N.node_ops.getattr,setattr:N.node_ops.setattr,lookup:N.node_ops.lookup,mknod:N.node_ops.mknod,rename:N.node_ops.rename,unlink:N.node_ops.unlink,rmdir:N.node_ops.rmdir,readdir:N.node_ops.readdir,symlink:N.node_ops.symlink},stream:{llseek:N.stream_ops.llseek}},file:{node:{getattr:N.node_ops.getattr,setattr:N.node_ops.setattr},stream:{llseek:N.stream_ops.llseek,read:N.stream_ops.read,write:N.stream_ops.write,allocate:N.stream_ops.allocate,mmap:N.stream_ops.mmap,msync:N.stream_ops.msync}},link:{node:{getattr:N.node_ops.getattr,setattr:N.node_ops.setattr,readlink:N.node_ops.readlink},stream:{}},chrdev:{node:{getattr:N.node_ops.getattr,setattr:N.node_ops.setattr},stream:s.chrdev_stream_ops}});var a=s.createNode(e,t,r,n);return s.isDir(a.mode)?(a.node_ops=N.ops_table.dir.node,a.stream_ops=N.ops_table.dir.stream,a.contents={}):s.isFile(a.mode)?(a.node_ops=N.ops_table.file.node,a.stream_ops=N.ops_table.file.stream,a.usedBytes=0,a.contents=null):s.isLink(a.mode)?(a.node_ops=N.ops_table.link.node,a.stream_ops=N.ops_table.link.stream):s.isChrdev(a.mode)&&(a.node_ops=N.ops_table.chrdev.node,a.stream_ops=N.ops_table.chrdev.stream),a.timestamp=Date.now(),e&&(e.contents[t]=a,e.timestamp=a.timestamp),a},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){var n=1048576;t=Math.max(t,r*(r<n?2:1.125)>>>0),r!=0&&(t=Math.max(t,256));var a=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(a.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t)if(t==0)e.contents=null,e.usedBytes=0;else{var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=s.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,s.isDir(e.mode)?t.size=4096:s.isFile(e.mode)?t.size=e.usedBytes:s.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){t.mode!==void 0&&(e.mode=t.mode),t.timestamp!==void 0&&(e.timestamp=t.timestamp),t.size!==void 0&&N.resizeFileStorage(e,t.size)},lookup:function(e,t){throw s.genericErrors[44]},mknod:function(e,t,r,n){return N.createNode(e,t,r,n)},rename:function(e,t,r){if(s.isDir(e.mode)){var n;try{n=s.lookupNode(t,r)}catch{}if(n)for(var a in n.contents)throw new s.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){var r=s.lookupNode(e,t);for(var n in r.contents)throw new s.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."];for(var r in e.contents)!e.contents.hasOwnProperty(r)||t.push(r);return t},symlink:function(e,t,r){var n=N.createNode(e,t,41471,0);return n.link=r,n},readlink:function(e){if(!s.isLink(e.mode))throw new s.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,r,n,a){var i=e.node.contents;if(a>=e.node.usedBytes)return 0;var u=Math.min(e.node.usedBytes-a,n);if(u>8&&i.subarray)t.set(i.subarray(a,a+u),r);else for(var c=0;c<u;c++)t[r+c]=i[a+c];return u},write:function(e,t,r,n,a,i){if(t.buffer===H.buffer&&(i=!1),!n)return 0;var u=e.node;if(u.timestamp=Date.now(),t.subarray&&(!u.contents||u.contents.subarray)){if(i)return u.contents=t.subarray(r,r+n),u.usedBytes=n,n;if(u.usedBytes===0&&a===0)return u.contents=t.slice(r,r+n),u.usedBytes=n,n;if(a+n<=u.usedBytes)return u.contents.set(t.subarray(r,r+n),a),n}if(N.expandFileStorage(u,a+n),u.contents.subarray&&t.subarray)u.contents.set(t.subarray(r,r+n),a);else for(var c=0;c<n;c++)u.contents[a+c]=t[r+c];return u.usedBytes=Math.max(u.usedBytes,a+n),n},llseek:function(e,t,r){var n=t;if(r===1?n+=e.position:r===2&&s.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new s.ErrnoError(28);return n},allocate:function(e,t,r){N.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,n,a,i){if(t!==0)throw new s.ErrnoError(28);if(!s.isFile(e.node.mode))throw new s.ErrnoError(43);var u,c,l=e.node.contents;if(!(i&2)&&l.buffer===vt)c=!1,u=l.byteOffset;else{if((n>0||n+r<l.length)&&(l.subarray?l=l.subarray(n,n+r):l=Array.prototype.slice.call(l,n,n+r)),c=!0,u=_n(r),!u)throw new s.ErrnoError(48);H.set(l,u)}return{ptr:u,allocated:c}},msync:function(e,t,r,n,a){if(!s.isFile(e.node.mode))throw new s.ErrnoError(43);return a&2||N.stream_ops.write(e,t,0,n,r,!1),0}}};function Ro(e,t,r,n){var a=n?"":"al "+e;ve(e,function(i){Je(i,'Loading data file "'+e+'" failed (no arrayBuffer).'),t(new Uint8Array(i)),a&&et()},function(i){if(r)r();else throw'Loading data file "'+e+'" failed.'}),a&&gt()}var s={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(e,t){if(e=xe.resolve(s.cwd(),e),t=t||{},!e)return{path:"",node:null};var r={follow_mount:!0,recurse_count:0};for(var n in r)t[n]===void 0&&(t[n]=r[n]);if(t.recurse_count>8)throw new s.ErrnoError(32);for(var a=V.normalizeArray(e.split("/").filter(function(g){return!!g}),!1),i=s.root,u="/",c=0;c<a.length;c++){var l=c===a.length-1;if(l&&t.parent)break;if(i=s.lookupNode(i,a[c]),u=V.join2(u,a[c]),s.isMountpoint(i)&&(!l||l&&t.follow_mount)&&(i=i.mounted.root),!l||t.follow)for(var h=0;s.isLink(i.mode);){var v=s.readlink(u);u=xe.resolve(V.dirname(u),v);var b=s.lookupPath(u,{recurse_count:t.recurse_count});if(i=b.node,h++>40)throw new s.ErrnoError(32)}}return{path:u,node:i}},getPath:function(e){for(var t;;){if(s.isRoot(e)){var r=e.mount.mountpoint;return t?r[r.length-1]!=="/"?r+"/"+t:r+t:r}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%s.nameTable.length},hashAddNode:function(e){var t=s.hashName(e.parent.id,e.name);e.name_next=s.nameTable[t],s.nameTable[t]=e},hashRemoveNode:function(e){var t=s.hashName(e.parent.id,e.name);if(s.nameTable[t]===e)s.nameTable[t]=e.name_next;else for(var r=s.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:function(e,t){var r=s.mayLookup(e);if(r)throw new s.ErrnoError(r,e);for(var n=s.hashName(e.id,t),a=s.nameTable[n];a;a=a.name_next){var i=a.name;if(a.parent.id===e.id&&i===t)return a}return s.lookup(e,t)},createNode:function(e,t,r,n){var a=new s.FSNode(e,t,r,n);return s.hashAddNode(a),a},destroyNode:function(e){s.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return(e&61440)===32768},isDir:function(e){return(e&61440)===16384},isLink:function(e){return(e&61440)===40960},isChrdev:function(e){return(e&61440)===8192},isBlkdev:function(e){return(e&61440)===24576},isFIFO:function(e){return(e&61440)===4096},isSocket:function(e){return(e&49152)===49152},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:function(e){var t=s.flagModes[e];if(typeof t>"u")throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t},nodePermissions:function(e,t){return s.ignorePermissions?0:t.includes("r")&&!(e.mode&292)||t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73)?2:0},mayLookup:function(e){var t=s.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{var r=s.lookupNode(e,t);return 20}catch{}return s.nodePermissions(e,"wx")},mayDelete:function(e,t,r){var n;try{n=s.lookupNode(e,t)}catch(i){return i.errno}var a=s.nodePermissions(e,"wx");if(a)return a;if(r){if(!s.isDir(n.mode))return 54;if(s.isRoot(n)||s.getPath(n)===s.cwd())return 10}else if(s.isDir(n.mode))return 31;return 0},mayOpen:function(e,t){return e?s.isLink(e.mode)?32:s.isDir(e.mode)&&(s.flagsToPermissionString(t)!=="r"||t&512)?31:s.nodePermissions(e,s.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||s.MAX_OPEN_FDS;for(var r=e;r<=t;r++)if(!s.streams[r])return r;throw new s.ErrnoError(33)},getStream:function(e){return s.streams[e]},createStream:function(e,t,r){s.FSStream||(s.FSStream=function(){},s.FSStream.prototype={object:{get:function(){return this.node},set:function(u){this.node=u}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}}});var n=new s.FSStream;for(var a in e)n[a]=e[a];e=n;var i=s.nextfd(t,r);return e.fd=i,s.streams[i]=e,e},closeStream:function(e){s.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=s.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new s.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return e&255},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){s.devices[e]={stream_ops:t}},getDevice:function(e){return s.devices[e]},getMounts:function(e){for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs:function(e,t){typeof e=="function"&&(t=e,e=!1),s.syncFSRequests++,s.syncFSRequests>1&&te("warning: "+s.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var r=s.getMounts(s.root.mount),n=0;function a(u){return s.syncFSRequests--,t(u)}function i(u){if(u)return i.errored?void 0:(i.errored=!0,a(u));++n>=r.length&&a(null)}r.forEach(function(u){if(!u.type.syncfs)return i(null);u.type.syncfs(u,e,i)})},mount:function(e,t,r){var n=r==="/",a=!r,i;if(n&&s.root)throw new s.ErrnoError(10);if(!n&&!a){var u=s.lookupPath(r,{follow_mount:!1});if(r=u.path,i=u.node,s.isMountpoint(i))throw new s.ErrnoError(10);if(!s.isDir(i.mode))throw new s.ErrnoError(54)}var c={type:e,opts:t,mountpoint:r,mounts:[]},l=e.mount(c);return l.mount=c,c.root=l,n?s.root=l:i&&(i.mounted=c,i.mount&&i.mount.mounts.push(c)),l},unmount:function(e){var t=s.lookupPath(e,{follow_mount:!1});if(!s.isMountpoint(t.node))throw new s.ErrnoError(28);var r=t.node,n=r.mounted,a=s.getMounts(n);Object.keys(s.nameTable).forEach(function(u){for(var c=s.nameTable[u];c;){var l=c.name_next;a.includes(c.mount)&&s.destroyNode(c),c=l}}),r.mounted=null;var i=r.mount.mounts.indexOf(n);r.mount.mounts.splice(i,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,r){var n=s.lookupPath(e,{parent:!0}),a=n.node,i=V.basename(e);if(!i||i==="."||i==="..")throw new s.ErrnoError(28);var u=s.mayCreate(a,i);if(u)throw new s.ErrnoError(u);if(!a.node_ops.mknod)throw new s.ErrnoError(63);return a.node_ops.mknod(a,i,t,r)},create:function(e,t){return t=t!==void 0?t:438,t&=4095,t|=32768,s.mknod(e,t,0)},mkdir:function(e,t){return t=t!==void 0?t:511,t&=1023,t|=16384,s.mknod(e,t,0)},mkdirTree:function(e,t){for(var r=e.split("/"),n="",a=0;a<r.length;++a)if(r[a]){n+="/"+r[a];try{s.mkdir(n,t)}catch(i){if(i.errno!=20)throw i}}},mkdev:function(e,t,r){return typeof r>"u"&&(r=t,t=438),t|=8192,s.mknod(e,t,r)},symlink:function(e,t){if(!xe.resolve(e))throw new s.ErrnoError(44);var r=s.lookupPath(t,{parent:!0}),n=r.node;if(!n)throw new s.ErrnoError(44);var a=V.basename(t),i=s.mayCreate(n,a);if(i)throw new s.ErrnoError(i);if(!n.node_ops.symlink)throw new s.ErrnoError(63);return n.node_ops.symlink(n,a,e)},rename:function(e,t){var r=V.dirname(e),n=V.dirname(t),a=V.basename(e),i=V.basename(t),u,c,l;if(u=s.lookupPath(e,{parent:!0}),c=u.node,u=s.lookupPath(t,{parent:!0}),l=u.node,!c||!l)throw new s.ErrnoError(44);if(c.mount!==l.mount)throw new s.ErrnoError(75);var h=s.lookupNode(c,a),v=xe.relative(e,n);if(v.charAt(0)!==".")throw new s.ErrnoError(28);if(v=xe.relative(t,r),v.charAt(0)!==".")throw new s.ErrnoError(55);var b;try{b=s.lookupNode(l,i)}catch{}if(h!==b){var g=s.isDir(h.mode),S=s.mayDelete(c,a,g);if(S)throw new s.ErrnoError(S);if(S=b?s.mayDelete(l,i,g):s.mayCreate(l,i),S)throw new s.ErrnoError(S);if(!c.node_ops.rename)throw new s.ErrnoError(63);if(s.isMountpoint(h)||b&&s.isMountpoint(b))throw new s.ErrnoError(10);if(l!==c&&(S=s.nodePermissions(c,"w"),S))throw new s.ErrnoError(S);s.hashRemoveNode(h);try{c.node_ops.rename(h,l,i)}catch(D){throw D}finally{s.hashAddNode(h)}}},rmdir:function(e){var t=s.lookupPath(e,{parent:!0}),r=t.node,n=V.basename(e),a=s.lookupNode(r,n),i=s.mayDelete(r,n,!0);if(i)throw new s.ErrnoError(i);if(!r.node_ops.rmdir)throw new s.ErrnoError(63);if(s.isMountpoint(a))throw new s.ErrnoError(10);r.node_ops.rmdir(r,n),s.destroyNode(a)},readdir:function(e){var t=s.lookupPath(e,{follow:!0}),r=t.node;if(!r.node_ops.readdir)throw new s.ErrnoError(54);return r.node_ops.readdir(r)},unlink:function(e){var t=s.lookupPath(e,{parent:!0}),r=t.node;if(!r)throw new s.ErrnoError(44);var n=V.basename(e),a=s.lookupNode(r,n),i=s.mayDelete(r,n,!1);if(i)throw new s.ErrnoError(i);if(!r.node_ops.unlink)throw new s.ErrnoError(63);if(s.isMountpoint(a))throw new s.ErrnoError(10);r.node_ops.unlink(r,n),s.destroyNode(a)},readlink:function(e){var t=s.lookupPath(e),r=t.node;if(!r)throw new s.ErrnoError(44);if(!r.node_ops.readlink)throw new s.ErrnoError(28);return xe.resolve(s.getPath(r.parent),r.node_ops.readlink(r))},stat:function(e,t){var r=s.lookupPath(e,{follow:!t}),n=r.node;if(!n)throw new s.ErrnoError(44);if(!n.node_ops.getattr)throw new s.ErrnoError(63);return n.node_ops.getattr(n)},lstat:function(e){return s.stat(e,!0)},chmod:function(e,t,r){var n;if(typeof e=="string"){var a=s.lookupPath(e,{follow:!r});n=a.node}else n=e;if(!n.node_ops.setattr)throw new s.ErrnoError(63);n.node_ops.setattr(n,{mode:t&4095|n.mode&-4096,timestamp:Date.now()})},lchmod:function(e,t){s.chmod(e,t,!0)},fchmod:function(e,t){var r=s.getStream(e);if(!r)throw new s.ErrnoError(8);s.chmod(r.node,t)},chown:function(e,t,r,n){var a;if(typeof e=="string"){var i=s.lookupPath(e,{follow:!n});a=i.node}else a=e;if(!a.node_ops.setattr)throw new s.ErrnoError(63);a.node_ops.setattr(a,{timestamp:Date.now()})},lchown:function(e,t,r){s.chown(e,t,r,!0)},fchown:function(e,t,r){var n=s.getStream(e);if(!n)throw new s.ErrnoError(8);s.chown(n.node,t,r)},truncate:function(e,t){if(t<0)throw new s.ErrnoError(28);var r;if(typeof e=="string"){var n=s.lookupPath(e,{follow:!0});r=n.node}else r=e;if(!r.node_ops.setattr)throw new s.ErrnoError(63);if(s.isDir(r.mode))throw new s.ErrnoError(31);if(!s.isFile(r.mode))throw new s.ErrnoError(28);var a=s.nodePermissions(r,"w");if(a)throw new s.ErrnoError(a);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var r=s.getStream(e);if(!r)throw new s.ErrnoError(8);if((r.flags&2097155)===0)throw new s.ErrnoError(28);s.truncate(r.node,t)},utime:function(e,t,r){var n=s.lookupPath(e,{follow:!0}),a=n.node;a.node_ops.setattr(a,{timestamp:Math.max(t,r)})},open:function(e,t,r,n,a){if(e==="")throw new s.ErrnoError(44);t=typeof t=="string"?s.modeStringToFlags(t):t,r=typeof r>"u"?438:r,t&64?r=r&4095|32768:r=0;var i;if(typeof e=="object")i=e;else{e=V.normalize(e);try{var u=s.lookupPath(e,{follow:!(t&131072)});i=u.node}catch{}}var c=!1;if(t&64)if(i){if(t&128)throw new s.ErrnoError(20)}else i=s.mknod(e,r,0),c=!0;if(!i)throw new s.ErrnoError(44);if(s.isChrdev(i.mode)&&(t&=-513),t&65536&&!s.isDir(i.mode))throw new s.ErrnoError(54);if(!c){var l=s.mayOpen(i,t);if(l)throw new s.ErrnoError(l)}t&512&&s.truncate(i,0),t&=-131713;var h=s.createStream({node:i,path:s.getPath(i),id:i.id,flags:t,mode:i.mode,seekable:!0,position:0,stream_ops:i.stream_ops,node_ops:i.node_ops,ungotten:[],error:!1},n,a);return h.stream_ops.open&&h.stream_ops.open(h),o.logReadFiles&&!(t&1)&&(s.readFiles||(s.readFiles={}),e in s.readFiles||(s.readFiles[e]=1)),h},close:function(e){if(s.isClosed(e))throw new s.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{s.closeStream(e.fd)}e.fd=null},isClosed:function(e){return e.fd===null},llseek:function(e,t,r){if(s.isClosed(e))throw new s.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new s.ErrnoError(70);if(r!=0&&r!=1&&r!=2)throw new s.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:function(e,t,r,n,a){if(n<0||a<0)throw new s.ErrnoError(28);if(s.isClosed(e))throw new s.ErrnoError(8);if((e.flags&2097155)===1)throw new s.ErrnoError(8);if(s.isDir(e.node.mode))throw new s.ErrnoError(31);if(!e.stream_ops.read)throw new s.ErrnoError(28);var i=typeof a<"u";if(!i)a=e.position;else if(!e.seekable)throw new s.ErrnoError(70);var u=e.stream_ops.read(e,t,r,n,a);return i||(e.position+=u),u},write:function(e,t,r,n,a,i){if(n<0||a<0)throw new s.ErrnoError(28);if(s.isClosed(e))throw new s.ErrnoError(8);if((e.flags&2097155)===0)throw new s.ErrnoError(8);if(s.isDir(e.node.mode))throw new s.ErrnoError(31);if(!e.stream_ops.write)throw new s.ErrnoError(28);e.seekable&&e.flags&1024&&s.llseek(e,0,2);var u=typeof a<"u";if(!u)a=e.position;else if(!e.seekable)throw new s.ErrnoError(70);var c=e.stream_ops.write(e,t,r,n,a,i);return u||(e.position+=c),c},allocate:function(e,t,r){if(s.isClosed(e))throw new s.ErrnoError(8);if(t<0||r<=0)throw new s.ErrnoError(28);if((e.flags&2097155)===0)throw new s.ErrnoError(8);if(!s.isFile(e.node.mode)&&!s.isDir(e.node.mode))throw new s.ErrnoError(43);if(!e.stream_ops.allocate)throw new s.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap:function(e,t,r,n,a,i){if((a&2)!==0&&(i&2)===0&&(e.flags&2097155)!==2)throw new s.ErrnoError(2);if((e.flags&2097155)===1)throw new s.ErrnoError(2);if(!e.stream_ops.mmap)throw new s.ErrnoError(43);return e.stream_ops.mmap(e,t,r,n,a,i)},msync:function(e,t,r,n,a){return!e||!e.stream_ops.msync?0:e.stream_ops.msync(e,t,r,n,a)},munmap:function(e){return 0},ioctl:function(e,t,r){if(!e.stream_ops.ioctl)throw new s.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile:function(e,t){if(t=t||{},t.flags=t.flags||0,t.encoding=t.encoding||"binary",t.encoding!=="utf8"&&t.encoding!=="binary")throw new Error('Invalid encoding type "'+t.encoding+'"');var r,n=s.open(e,t.flags),a=s.stat(e),i=a.size,u=new Uint8Array(i);return s.read(n,u,0,i,0),t.encoding==="utf8"?r=ze(u,0):t.encoding==="binary"&&(r=u),s.close(n),r},writeFile:function(e,t,r){r=r||{},r.flags=r.flags||577;var n=s.open(e,r.flags,r.mode);if(typeof t=="string"){var a=new Uint8Array(De(t)+1),i=ht(t,a,0,a.length);s.write(n,a,0,i,void 0,r.canOwn)}else if(ArrayBuffer.isView(t))s.write(n,t,0,t.byteLength,void 0,r.canOwn);else throw new Error("Unsupported data type");s.close(n)},cwd:function(){return s.currentPath},chdir:function(e){var t=s.lookupPath(e,{follow:!0});if(t.node===null)throw new s.ErrnoError(44);if(!s.isDir(t.node.mode))throw new s.ErrnoError(54);var r=s.nodePermissions(t.node,"x");if(r)throw new s.ErrnoError(r);s.currentPath=t.path},createDefaultDirectories:function(){s.mkdir("/tmp"),s.mkdir("/home"),s.mkdir("/home/web_user")},createDefaultDevices:function(){s.mkdir("/dev"),s.registerDevice(s.makedev(1,3),{read:function(){return 0},write:function(t,r,n,a,i){return a}}),s.mkdev("/dev/null",s.makedev(1,3)),Re.register(s.makedev(5,0),Re.default_tty_ops),Re.register(s.makedev(6,0),Re.default_tty1_ops),s.mkdev("/dev/tty",s.makedev(5,0)),s.mkdev("/dev/tty1",s.makedev(6,0));var e=yn();s.createDevice("/dev","random",e),s.createDevice("/dev","urandom",e),s.mkdir("/dev/shm"),s.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){s.mkdir("/proc");var e=s.mkdir("/proc/self");s.mkdir("/proc/self/fd"),s.mount({mount:function(){var t=s.createNode(e,"fd",16895,73);return t.node_ops={lookup:function(r,n){var a=+n,i=s.getStream(a);if(!i)throw new s.ErrnoError(8);var u={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return i.path}}};return u.parent=u,u}},t}},{},"/proc/self/fd")},createStandardStreams:function(){o.stdin?s.createDevice("/dev","stdin",o.stdin):s.symlink("/dev/tty","/dev/stdin"),o.stdout?s.createDevice("/dev","stdout",null,o.stdout):s.symlink("/dev/tty","/dev/stdout"),o.stderr?s.createDevice("/dev","stderr",null,o.stderr):s.symlink("/dev/tty1","/dev/stderr"),s.open("/dev/stdin",0),s.open("/dev/stdout",1),s.open("/dev/stderr",1)},ensureErrnoError:function(){s.ErrnoError||(s.ErrnoError=function(e,t){this.node=t,this.setErrno=function(r){this.errno=r},this.setErrno(e),this.message="FS error"},s.ErrnoError.prototype=new Error,s.ErrnoError.prototype.constructor=s.ErrnoError,[44].forEach(function(e){s.genericErrors[e]=new s.ErrnoError(e),s.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:function(){s.ensureErrnoError(),s.nameTable=new Array(4096),s.mount(N,{},"/"),s.createDefaultDirectories(),s.createDefaultDevices(),s.createSpecialDirectories(),s.filesystems={MEMFS:N}},init:function(e,t,r){s.init.initialized=!0,s.ensureErrnoError(),o.stdin=e||o.stdin,o.stdout=t||o.stdout,o.stderr=r||o.stderr,s.createStandardStreams()},quit:function(){s.init.initialized=!1;for(var e=0;e<s.streams.length;e++){var t=s.streams[e];!t||s.close(t)}},getMode:function(e,t){var r=0;return e&&(r|=365),t&&(r|=146),r},findObject:function(e,t){var r=s.analyzePath(e,t);return r.exists?r.object:null},analyzePath:function(e,t){try{var r=s.lookupPath(e,{follow:!t});e=r.path}catch{}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var r=s.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=r.path,n.parentObject=r.node,n.name=V.basename(e),r=s.lookupPath(e,{follow:!t}),n.exists=!0,n.path=r.path,n.object=r.node,n.name=r.node.name,n.isRoot=r.path==="/"}catch(a){n.error=a.errno}return n},createPath:function(e,t,r,n){e=typeof e=="string"?e:s.getPath(e);for(var a=t.split("/").reverse();a.length;){var i=a.pop();if(i){var u=V.join2(e,i);try{s.mkdir(u)}catch{}e=u}}return u},createFile:function(e,t,r,n,a){var i=V.join2(typeof e=="string"?e:s.getPath(e),t),u=s.getMode(n,a);return s.create(i,u)},createDataFile:function(e,t,r,n,a,i){var u=t?V.join2(typeof e=="string"?e:s.getPath(e),t):e,c=s.getMode(n,a),l=s.create(u,c);if(r){if(typeof r=="string"){for(var h=new Array(r.length),v=0,b=r.length;v<b;++v)h[v]=r.charCodeAt(v);r=h}s.chmod(l,c|146);var g=s.open(l,577);s.write(g,r,0,r.length,0,i),s.close(g),s.chmod(l,c)}return l},createDevice:function(e,t,r,n){var a=V.join2(typeof e=="string"?e:s.getPath(e),t),i=s.getMode(!!r,!!n);s.createDevice.major||(s.createDevice.major=64);var u=s.makedev(s.createDevice.major++,0);return s.registerDevice(u,{open:function(c){c.seekable=!1},close:function(c){n&&n.buffer&&n.buffer.length&&n(10)},read:function(c,l,h,v,b){for(var g=0,S=0;S<v;S++){var D;try{D=r()}catch{throw new s.ErrnoError(29)}if(D===void 0&&g===0)throw new s.ErrnoError(6);if(D==null)break;g++,l[h+S]=D}return g&&(c.node.timestamp=Date.now()),g},write:function(c,l,h,v,b){for(var g=0;g<v;g++)try{n(l[h+g])}catch{throw new s.ErrnoError(29)}return v&&(c.node.timestamp=Date.now()),g}}),s.mkdev(a,i,u)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(ee)try{e.contents=We(ee(e.url),!0),e.usedBytes=e.contents.length}catch{throw new s.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:function(e,t,r,n,a){function i(){this.lengthKnown=!1,this.chunks=[]}if(i.prototype.get=function(b){if(!(b>this.length-1||b<0)){var g=b%this.chunkSize,S=b/this.chunkSize|0;return this.getter(S)[g]}},i.prototype.setDataGetter=function(b){this.getter=b},i.prototype.cacheLength=function(){var b=new XMLHttpRequest;if(b.open("HEAD",r,!1),b.send(null),!(b.status>=200&&b.status<300||b.status===304))throw new Error("Couldn't load "+r+". Status: "+b.status);var g=Number(b.getResponseHeader("Content-length")),S,D=(S=b.getResponseHeader("Accept-Ranges"))&&S==="bytes",L=(S=b.getResponseHeader("Content-Encoding"))&&S==="gzip",M=1024*1024;D||(M=g);var U=function(T,B){if(T>B)throw new Error("invalid range ("+T+", "+B+") or no bytes requested!");if(B>g-1)throw new Error("only "+g+" bytes available! programmer error!");var A=new XMLHttpRequest;if(A.open("GET",r,!1),g!==M&&A.setRequestHeader("Range","bytes="+T+"-"+B),typeof Uint8Array<"u"&&(A.responseType="arraybuffer"),A.overrideMimeType&&A.overrideMimeType("text/plain; charset=x-user-defined"),A.send(null),!(A.status>=200&&A.status<300||A.status===304))throw new Error("Couldn't load "+r+". Status: "+A.status);return A.response!==void 0?new Uint8Array(A.response||[]):We(A.responseText||"",!0)},x=this;x.setDataGetter(function(T){var B=T*M,A=(T+1)*M-1;if(A=Math.min(A,g-1),typeof x.chunks[T]>"u"&&(x.chunks[T]=U(B,A)),typeof x.chunks[T]>"u")throw new Error("doXHR failed!");return x.chunks[T]}),(L||!g)&&(M=g=1,g=this.getter(0).length,M=g,ie("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=g,this._chunkSize=M,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var u,c}else var c={isDevice:!1,url:r};var l=s.createFile(e,t,c,n,a);c.contents?l.contents=c.contents:c.url&&(l.contents=null,l.url=c.url),Object.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var h={},v=Object.keys(l.stream_ops);return v.forEach(function(b){var g=l.stream_ops[b];h[b]=function(){return s.forceLoadFile(l),g.apply(null,arguments)}}),h.read=function(b,g,S,D,L){s.forceLoadFile(l);var M=b.node.contents;if(L>=M.length)return 0;var U=Math.min(M.length-L,D);if(M.slice)for(var x=0;x<U;x++)g[S+x]=M[L+x];else for(var x=0;x<U;x++)g[S+x]=M.get(L+x);return U},l.stream_ops=h,l},createPreloadedFile:function(e,t,r,n,a,i,u,c,l,h){_.init();var v=t?xe.resolve(V.join2(e,t)):e;function b(g){function S(L){h&&h(),c||s.createDataFile(e,t,L,n,a,l),i&&i(),et()}var D=!1;o.preloadPlugins.forEach(function(L){D||L.canHandle(v)&&(L.handle(g,v,S,function(){u&&u(),et()}),D=!0)}),D||S(g)}gt(),typeof r=="string"?Ro(r,function(g){b(g)},u):b(r)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,r){t=t||function(){},r=r||function(){};var n=s.indexedDB();try{var a=n.open(s.DB_NAME(),s.DB_VERSION)}catch(i){return r(i)}a.onupgradeneeded=function(){ie("creating db");var i=a.result;i.createObjectStore(s.DB_STORE_NAME)},a.onsuccess=function(){var i=a.result,u=i.transaction([s.DB_STORE_NAME],"readwrite"),c=u.objectStore(s.DB_STORE_NAME),l=0,h=0,v=e.length;function b(){h==0?t():r()}e.forEach(function(g){var S=c.put(s.analyzePath(g).object.contents,g);S.onsuccess=function(){l++,l+h==v&&b()},S.onerror=function(){h++,l+h==v&&b()}}),u.onerror=r},a.onerror=r},loadFilesFromDB:function(e,t,r){t=t||function(){},r=r||function(){};var n=s.indexedDB();try{var a=n.open(s.DB_NAME(),s.DB_VERSION)}catch(i){return r(i)}a.onupgradeneeded=r,a.onsuccess=function(){var i=a.result;try{var u=i.transaction([s.DB_STORE_NAME],"readonly")}catch(g){r(g);return}var c=u.objectStore(s.DB_STORE_NAME),l=0,h=0,v=e.length;function b(){h==0?t():r()}e.forEach(function(g){var S=c.get(g);S.onsuccess=function(){s.analyzePath(g).exists&&s.unlink(g),s.createDataFile(V.dirname(g),V.basename(g),S.result,!0,!0,!0),l++,l+h==v&&b()},S.onerror=function(){h++,l+h==v&&b()}}),u.onerror=r},a.onerror=r}},z={mappings:{},DEFAULT_POLLMASK:5,calculateAt:function(e,t,r){if(t[0]==="/")return t;var n;if(e===-100)n=s.cwd();else{var a=s.getStream(e);if(!a)throw new s.ErrnoError(8);n=a.path}if(t.length==0){if(!r)throw new s.ErrnoError(44);return n}return V.join2(n,t)},doStat:function(e,t,r){try{var n=e(t)}catch(a){if(a&&a.node&&V.normalize(t)!==V.normalize(s.getPath(a.node)))return-54;throw a}return y[r>>2]=n.dev,y[r+4>>2]=0,y[r+8>>2]=n.ino,y[r+12>>2]=n.mode,y[r+16>>2]=n.nlink,y[r+20>>2]=n.uid,y[r+24>>2]=n.gid,y[r+28>>2]=n.rdev,y[r+32>>2]=0,ae=[n.size>>>0,(Y=n.size,+Math.abs(Y)>=1?Y>0?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],y[r+40>>2]=ae[0],y[r+44>>2]=ae[1],y[r+48>>2]=4096,y[r+52>>2]=n.blocks,y[r+56>>2]=n.atime.getTime()/1e3|0,y[r+60>>2]=0,y[r+64>>2]=n.mtime.getTime()/1e3|0,y[r+68>>2]=0,y[r+72>>2]=n.ctime.getTime()/1e3|0,y[r+76>>2]=0,ae=[n.ino>>>0,(Y=n.ino,+Math.abs(Y)>=1?Y>0?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],y[r+80>>2]=ae[0],y[r+84>>2]=ae[1],0},doMsync:function(e,t,r,n,a){var i=W.slice(e,e+r);s.msync(t,i,a,r,n)},doMkdir:function(e,t){return e=V.normalize(e),e[e.length-1]==="/"&&(e=e.substr(0,e.length-1)),s.mkdir(e,t,0),0},doMknod:function(e,t,r){switch(t&61440){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return s.mknod(e,t,r),0},doReadlink:function(e,t,r){if(r<=0)return-28;var n=s.readlink(e),a=Math.min(r,De(n)),i=H[t+a];return Te(n,t,r+1),H[t+a]=i,a},doAccess:function(e,t){if(t&-8)return-28;var r=s.lookupPath(e,{follow:!0}),n=r.node;if(!n)return-44;var a="";return t&4&&(a+="r"),t&2&&(a+="w"),t&1&&(a+="x"),a&&s.nodePermissions(n,a)?-2:0},doDup:function(e,t,r){var n=s.getStream(r);return n&&s.close(n),s.open(e,t,0,r,r).fd},doReadv:function(e,t,r,n){for(var a=0,i=0;i<r;i++){var u=y[t+i*8>>2],c=y[t+(i*8+4)>>2],l=s.read(e,H,u,c,n);if(l<0)return-1;if(a+=l,l<c)break}return a},doWritev:function(e,t,r,n){for(var a=0,i=0;i<r;i++){var u=y[t+i*8>>2],c=y[t+(i*8+4)>>2],l=s.write(e,H,u,c,n);if(l<0)return-1;a+=l}return a},varargs:void 0,get:function(){z.varargs+=4;var e=y[z.varargs-4>>2];return e},getStr:function(e){var t=Ce(e);return t},getStreamFromFD:function(e){var t=s.getStream(e);if(!t)throw new s.ErrnoError(8);return t},get64:function(e,t){return e}};function Oo(e,t,r){z.varargs=r;try{var n=z.getStreamFromFD(e);switch(t){case 0:{var a=z.get();if(a<0)return-28;var i;return i=s.open(n.path,n.flags,0,a),i.fd}case 1:case 2:return 0;case 3:return n.flags;case 4:{var a=z.get();return n.flags|=a,0}case 5:{var a=z.get(),u=0;return ce[a+u>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return vn(28),-1;default:return-28}}catch(c){if(typeof s>"u"||!(c instanceof s.ErrnoError))throw c;return-c.errno}}function Io(e,t,r,n){try{t=z.getStr(t);var a=n&256,i=n&4096;return n=n&-4353,t=z.calculateAt(e,t,i),z.doStat(a?s.lstat:s.stat,t,r)}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return-u.errno}}function Bo(e,t,r){try{var n=z.get64(t,r);return s.ftruncate(e,n),0}catch(a){if(typeof s>"u"||!(a instanceof s.ErrnoError))throw a;return-a.errno}}function No(e,t){try{if(t===0)return-28;var r=s.cwd(),n=De(r);return t<n+1?-68:(Te(r,e,t),e)}catch(a){if(typeof s>"u"||!(a instanceof s.ErrnoError))throw a;return-a.errno}}function Uo(e,t,r){try{var n=z.getStreamFromFD(e);n.getdents||(n.getdents=s.readdir(n.path));for(var a=280,i=0,u=s.llseek(n,0,1),c=Math.floor(u/a);c<n.getdents.length&&i+a<=r;){var l,h,v=n.getdents[c];if(v===".")l=n.id,h=4;else if(v===".."){var b=s.lookupPath(n.path,{parent:!0});l=b.node.id,h=4}else{var g=s.lookupNode(n,v);l=g.id,h=s.isChrdev(g.mode)?2:s.isDir(g.mode)?4:s.isLink(g.mode)?10:8}ae=[l>>>0,(Y=l,+Math.abs(Y)>=1?Y>0?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],y[t+i>>2]=ae[0],y[t+i+4>>2]=ae[1],ae=[(c+1)*a>>>0,(Y=(c+1)*a,+Math.abs(Y)>=1?Y>0?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],y[t+i+8>>2]=ae[0],y[t+i+12>>2]=ae[1],ce[t+i+16>>1]=280,H[t+i+18>>0]=h,Te(v,t+i+19,256),i+=a,c+=1}return s.llseek(n,c*a,0),i}catch(S){if(typeof s>"u"||!(S instanceof s.ErrnoError))throw S;return-S.errno}}function zo(e,t,r){z.varargs=r;try{var n=z.getStreamFromFD(e);switch(t){case 21509:case 21505:return n.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-59;case 21519:{if(!n.tty)return-59;var a=z.get();return y[a>>2]=0,0}case 21520:return n.tty?-28:-59;case 21531:{var a=z.get();return s.ioctl(n,t,a)}case 21523:return n.tty?0:-59;case 21524:return n.tty?0:-59;default:ge("bad ioctl syscall "+t)}}catch(i){if(typeof s>"u"||!(i instanceof s.ErrnoError))throw i;return-i.errno}}function Go(e,t){try{return e=z.getStr(e),z.doStat(s.lstat,e,t)}catch(r){if(typeof s>"u"||!(r instanceof s.ErrnoError))throw r;return-r.errno}}function $o(e,t){try{return e=z.getStr(e),z.doMkdir(e,t)}catch(r){if(typeof s>"u"||!(r instanceof s.ErrnoError))throw r;return-r.errno}}function Vo(e,t,r,n,a,i){i<<=12;var u,c=!1;if((n&16)!==0&&e%65536!==0)return-28;if((n&32)!==0){if(u=_n(t),!u)return-48;c=!0}else{var l=s.getStream(a);if(!l)return-8;var h=s.mmap(l,e,t,i,r,n);u=h.ptr,c=h.allocated}return z.mappings[u]={malloc:u,len:t,allocated:c,fd:a,prot:r,flags:n,offset:i},u}function qo(e,t,r,n,a,i){try{return Vo(e,t,r,n,a,i)}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return-u.errno}}function Yo(e,t){var r=z.mappings[e];if(t===0||!r)return-28;if(t===r.len){var n=s.getStream(r.fd);n&&(r.prot&2&&z.doMsync(e,n,t,r.flags,r.offset),s.munmap(n)),z.mappings[e]=null,r.allocated&&we(r.malloc)}return 0}function Wo(e,t){try{return Yo(e,t)}catch(r){if(typeof s>"u"||!(r instanceof s.ErrnoError))throw r;return-r.errno}}function Qo(e,t,r){z.varargs=r;try{var n=z.getStr(e),a=r?z.get():0,i=s.open(n,t,a);return i.fd}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return-u.errno}}function Ho(e,t,r){try{return e=z.getStr(e),z.doReadlink(e,t,r)}catch(n){if(typeof s>"u"||!(n instanceof s.ErrnoError))throw n;return-n.errno}}function Xo(e,t){try{return e=z.getStr(e),z.doStat(s.stat,e,t)}catch(r){if(typeof s>"u"||!(r instanceof s.ErrnoError))throw r;return-r.errno}}function Ko(e){try{return e=z.getStr(e),s.unlink(e),0}catch(t){if(typeof s>"u"||!(t instanceof s.ErrnoError))throw t;return-t.errno}}function Jo(e,t){ge("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function Zo(e,t){ge("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function ei(e,t,r,n,a){}function _t(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function ti(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);wn=e}var wn=void 0;function Z(e){for(var t="",r=e;W[r];)t+=wn[W[r++]];return t}var $e={},Oe={},wt={},ri=48,ni=57;function Et(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=ri&&t<=ni?"_"+e:e}function Ct(e,t){return e=Et(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(t)}function ar(e,t){var r=Ct(t,function(n){this.name=t,this.message=n;var a=new Error(n).stack;a!==void 0&&(this.stack=this.toString()+`
`+a.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},r}var Ve=void 0;function G(e){throw new Ve(e)}var En=void 0;function xt(e){throw new En(e)}function pe(e,t,r){e.forEach(function(c){wt[c]=t});function n(c){var l=r(c);l.length!==e.length&&xt("Mismatched type converter count");for(var h=0;h<e.length;++h)be(e[h],l[h])}var a=new Array(t.length),i=[],u=0;t.forEach(function(c,l){Oe.hasOwnProperty(c)?a[l]=Oe[c]:(i.push(c),$e.hasOwnProperty(c)||($e[c]=[]),$e[c].push(function(){a[l]=Oe[c],++u,u===i.length&&n(a)}))}),i.length===0&&n(a)}function be(e,t,r){if(r=r||{},!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=t.name;if(e||G('type "'+n+'" must have a positive integer typeid pointer'),Oe.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;G("Cannot register type '"+n+"' twice")}if(Oe[e]=t,delete wt[e],$e.hasOwnProperty(e)){var a=$e[e];delete $e[e],a.forEach(function(i){i()})}}function ai(e,t,r,n,a){var i=_t(r);t=Z(t),be(e,{name:t,fromWireType:function(u){return!!u},toWireType:function(u,c){return c?n:a},argPackAdvance:8,readValueFromPointer:function(u){var c;if(r===1)c=H;else if(r===2)c=ce;else if(r===4)c=y;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(c[u>>i])},destructorFunction:null})}function oi(e){if(!(this instanceof Fe)||!(e instanceof Fe))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,n=e.$$.ptrType.registeredClass,a=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;n.baseClass;)a=n.upcast(a),n=n.baseClass;return t===n&&r===a}function ii(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function or(e){function t(r){return r.$$.ptrType.registeredClass.name}G(t(e)+" instance already deleted")}var ir=!1;function Cn(e){}function si(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function xn(e){e.count.value-=1;var t=e.count.value===0;t&&si(e)}function nt(e){return typeof P>"u"?(nt=function(t){return t},e):(ir=new P(function(t){for(var r=t.next();!r.done;r=t.next()){var n=r.value;n.ptr?xn(n):console.warn("object already deleted: "+n.ptr)}}),nt=function(t){return ir.register(t,t.$$,t.$$),t},Cn=function(t){ir.unregister(t.$$)},nt(e))}function ui(){if(this.$$.ptr||or(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=nt(Object.create(Object.getPrototypeOf(this),{$$:{value:ii(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function ci(){this.$$.ptr||or(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&G("Object already scheduled for deletion"),Cn(this),xn(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function li(){return!this.$$.ptr}var at=void 0,ot=[];function sr(){for(;ot.length;){var e=ot.pop();e.$$.deleteScheduled=!1,e.delete()}}function fi(){return this.$$.ptr||or(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&G("Object already scheduled for deletion"),ot.push(this),ot.length===1&&at&&at(sr),this.$$.deleteScheduled=!0,this}function di(){Fe.prototype.isAliasOf=oi,Fe.prototype.clone=ui,Fe.prototype.delete=ci,Fe.prototype.isDeleted=li,Fe.prototype.deleteLater=fi}function Fe(){}var kn={};function ur(e,t,r){if(e[t].overloadTable===void 0){var n=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||G("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[n.argCount]=n}}function cr(e,t,r){o.hasOwnProperty(e)?((r===void 0||o[e].overloadTable!==void 0&&o[e].overloadTable[r]!==void 0)&&G("Cannot register public name '"+e+"' twice"),ur(o,e,e),o.hasOwnProperty(r)&&G("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),o[e].overloadTable[r]=t):(o[e]=t,r!==void 0&&(o[e].numArguments=r))}function mi(e,t,r,n,a,i,u,c){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=a,this.getActualType=i,this.upcast=u,this.downcast=c,this.pureVirtualFunctions=[]}function kt(e,t,r){for(;t!==r;)t.upcast||G("Expected null or instance of "+r.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function pi(e,t){if(t===null)return this.isReference&&G("null is not a valid "+this.name),0;t.$$||G('Cannot pass "'+mr(t)+'" as a '+this.name),t.$$.ptr||G("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass,n=kt(t.$$.ptr,r,this.registeredClass);return n}function hi(e,t){var r;if(t===null)return this.isReference&&G("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;t.$$||G('Cannot pass "'+mr(t)+'" as a '+this.name),t.$$.ptr||G("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&G("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var n=t.$$.ptrType.registeredClass;if(r=kt(t.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&G("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:G("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var a=t.clone();r=this.rawShare(r,X.toHandle(function(){a.delete()})),e!==null&&e.push(this.rawDestructor,r)}break;default:G("Unsupporting sharing policy")}return r}function vi(e,t){if(t===null)return this.isReference&&G("null is not a valid "+this.name),0;t.$$||G('Cannot pass "'+mr(t)+'" as a '+this.name),t.$$.ptr||G("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&G("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass,n=kt(t.$$.ptr,r,this.registeredClass);return n}function St(e){return this.fromWireType(re[e>>2])}function gi(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function bi(e){this.rawDestructor&&this.rawDestructor(e)}function yi(e){e!==null&&e.delete()}function Sn(e,t,r){if(t===r)return e;if(r.baseClass===void 0)return null;var n=Sn(e,t,r.baseClass);return n===null?null:r.downcast(n)}function _i(){return Object.keys(it).length}function wi(){var e=[];for(var t in it)it.hasOwnProperty(t)&&e.push(it[t]);return e}function Ei(e){at=e,ot.length&&at&&at(sr)}function Ci(){o.getInheritedInstanceCount=_i,o.getLiveInheritedInstances=wi,o.flushPendingDeletes=sr,o.setDelayFunction=Ei}var it={};function xi(e,t){for(t===void 0&&G("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function ki(e,t){return t=xi(e,t),it[t]}function Pt(e,t){(!t.ptrType||!t.ptr)&&xt("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,n=!!t.smartPtr;return r!==n&&xt("Both smartPtrType and smartPtr must be specified"),t.count={value:1},nt(Object.create(e,{$$:{value:t}}))}function Si(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=ki(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var n=r.clone();return this.destructor(e),n}function a(){return this.isSmartPointer?Pt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Pt(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var i=this.registeredClass.getActualType(t),u=kn[i];if(!u)return a.call(this);var c;this.isConst?c=u.constPointerType:c=u.pointerType;var l=Sn(t,this.registeredClass,c.registeredClass);return l===null?a.call(this):this.isSmartPointer?Pt(c.registeredClass.instancePrototype,{ptrType:c,ptr:l,smartPtrType:this,smartPtr:e}):Pt(c.registeredClass.instancePrototype,{ptrType:c,ptr:l})}function Pi(){ye.prototype.getPointee=gi,ye.prototype.destructor=bi,ye.prototype.argPackAdvance=8,ye.prototype.readValueFromPointer=St,ye.prototype.deleteObject=yi,ye.prototype.fromWireType=Si}function ye(e,t,r,n,a,i,u,c,l,h,v){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=n,this.isSmartPointer=a,this.pointeeType=i,this.sharingPolicy=u,this.rawGetPointee=c,this.rawConstructor=l,this.rawShare=h,this.rawDestructor=v,!a&&t.baseClass===void 0?n?(this.toWireType=pi,this.destructorFunction=null):(this.toWireType=vi,this.destructorFunction=null):this.toWireType=hi}function Pn(e,t,r){o.hasOwnProperty(e)||xt("Replacing nonexistant public symbol"),o[e].overloadTable!==void 0&&r!==void 0?o[e].overloadTable[r]=t:(o[e]=t,o[e].argCount=r)}function Ti(e,t,r){var n=o["dynCall_"+e];return r&&r.length?n.apply(null,[t].concat(r)):n.call(null,t)}function Di(e,t,r){return e.includes("j")?Ti(e,t,r):yt(t).apply(null,r)}function Fi(e,t){var r=[];return function(){r.length=arguments.length;for(var n=0;n<arguments.length;n++)r[n]=arguments[n];return Di(e,t,r)}}function se(e,t){e=Z(e);function r(){return e.includes("j")?Fi(e,t):yt(t)}var n=r();return typeof n!="function"&&G("unknown function pointer with signature "+e+": "+t),n}var Tn=void 0;function Dn(e){var t=Gn(e),r=Z(t);return we(t),r}function Ie(e,t){var r=[],n={};function a(i){if(!n[i]&&!Oe[i]){if(wt[i]){wt[i].forEach(a);return}r.push(i),n[i]=!0}}throw t.forEach(a),new Tn(e+": "+r.map(Dn).join([", "]))}function Ai(e,t,r,n,a,i,u,c,l,h,v,b,g){v=Z(v),i=se(a,i),c&&(c=se(u,c)),h&&(h=se(l,h)),g=se(b,g);var S=Et(v);cr(S,function(){Ie("Cannot construct "+v+" due to unbound types",[n])}),pe([e,t,r],n?[n]:[],function(D){D=D[0];var L,M;n?(L=D.registeredClass,M=L.instancePrototype):M=Fe.prototype;var U=Ct(S,function(){if(Object.getPrototypeOf(this)!==x)throw new Ve("Use 'new' to construct "+v);if(T.constructor_body===void 0)throw new Ve(v+" has no accessible constructor");var K=T.constructor_body[arguments.length];if(K===void 0)throw new Ve("Tried to invoke ctor of "+v+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(T.constructor_body).toString()+") parameters instead!");return K.apply(this,arguments)}),x=Object.create(M,{constructor:{value:U}});U.prototype=x;var T=new mi(v,U,x,g,L,i,c,h),B=new ye(v,T,!0,!1,!1),A=new ye(v+"*",T,!1,!1,!1),Q=new ye(v+" const*",T,!1,!0,!1);return kn[e]={pointerType:A,constPointerType:Q},Pn(S,U),[B,A,Q]})}function Fn(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=Ct(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var n=new r,a=e.apply(n,t);return a instanceof Object?a:n}function lr(e){for(;e.length;){var t=e.pop(),r=e.pop();r(t)}}function Tt(e,t,r,n,a){var i=t.length;i<2&&G("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var u=t[1]!==null&&r!==null,c=!1,l=1;l<t.length;++l)if(t[l]!==null&&t[l].destructorFunction===void 0){c=!0;break}for(var h=t[0].name!=="void",v="",b="",l=0;l<i-2;++l)v+=(l!==0?", ":"")+"arg"+l,b+=(l!==0?", ":"")+"arg"+l+"Wired";var g="return function "+Et(e)+"("+v+`) {
if (arguments.length !== `+(i-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(i-2)+` args!');
}
`;c&&(g+=`var destructors = [];
`);var S=c?"destructors":"null",D=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],L=[G,n,a,lr,t[0],t[1]];u&&(g+="var thisWired = classParam.toWireType("+S+`, this);
`);for(var l=0;l<i-2;++l)g+="var arg"+l+"Wired = argType"+l+".toWireType("+S+", arg"+l+"); // "+t[l+2].name+`
`,D.push("argType"+l),L.push(t[l+2]);if(u&&(b="thisWired"+(b.length>0?", ":"")+b),g+=(h?"var rv = ":"")+"invoker(fn"+(b.length>0?", ":"")+b+`);
`,c)g+=`runDestructors(destructors);
`;else for(var l=u?1:2;l<t.length;++l){var M=l===1?"thisWired":"arg"+(l-2)+"Wired";t[l].destructorFunction!==null&&(g+=M+"_dtor("+M+"); // "+t[l].name+`
`,D.push(M+"_dtor"),L.push(t[l].destructorFunction))}h&&(g+=`var ret = retType.fromWireType(rv);
return ret;
`),g+=`}
`,D.push(g);var U=Fn(Function,D).apply(null,L);return U}function Dt(e,t){for(var r=[],n=0;n<e;n++)r.push(y[(t>>2)+n]);return r}function ji(e,t,r,n,a,i,u){var c=Dt(r,n);t=Z(t),i=se(a,i),pe([],[e],function(l){l=l[0];var h=l.name+"."+t;function v(){Ie("Cannot call "+h+" due to unbound types",c)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]);var b=l.registeredClass.constructor;return b[t]===void 0?(v.argCount=r-1,b[t]=v):(ur(b,t,h),b[t].overloadTable[r-1]=v),pe([],c,function(g){var S=[g[0],null].concat(g.slice(1)),D=Tt(h,S,null,i,u);return b[t].overloadTable===void 0?(D.argCount=r-1,b[t]=D):b[t].overloadTable[r-1]=D,[]}),[]})}function Li(e,t,r,n,a,i){Je(t>0);var u=Dt(t,r);a=se(n,a),pe([],[e],function(c){c=c[0];var l="constructor "+c.name;if(c.registeredClass.constructor_body===void 0&&(c.registeredClass.constructor_body=[]),c.registeredClass.constructor_body[t-1]!==void 0)throw new Ve("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+c.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return c.registeredClass.constructor_body[t-1]=function(){Ie("Cannot construct "+c.name+" due to unbound types",u)},pe([],u,function(h){return h.splice(1,0,null),c.registeredClass.constructor_body[t-1]=Tt(l,h,null,a,i),[]}),[]})}function Mi(e,t,r,n,a,i,u,c){var l=Dt(r,n);t=Z(t),i=se(a,i),pe([],[e],function(h){h=h[0];var v=h.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),c&&h.registeredClass.pureVirtualFunctions.push(t);function b(){Ie("Cannot call "+v+" due to unbound types",l)}var g=h.registeredClass.instancePrototype,S=g[t];return S===void 0||S.overloadTable===void 0&&S.className!==h.name&&S.argCount===r-2?(b.argCount=r-2,b.className=h.name,g[t]=b):(ur(g,t,v),g[t].overloadTable[r-2]=b),pe([],l,function(D){var L=Tt(v,D,h,i,u);return g[t].overloadTable===void 0?(L.argCount=r-2,g[t]=L):g[t].overloadTable[r-2]=L,[]}),[]})}function An(e,t,r){return e instanceof Object||G(r+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||G(r+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||G("cannot call emscripten binding method "+r+" on deleted object"),kt(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}function Ri(e,t,r,n,a,i,u,c,l,h){t=Z(t),a=se(n,a),pe([],[e],function(v){v=v[0];var b=v.name+"."+t,g={get:function(){Ie("Cannot access "+b+" due to unbound types",[r,u])},enumerable:!0,configurable:!0};return l?g.set=function(){Ie("Cannot access "+b+" due to unbound types",[r,u])}:g.set=function(S){G(b+" is a read-only property")},Object.defineProperty(v.registeredClass.instancePrototype,t,g),pe([],l?[r,u]:[r],function(S){var D=S[0],L={get:function(){var U=An(this,v,b+" getter");return D.fromWireType(a(i,U))},enumerable:!0};if(l){l=se(c,l);var M=S[1];L.set=function(U){var x=An(this,v,b+" setter"),T=[];l(h,x,M.toWireType(T,U)),lr(T)}}return Object.defineProperty(v.registeredClass.instancePrototype,t,L),[]}),[]})}var fr=[],he=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function dr(e){e>4&&--he[e].refcount===0&&(he[e]=void 0,fr.push(e))}function Oi(){for(var e=0,t=5;t<he.length;++t)he[t]!==void 0&&++e;return e}function Ii(){for(var e=5;e<he.length;++e)if(he[e]!==void 0)return he[e];return null}function Bi(){o.count_emval_handles=Oi,o.get_first_emval=Ii}var X={toValue:function(e){return e||G("Cannot use deleted val. handle = "+e),he[e].value},toHandle:function(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var t=fr.length?fr.pop():he.length;return he[t]={refcount:1,value:e},t}}}};function Ni(e,t){t=Z(t),be(e,{name:t,fromWireType:function(r){var n=X.toValue(r);return dr(r),n},toWireType:function(r,n){return X.toHandle(n)},argPackAdvance:8,readValueFromPointer:St,destructorFunction:null})}function Ui(e,t,r){switch(t){case 0:return function(n){var a=r?H:W;return this.fromWireType(a[n])};case 1:return function(n){var a=r?ce:Ge;return this.fromWireType(a[n>>1])};case 2:return function(n){var a=r?y:re;return this.fromWireType(a[n>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function zi(e,t,r,n){var a=_t(r);t=Z(t);function i(){}i.values={},be(e,{name:t,constructor:i,fromWireType:function(u){return this.constructor.values[u]},toWireType:function(u,c){return c.value},argPackAdvance:8,readValueFromPointer:Ui(t,a,n),destructorFunction:null}),cr(t,i)}function Ft(e,t){var r=Oe[e];return r===void 0&&G(t+" has unknown type "+Dn(e)),r}function Gi(e,t,r){var n=Ft(e,"enum");t=Z(t);var a=n.constructor,i=Object.create(n.constructor.prototype,{value:{value:r},constructor:{value:Ct(n.name+"_"+t,function(){})}});a.values[r]=i,a[t]=i}function mr(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function $i(e,t){switch(t){case 2:return function(r){return this.fromWireType(J[r>>2])};case 3:return function(r){return this.fromWireType(on[r>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Vi(e,t,r){var n=_t(r);t=Z(t),be(e,{name:t,fromWireType:function(a){return a},toWireType:function(a,i){return i},argPackAdvance:8,readValueFromPointer:$i(t,n),destructorFunction:null})}function qi(e,t,r,n,a,i){var u=Dt(t,r);e=Z(e),a=se(n,a),cr(e,function(){Ie("Cannot call "+e+" due to unbound types",u)},t-1),pe([],u,function(c){var l=[c[0],null].concat(c.slice(1));return Pn(e,Tt(e,l,null,a,i),t-1),[]})}function Yi(e,t,r){switch(t){case 0:return r?function(n){return H[n]}:function(n){return W[n]};case 1:return r?function(n){return ce[n>>1]}:function(n){return Ge[n>>1]};case 2:return r?function(n){return y[n>>2]}:function(n){return re[n>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Wi(e,t,r,n,a){t=Z(t);var i=_t(r),u=function(b){return b};if(n===0){var c=32-8*r;u=function(b){return b<<c>>>c}}var l=t.includes("unsigned"),h=function(b,g){},v;l?v=function(b,g){return h(g,this.name),g>>>0}:v=function(b,g){return h(g,this.name),g},be(e,{name:t,fromWireType:u,toWireType:v,argPackAdvance:8,readValueFromPointer:Yi(t,i,n!==0),destructorFunction:null})}function Qi(e,t,r){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],a=n[t];function i(u){u=u>>2;var c=re,l=c[u],h=c[u+1];return new a(vt,h,l)}r=Z(r),be(e,{name:r,fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{ignoreDuplicateRegistrations:!0})}function Hi(e,t,r,n,a,i,u,c,l,h,v,b){r=Z(r),i=se(a,i),c=se(u,c),h=se(l,h),b=se(v,b),pe([e],[t],function(g){g=g[0];var S=new ye(r,g.registeredClass,!1,!1,!0,g,n,i,c,h,b);return[S]})}function Xi(e,t){t=Z(t);var r=t==="std::string";be(e,{name:t,fromWireType:function(n){var a=re[n>>2],i;if(r)for(var u=n+4,c=0;c<=a;++c){var l=n+4+c;if(c==a||W[l]==0){var h=l-u,v=Ce(u,h);i===void 0?i=v:(i+=String.fromCharCode(0),i+=v),u=l+1}}else{for(var b=new Array(a),c=0;c<a;++c)b[c]=String.fromCharCode(W[n+4+c]);i=b.join("")}return we(n),i},toWireType:function(n,a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));var i,u=typeof a=="string";u||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Int8Array||G("Cannot pass non-string to std::string"),r&&u?i=function(){return De(a)}:i=function(){return a.length};var c=i(),l=je(4+c+1);if(re[l>>2]=c,r&&u)Te(a,l+4,c+1);else if(u)for(var h=0;h<c;++h){var v=a.charCodeAt(h);v>255&&(we(l),G("String has UTF-16 code units that do not fit in 8 bits")),W[l+4+h]=v}else for(var h=0;h<c;++h)W[l+4+h]=a[h];return n!==null&&n.push(we,l),l},argPackAdvance:8,readValueFromPointer:St,destructorFunction:function(n){we(n)}})}function Ki(e,t,r){r=Z(r);var n,a,i,u,c;t===2?(n=eo,a=to,u=ro,i=function(){return Ge},c=1):t===4&&(n=no,a=ao,u=oo,i=function(){return re},c=2),be(e,{name:r,fromWireType:function(l){for(var h=re[l>>2],v=i(),b,g=l+4,S=0;S<=h;++S){var D=l+4+S*t;if(S==h||v[D>>c]==0){var L=D-g,M=n(g,L);b===void 0?b=M:(b+=String.fromCharCode(0),b+=M),g=D+t}}return we(l),b},toWireType:function(l,h){typeof h!="string"&&G("Cannot pass non-string to C++ string type "+r);var v=u(h),b=je(4+v+t);return re[b>>2]=v>>c,a(h,b+4,v+t),l!==null&&l.push(we,b),b},argPackAdvance:8,readValueFromPointer:St,destructorFunction:function(l){we(l)}})}function Ji(e,t){t=Z(t),be(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(r,n){}})}function Zi(e,t,r){e=X.toValue(e),t=Ft(t,"emval::as");var n=[],a=X.toHandle(n);return y[r>>2]=a,t.toWireType(n,e)}function jn(e,t){for(var r=new Array(e),n=0;n<e;++n)r[n]=Ft(y[(t>>2)+n],"parameter "+n);return r}function es(e,t,r,n){e=X.toValue(e);for(var a=jn(t,r),i=new Array(t),u=0;u<t;++u){var c=a[u];i[u]=c.readValueFromPointer(n),n+=c.argPackAdvance}var l=e.apply(void 0,i);return X.toHandle(l)}var ts={};function pr(e){var t=ts[e];return t===void 0?Z(e):t}var hr=[];function rs(e,t,r,n){e=hr[e],t=X.toValue(t),r=pr(r),e(t,r,null,n)}function ns(e){var t=hr.length;return hr.push(e),t}var Ln=[];function as(e,t){var r=jn(e,t),n=r[0],a=n.name+"_$"+r.slice(1).map(function(D){return D.name}).join("_")+"$",i=Ln[a];if(i!==void 0)return i;for(var u=["retType"],c=[n],l="",h=0;h<e-1;++h)l+=(h!==0?", ":"")+"arg"+h,u.push("argType"+h),c.push(r[1+h]);for(var v=Et("methodCaller_"+a),b="return function "+v+`(handle, name, destructors, args) {
`,g=0,h=0;h<e-1;++h)b+="    var arg"+h+" = argType"+h+".readValueFromPointer(args"+(g?"+"+g:"")+`);
`,g+=r[h+1].argPackAdvance;b+="    var rv = handle[name]("+l+`);
`;for(var h=0;h<e-1;++h)r[h+1].deleteObject&&(b+="    argType"+h+".deleteObject(arg"+h+`);
`);n.isVoid||(b+=`    return retType.toWireType(destructors, rv);
`),b+=`};
`,u.push(b);var S=Fn(Function,u).apply(null,c);return i=ns(S),Ln[a]=i,i}function os(e){return e=pr(e),X.toHandle(o[e])}function is(e,t){return e=X.toValue(e),t=X.toValue(t),X.toHandle(e[t])}function ss(e){e>4&&(he[e].refcount+=1)}function us(e){return e=X.toValue(e),typeof e=="number"}function cs(e){return X.toHandle(pr(e))}function ls(e){var t=X.toValue(e);lr(t),dr(e)}function fs(e,t,r){e=X.toValue(e),t=X.toValue(t),r=X.toValue(r),e[t]=r}function ds(e,t){e=Ft(e,"_emval_take_value");var r=e.readValueFromPointer(t);return X.toHandle(r)}function ms(){ge("")}function vr(e,t){if(_.mainLoop.timingMode=e,_.mainLoop.timingValue=t,!_.mainLoop.func)return 1;if(_.mainLoop.running||(_.mainLoop.running=!0),e==0)_.mainLoop.scheduler=function(){var i=Math.max(0,_.mainLoop.tickStartTime+t-tt())|0;setTimeout(_.mainLoop.runner,i)},_.mainLoop.method="timeout";else if(e==1)_.mainLoop.scheduler=function(){_.requestAnimationFrame(_.mainLoop.runner)},_.mainLoop.method="rAF";else if(e==2){if(typeof setImmediate>"u"){var r=[],n="setimmediate",a=function(i){(i.data===n||i.data.target===n)&&(i.stopPropagation(),r.shift()())};addEventListener("message",a,!0),setImmediate=function(i){r.push(i),postMessage(n,"*")}}_.mainLoop.scheduler=function(){setImmediate(_.mainLoop.runner)},_.mainLoop.method="immediate"}return 0}function Mn(e){qc(e)}function ps(){if(!rr())try{Mn(Pe)}catch(e){hn(e)}}function hs(e,t,r,n,a){Je(!_.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),_.mainLoop.func=e,_.mainLoop.arg=n;var i=_.mainLoop.currentlyRunningMainloop;function u(){return i<_.mainLoop.currentlyRunningMainloop?(ps(),!1):!0}if(_.mainLoop.running=!1,_.mainLoop.runner=function(){if(!Ee){if(_.mainLoop.queue.length>0){var c=Date.now(),l=_.mainLoop.queue.shift();if(l.func(l.arg),_.mainLoop.remainingBlockers){var h=_.mainLoop.remainingBlockers,v=h%1==0?h-1:Math.floor(h);l.counted?_.mainLoop.remainingBlockers=v:(v=v+.5,_.mainLoop.remainingBlockers=(8*h+v)/9)}if(ie('main loop blocker "'+l.name+'" took '+(Date.now()-c)+" ms"),_.mainLoop.updateStatus(),!u())return;setTimeout(_.mainLoop.runner,0);return}if(u()){if(_.mainLoop.currentFrameNumber=_.mainLoop.currentFrameNumber+1|0,_.mainLoop.timingMode==1&&_.mainLoop.timingValue>1&&_.mainLoop.currentFrameNumber%_.mainLoop.timingValue!=0){_.mainLoop.scheduler();return}else _.mainLoop.timingMode==0&&(_.mainLoop.tickStartTime=tt());_.mainLoop.runIter(e),u()&&(typeof SDL=="object"&&SDL.audio&&SDL.audio.queueNewAudioData&&SDL.audio.queueNewAudioData(),_.mainLoop.scheduler())}}},a||(t&&t>0?vr(0,1e3/t):vr(1,1),_.mainLoop.scheduler()),r)throw"unwind"}function gr(e,t){if(!(dn||Ee)){if(t){e();return}try{e()}catch(r){hn(r)}}}function Rn(e,t){return setTimeout(function(){gr(e)},t)}var _={mainLoop:{running:!1,scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause:function(){_.mainLoop.scheduler=null,_.mainLoop.currentlyRunningMainloop++},resume:function(){_.mainLoop.currentlyRunningMainloop++;var e=_.mainLoop.timingMode,t=_.mainLoop.timingValue,r=_.mainLoop.func;_.mainLoop.func=null,hs(r,0,!1,_.mainLoop.arg,!0),vr(e,t),_.mainLoop.scheduler()},updateStatus:function(){if(o.setStatus){var e=o.statusMessage||"Please wait...",t=_.mainLoop.remainingBlockers,r=_.mainLoop.expectedBlockers;t?t<r?o.setStatus(e+" ("+(r-t)+"/"+r+")"):o.setStatus(e):o.setStatus("")}},runIter:function(e){if(!Ee){if(o.preMainLoop){var t=o.preMainLoop();if(t===!1)return}gr(e),o.postMainLoop&&o.postMainLoop()}}},isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],init:function(){if(o.preloadPlugins||(o.preloadPlugins=[]),_.initted)return;_.initted=!0;try{new Blob,_.hasBlobConstructor=!0}catch{_.hasBlobConstructor=!1,ie("warning: no blob constructor, cannot create blobs with mimetypes")}_.BlobBuilder=typeof MozBlobBuilder<"u"?MozBlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:_.hasBlobConstructor?null:ie("warning: no BlobBuilder"),_.URLObject=typeof window<"u"?window.URL?window.URL:window.webkitURL:void 0,!o.noImageDecoding&&typeof _.URLObject>"u"&&(ie("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),o.noImageDecoding=!0);var e={};e.canHandle=function(a){return!o.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(a)},e.handle=function(a,i,u,c){var l=null;if(_.hasBlobConstructor)try{l=new Blob([a],{type:_.getMimetype(i)}),l.size!==a.length&&(l=new Blob([new Uint8Array(a).buffer],{type:_.getMimetype(i)}))}catch(g){Se("Blob constructor present but fails: "+g+"; falling back to blob builder")}if(!l){var h=new _.BlobBuilder;h.append(new Uint8Array(a).buffer),l=h.getBlob()}var v=_.URLObject.createObjectURL(l),b=new Image;b.onload=()=>{Je(b.complete,"Image "+i+" could not be decoded");var g=document.createElement("canvas");g.width=b.width,g.height=b.height;var S=g.getContext("2d");S.drawImage(b,0,0),o.preloadedImages[i]=g,_.URLObject.revokeObjectURL(v),u&&u(a)},b.onerror=g=>{ie("Image "+v+" could not be decoded"),c&&c()},b.src=v},o.preloadPlugins.push(e);var t={};t.canHandle=function(a){return!o.noAudioDecoding&&a.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},t.handle=function(a,i,u,c){var l=!1;function h(D){l||(l=!0,o.preloadedAudios[i]=D,u&&u(a))}function v(){l||(l=!0,o.preloadedAudios[i]=new Audio,c&&c())}if(_.hasBlobConstructor){try{var b=new Blob([a],{type:_.getMimetype(i)})}catch{return v()}var g=_.URLObject.createObjectURL(b),S=new Audio;S.addEventListener("canplaythrough",function(){h(S)},!1),S.onerror=function(D){if(l)return;ie("warning: browser could not fully decode audio "+i+", trying slower base64 approach");function L(M){for(var U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x="=",T="",B=0,A=0,Q=0;Q<M.length;Q++)for(B=B<<8|M[Q],A+=8;A>=6;){var K=B>>A-6&63;A-=6,T+=U[K]}return A==2?(T+=U[(B&3)<<4],T+=x+x):A==4&&(T+=U[(B&15)<<2],T+=x),T}S.src="data:audio/x-"+i.substr(-3)+";base64,"+L(a),h(S)},S.src=g,Rn(function(){h(S)},1e4)}else return v()},o.preloadPlugins.push(t);function r(){_.pointerLock=document.pointerLockElement===o.canvas||document.mozPointerLockElement===o.canvas||document.webkitPointerLockElement===o.canvas||document.msPointerLockElement===o.canvas}var n=o.canvas;n&&(n.requestPointerLock=n.requestPointerLock||n.mozRequestPointerLock||n.webkitRequestPointerLock||n.msRequestPointerLock||function(){},n.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},n.exitPointerLock=n.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",r,!1),document.addEventListener("mozpointerlockchange",r,!1),document.addEventListener("webkitpointerlockchange",r,!1),document.addEventListener("mspointerlockchange",r,!1),o.elementPointerLock&&n.addEventListener("click",function(a){!_.pointerLock&&o.canvas.requestPointerLock&&(o.canvas.requestPointerLock(),a.preventDefault())},!1))},createContext:function(e,t,r,n){if(t&&o.ctx&&e==o.canvas)return o.ctx;var a,i;if(t){var u={antialias:!1,alpha:!1,majorVersion:typeof WebGL2RenderingContext<"u"?2:1};if(n)for(var c in n)u[c]=n[c];typeof k<"u"&&(i=k.createContext(e,u),i&&(a=k.getContext(i).GLctx))}else a=e.getContext("2d");return a?(r&&(t||Je(typeof E>"u","cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),o.ctx=a,t&&k.makeContextCurrent(i),o.useWebGL=t,_.moduleContextCreatedCallbacks.forEach(function(l){l()}),_.init()),a):null},destroyContext:function(e,t,r){},fullscreenHandlersInstalled:!1,lockPointer:void 0,resizeCanvas:void 0,requestFullscreen:function(e,t){_.lockPointer=e,_.resizeCanvas=t,typeof _.lockPointer>"u"&&(_.lockPointer=!0),typeof _.resizeCanvas>"u"&&(_.resizeCanvas=!1);var r=o.canvas;function n(){_.isFullscreen=!1;var i=r.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===i?(r.exitFullscreen=_.exitFullscreen,_.lockPointer&&r.requestPointerLock(),_.isFullscreen=!0,_.resizeCanvas?_.setFullscreenCanvasSize():_.updateCanvasDimensions(r)):(i.parentNode.insertBefore(r,i),i.parentNode.removeChild(i),_.resizeCanvas?_.setWindowedCanvasSize():_.updateCanvasDimensions(r)),o.onFullScreen&&o.onFullScreen(_.isFullscreen),o.onFullscreen&&o.onFullscreen(_.isFullscreen)}_.fullscreenHandlersInstalled||(_.fullscreenHandlersInstalled=!0,document.addEventListener("fullscreenchange",n,!1),document.addEventListener("mozfullscreenchange",n,!1),document.addEventListener("webkitfullscreenchange",n,!1),document.addEventListener("MSFullscreenChange",n,!1));var a=document.createElement("div");r.parentNode.insertBefore(a,r),a.appendChild(r),a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||(a.webkitRequestFullscreen?function(){a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:null)||(a.webkitRequestFullScreen?function(){a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),a.requestFullscreen()},exitFullscreen:function(){if(!_.isFullscreen)return!1;var e=document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){};return e.apply(document,[]),!0},nextRAF:0,fakeRequestAnimationFrame:function(e){var t=Date.now();if(_.nextRAF===0)_.nextRAF=t+1e3/60;else for(;t+2>=_.nextRAF;)_.nextRAF+=1e3/60;var r=Math.max(_.nextRAF-t,0);setTimeout(e,r)},requestAnimationFrame:function(e){if(typeof requestAnimationFrame=="function"){requestAnimationFrame(e);return}var t=_.fakeRequestAnimationFrame;t(e)},safeSetTimeout:function(e){return Rn(e)},safeRequestAnimationFrame:function(e){return _.requestAnimationFrame(function(){gr(e)})},getMimetype:function(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]},getUserMedia:function(e){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(e)},getMovementX:function(e){return e.movementX||e.mozMovementX||e.webkitMovementX||0},getMovementY:function(e){return e.movementY||e.mozMovementY||e.webkitMovementY||0},getMouseWheelDelta:function(e){var t=0;switch(e.type){case"DOMMouseScroll":t=e.detail/3;break;case"mousewheel":t=e.wheelDelta/120;break;case"wheel":switch(t=e.deltaY,e.deltaMode){case 0:t/=100;break;case 1:t/=3;break;case 2:t*=80;break;default:throw"unrecognized mouse wheel delta mode: "+e.deltaMode}break;default:throw"unrecognized mouse wheel event: "+e.type}return t},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent:function(e){if(_.pointerLock)e.type!="mousemove"&&"mozMovementX"in e?_.mouseMovementX=_.mouseMovementY=0:(_.mouseMovementX=_.getMovementX(e),_.mouseMovementY=_.getMovementY(e)),typeof SDL<"u"?(_.mouseX=SDL.mouseX+_.mouseMovementX,_.mouseY=SDL.mouseY+_.mouseMovementY):(_.mouseX+=_.mouseMovementX,_.mouseY+=_.mouseMovementY);else{var t=o.canvas.getBoundingClientRect(),r=o.canvas.width,n=o.canvas.height,a=typeof window.scrollX<"u"?window.scrollX:window.pageXOffset,i=typeof window.scrollY<"u"?window.scrollY:window.pageYOffset;if(e.type==="touchstart"||e.type==="touchend"||e.type==="touchmove"){var u=e.touch;if(u===void 0)return;var c=u.pageX-(a+t.left),l=u.pageY-(i+t.top);c=c*(r/t.width),l=l*(n/t.height);var h={x:c,y:l};if(e.type==="touchstart")_.lastTouches[u.identifier]=h,_.touches[u.identifier]=h;else if(e.type==="touchend"||e.type==="touchmove"){var v=_.touches[u.identifier];v||(v=h),_.lastTouches[u.identifier]=v,_.touches[u.identifier]=h}return}var b=e.pageX-(a+t.left),g=e.pageY-(i+t.top);b=b*(r/t.width),g=g*(n/t.height),_.mouseMovementX=b-_.mouseX,_.mouseMovementY=g-_.mouseY,_.mouseX=b,_.mouseY=g}},resizeListeners:[],updateResizeListeners:function(){var e=o.canvas;_.resizeListeners.forEach(function(t){t(e.width,e.height)})},setCanvasSize:function(e,t,r){var n=o.canvas;_.updateCanvasDimensions(n,e,t),r||_.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize:function(){if(typeof SDL<"u"){var e=re[SDL.screen>>2];e=e|8388608,y[SDL.screen>>2]=e}_.updateCanvasDimensions(o.canvas),_.updateResizeListeners()},setWindowedCanvasSize:function(){if(typeof SDL<"u"){var e=re[SDL.screen>>2];e=e&-8388609,y[SDL.screen>>2]=e}_.updateCanvasDimensions(o.canvas),_.updateResizeListeners()},updateCanvasDimensions:function(e,t,r){t&&r?(e.widthNative=t,e.heightNative=r):(t=e.widthNative,r=e.heightNative);var n=t,a=r;if(o.forcedAspectRatio&&o.forcedAspectRatio>0&&(n/a<o.forcedAspectRatio?n=Math.round(a*o.forcedAspectRatio):a=Math.round(n/o.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e.parentNode&&typeof screen<"u"){var i=Math.min(screen.width/n,screen.height/a);n=Math.round(n*i),a=Math.round(a*i)}_.resizeCanvas?(e.width!=n&&(e.width=n),e.height!=a&&(e.height=a),typeof e.style<"u"&&(e.style.removeProperty("width"),e.style.removeProperty("height"))):(e.width!=t&&(e.width=t),e.height!=r&&(e.height=r),typeof e.style<"u"&&(n!=t||a!=r?(e.style.setProperty("width",n+"px","important"),e.style.setProperty("height",a+"px","important")):(e.style.removeProperty("width"),e.style.removeProperty("height"))))}},p={QUEUE_INTERVAL:25,QUEUE_LOOKAHEAD:.1,DEVICE_NAME:"Emscripten OpenAL",CAPTURE_DEVICE_NAME:"Emscripten OpenAL capture",ALC_EXTENSIONS:{ALC_SOFT_pause_device:!0,ALC_SOFT_HRTF:!0},AL_EXTENSIONS:{AL_EXT_float32:!0,AL_SOFT_loop_points:!0,AL_SOFT_source_length:!0,AL_EXT_source_distance_model:!0,AL_SOFT_source_spatialize:!0},_alcErr:0,alcErr:0,deviceRefCounts:{},alcStringCache:{},paused:!1,stringCache:{},contexts:{},currentCtx:null,buffers:{0:{id:0,refCount:0,audioBuf:null,frequency:0,bytesPerSample:2,channels:1,length:0}},paramArray:[],_nextId:1,newId:function(){return p.freeIds.length>0?p.freeIds.pop():p._nextId++},freeIds:[],scheduleContextAudio:function(e){if(!(_.mainLoop.timingMode===1&&document.visibilityState!="visible"))for(var t in e.sources)p.scheduleSourceAudio(e.sources[t])},scheduleSourceAudio:function(e,t){if(!(_.mainLoop.timingMode===1&&document.visibilityState!="visible")&&e.state===4114){for(var r=p.updateSourceTime(e),n=e.bufStartTime,a=e.bufOffset,i=e.bufsProcessed,u=0;u<e.audioQueue.length;u++){var c=e.audioQueue[u];n=c._startTime+c._duration,a=0,i+=c._skipCount+1}t||(t=p.QUEUE_LOOKAHEAD);for(var l=r+t,h=0;n<l;){if(i>=e.bufQueue.length)if(e.looping)i%=e.bufQueue.length;else break;var v=e.bufQueue[i%e.bufQueue.length];if(v.length===0){if(h++,h===e.bufQueue.length)break}else{var c=e.context.audioCtx.createBufferSource();c.buffer=v.audioBuf,c.playbackRate.value=e.playbackRate,(v.audioBuf._loopStart||v.audioBuf._loopEnd)&&(c.loopStart=v.audioBuf._loopStart,c.loopEnd=v.audioBuf._loopEnd);var b=0;e.type===4136&&e.looping?(b=Number.POSITIVE_INFINITY,c.loop=!0,v.audioBuf._loopStart&&(c.loopStart=v.audioBuf._loopStart),v.audioBuf._loopEnd&&(c.loopEnd=v.audioBuf._loopEnd)):b=(v.audioBuf.duration-a)/e.playbackRate,c._startOffset=a,c._duration=b,c._skipCount=h,h=0,c.connect(e.gain),typeof c.start<"u"?(n=Math.max(n,e.context.audioCtx.currentTime),c.start(n,a)):typeof c.noteOn<"u"&&(n=Math.max(n,e.context.audioCtx.currentTime),c.noteOn(n)),c._startTime=n,e.audioQueue.push(c),n+=b}a=0,i++}}},updateSourceTime:function(e){var t=e.context.audioCtx.currentTime;if(e.state!==4114)return t;isFinite(e.bufStartTime)||(e.bufStartTime=t-e.bufOffset/e.playbackRate,e.bufOffset=0);for(var r=0;e.audioQueue.length;){var n=e.audioQueue[0];if(e.bufsProcessed+=n._skipCount,r=n._startTime+n._duration,t<r)break;e.audioQueue.shift(),e.bufStartTime=r,e.bufOffset=0,e.bufsProcessed++}if(e.bufsProcessed>=e.bufQueue.length&&!e.looping)p.setSourceState(e,4116);else if(e.type===4136&&e.looping){var a=e.bufQueue[0];if(a.length===0)e.bufOffset=0;else{var i=(t-e.bufStartTime)*e.playbackRate,u=a.audioBuf._loopStart||0,c=a.audioBuf._loopEnd||a.audioBuf.duration;c<=u&&(c=a.audioBuf.duration),i<c?e.bufOffset=i:e.bufOffset=u+(i-u)%(c-u)}}else if(e.audioQueue[0])e.bufOffset=(t-e.audioQueue[0]._startTime)*e.playbackRate;else{if(e.type!==4136&&e.looping){var l=p.sourceDuration(e)/e.playbackRate;l>0&&(e.bufStartTime+=Math.floor((t-e.bufStartTime)/l)*l)}for(var h=0;h<e.bufQueue.length;h++){if(e.bufsProcessed>=e.bufQueue.length)if(e.looping)e.bufsProcessed%=e.bufQueue.length;else{p.setSourceState(e,4116);break}var a=e.bufQueue[e.bufsProcessed];if(a.length>0){if(r=e.bufStartTime+a.audioBuf.duration/e.playbackRate,t<r){e.bufOffset=(t-e.bufStartTime)*e.playbackRate;break}e.bufStartTime=r}e.bufOffset=0,e.bufsProcessed++}}return t},cancelPendingSourceAudio:function(e){p.updateSourceTime(e);for(var t=1;t<e.audioQueue.length;t++){var r=e.audioQueue[t];r.stop()}e.audioQueue.length>1&&(e.audioQueue.length=1)},stopSourceAudio:function(e){for(var t=0;t<e.audioQueue.length;t++)e.audioQueue[t].stop();e.audioQueue.length=0},setSourceState:function(e,t){t===4114?((e.state===4114||e.state==4116)&&(e.bufsProcessed=0,e.bufOffset=0),p.stopSourceAudio(e),e.state=4114,e.bufStartTime=Number.NEGATIVE_INFINITY,p.scheduleSourceAudio(e)):t===4115?e.state===4114&&(p.updateSourceTime(e),p.stopSourceAudio(e),e.state=4115):t===4116?e.state!==4113&&(e.state=4116,e.bufsProcessed=e.bufQueue.length,e.bufStartTime=Number.NEGATIVE_INFINITY,e.bufOffset=0,p.stopSourceAudio(e)):t===4113&&e.state!==4113&&(e.state=4113,e.bufsProcessed=0,e.bufStartTime=Number.NEGATIVE_INFINITY,e.bufOffset=0,p.stopSourceAudio(e))},initSourcePanner:function(e){if(e.type!==4144){for(var t=p.buffers[0],r=0;r<e.bufQueue.length;r++)if(e.bufQueue[r].id!==0){t=e.bufQueue[r];break}if(e.spatialize===1||e.spatialize===2&&t.channels===1){if(e.panner)return;e.panner=e.context.audioCtx.createPanner(),p.updateSourceGlobal(e),p.updateSourceSpace(e),e.panner.connect(e.context.gain),e.gain.disconnect(),e.gain.connect(e.panner)}else{if(!e.panner)return;e.panner.disconnect(),e.gain.disconnect(),e.gain.connect(e.context.gain),e.panner=null}}},updateContextGlobal:function(e){for(var t in e.sources)p.updateSourceGlobal(e.sources[t])},updateSourceGlobal:function(e){var t=e.panner;if(t){t.refDistance=e.refDistance,t.maxDistance=e.maxDistance,t.rolloffFactor=e.rolloffFactor,t.panningModel=e.context.hrtf?"HRTF":"equalpower";var r=e.context.sourceDistanceModel?e.distanceModel:e.context.distanceModel;switch(r){case 0:t.distanceModel="inverse",t.refDistance=340282e33;break;case 53249:case 53250:t.distanceModel="inverse";break;case 53251:case 53252:t.distanceModel="linear";break;case 53253:case 53254:t.distanceModel="exponential";break}}},updateListenerSpace:function(e){var t=e.audioCtx.listener;t.positionX?(t.positionX.value=e.listener.position[0],t.positionY.value=e.listener.position[1],t.positionZ.value=e.listener.position[2]):t.setPosition(e.listener.position[0],e.listener.position[1],e.listener.position[2]),t.forwardX?(t.forwardX.value=e.listener.direction[0],t.forwardY.value=e.listener.direction[1],t.forwardZ.value=e.listener.direction[2],t.upX.value=e.listener.up[0],t.upY.value=e.listener.up[1],t.upZ.value=e.listener.up[2]):t.setOrientation(e.listener.direction[0],e.listener.direction[1],e.listener.direction[2],e.listener.up[0],e.listener.up[1],e.listener.up[2]);for(var r in e.sources)p.updateSourceSpace(e.sources[r])},updateSourceSpace:function(e){if(e.panner){var t=e.panner,r=e.position[0],n=e.position[1],a=e.position[2],i=e.direction[0],u=e.direction[1],c=e.direction[2],l=e.context.listener,h=l.position[0],v=l.position[1],b=l.position[2];if(e.relative){var g=-l.direction[0],S=-l.direction[1],D=-l.direction[2],L=l.up[0],M=l.up[1],U=l.up[2],x=function(ta,ra,na){var aa=Math.sqrt(ta*ta+ra*ra+na*na);return aa<Number.EPSILON?0:1/aa},T=x(g,S,D);g*=T,S*=T,D*=T,T=x(L,M,U),L*=T,M*=T,U*=T;var B=M*D-U*S,A=U*g-L*D,Q=L*S-M*g;T=x(B,A,Q),B*=T,A*=T,Q*=T,L=S*Q-D*A,M=D*B-g*Q,U=g*A-S*B;var K=i,oe=u,Be=c;i=K*B+oe*L+Be*g,u=K*A+oe*M+Be*S,c=K*Q+oe*U+Be*D,K=r,oe=n,Be=a,r=K*B+oe*L+Be*g,n=K*A+oe*M+Be*S,a=K*Q+oe*U+Be*D,r+=h,n+=v,a+=b}t.positionX?(t.positionX.value=r,t.positionY.value=n,t.positionZ.value=a):t.setPosition(r,n,a),t.orientationX?(t.orientationX.value=i,t.orientationY.value=u,t.orientationZ.value=c):t.setOrientation(i,u,c);var Wc=e.dopplerShift,Qn=e.velocity[0],Hn=e.velocity[1],Xn=e.velocity[2],Kn=l.velocity[0],Jn=l.velocity[1],Zn=l.velocity[2];if(r===h&&n===v&&a===b||Qn===Kn&&Hn===Jn&&Xn===Zn)e.dopplerShift=1;else{var Gt=e.context.speedOfSound,$t=e.context.dopplerFactor,Vt=h-r,qt=v-n,Yt=b-a,ea=Math.sqrt(Vt*Vt+qt*qt+Yt*Yt),Cr=(Vt*Kn+qt*Jn+Yt*Zn)/ea,xr=(Vt*Qn+qt*Hn+Yt*Xn)/ea;Cr=Math.min(Cr,Gt/$t),xr=Math.min(xr,Gt/$t),e.dopplerShift=(Gt-$t*Cr)/(Gt-$t*xr)}e.dopplerShift!==Wc&&p.updateSourceRate(e)}},updateSourceRate:function(e){if(e.state===4114){p.cancelPendingSourceAudio(e);var t=e.audioQueue[0];if(!t)return;var r;e.type===4136&&e.looping?r=Number.POSITIVE_INFINITY:r=(t.buffer.duration-t._startOffset)/e.playbackRate,t._duration=r,t.playbackRate.value=e.playbackRate,p.scheduleSourceAudio(e)}},sourceDuration:function(e){for(var t=0,r=0;r<e.bufQueue.length;r++){var n=e.bufQueue[r].audioBuf;t+=n?n.duration:0}return t},sourceTell:function(e){p.updateSourceTime(e);for(var t=0,r=0;r<e.bufsProcessed;r++)e.bufQueue[r].audioBuf&&(t+=e.bufQueue[r].audioBuf.duration);return t+=e.bufOffset,t},sourceSeek:function(e,t){var r=e.state==4114;if(r&&p.setSourceState(e,4113),e.bufQueue[e.bufsProcessed].audioBuf!==null){for(e.bufsProcessed=0;t>e.bufQueue[e.bufsProcessed].audioBuf.duration;)t-=e.bufQueue[e.bufsProcessed].audiobuf.duration,e.bufsProcessed++;e.bufOffset=t}r&&p.setSourceState(e,4114)},getGlobalParam:function(e,t){if(!p.currentCtx)return null;switch(t){case 49152:return p.currentCtx.dopplerFactor;case 49155:return p.currentCtx.speedOfSound;case 53248:return p.currentCtx.distanceModel;default:return p.currentCtx.err=40962,null}},setGlobalParam:function(e,t,r){if(p.currentCtx)switch(t){case 49152:if(!Number.isFinite(r)||r<0){p.currentCtx.err=40963;return}p.currentCtx.dopplerFactor=r,p.updateListenerSpace(p.currentCtx);break;case 49155:if(!Number.isFinite(r)||r<=0){p.currentCtx.err=40963;return}p.currentCtx.speedOfSound=r,p.updateListenerSpace(p.currentCtx);break;case 53248:switch(r){case 0:case 53249:case 53250:case 53251:case 53252:case 53253:case 53254:p.currentCtx.distanceModel=r,p.updateContextGlobal(p.currentCtx);break;default:p.currentCtx.err=40963;return}break;default:p.currentCtx.err=40962;return}},getListenerParam:function(e,t){if(!p.currentCtx)return null;switch(t){case 4100:return p.currentCtx.listener.position;case 4102:return p.currentCtx.listener.velocity;case 4111:return p.currentCtx.listener.direction.concat(p.currentCtx.listener.up);case 4106:return p.currentCtx.gain.gain.value;default:return p.currentCtx.err=40962,null}},setListenerParam:function(e,t,r){if(p.currentCtx){if(r===null){p.currentCtx.err=40962;return}var n=p.currentCtx.listener;switch(t){case 4100:if(!Number.isFinite(r[0])||!Number.isFinite(r[1])||!Number.isFinite(r[2])){p.currentCtx.err=40963;return}n.position[0]=r[0],n.position[1]=r[1],n.position[2]=r[2],p.updateListenerSpace(p.currentCtx);break;case 4102:if(!Number.isFinite(r[0])||!Number.isFinite(r[1])||!Number.isFinite(r[2])){p.currentCtx.err=40963;return}n.velocity[0]=r[0],n.velocity[1]=r[1],n.velocity[2]=r[2],p.updateListenerSpace(p.currentCtx);break;case 4106:if(!Number.isFinite(r)||r<0){p.currentCtx.err=40963;return}p.currentCtx.gain.gain.value=r;break;case 4111:if(!Number.isFinite(r[0])||!Number.isFinite(r[1])||!Number.isFinite(r[2])||!Number.isFinite(r[3])||!Number.isFinite(r[4])||!Number.isFinite(r[5])){p.currentCtx.err=40963;return}n.direction[0]=r[0],n.direction[1]=r[1],n.direction[2]=r[2],n.up[0]=r[3],n.up[1]=r[4],n.up[2]=r[5],p.updateListenerSpace(p.currentCtx);break;default:p.currentCtx.err=40962;return}}},getBufferParam:function(e,t,r){if(p.currentCtx){var n=p.buffers[t];if(!n||t===0){p.currentCtx.err=40961;return}switch(r){case 8193:return n.frequency;case 8194:return n.bytesPerSample*8;case 8195:return n.channels;case 8196:return n.length*n.bytesPerSample*n.channels;case 8213:return n.length===0?[0,0]:[(n.audioBuf._loopStart||0)*n.frequency,(n.audioBuf._loopEnd||n.length)*n.frequency];default:return p.currentCtx.err=40962,null}}},setBufferParam:function(e,t,r,n){if(p.currentCtx){var a=p.buffers[t];if(!a||t===0){p.currentCtx.err=40961;return}if(n===null){p.currentCtx.err=40962;return}switch(r){case 8196:if(n!==0){p.currentCtx.err=40963;return}break;case 8213:if(n[0]<0||n[0]>a.length||n[1]<0||n[1]>a.Length||n[0]>=n[1]){p.currentCtx.err=40963;return}if(a.refCount>0){p.currentCtx.err=40964;return}a.audioBuf&&(a.audioBuf._loopStart=n[0]/a.frequency,a.audioBuf._loopEnd=n[1]/a.frequency);break;default:p.currentCtx.err=40962;return}}},getSourceParam:function(e,t,r){if(!p.currentCtx)return null;var n=p.currentCtx.sources[t];if(!n)return p.currentCtx.err=40961,null;switch(r){case 514:return n.relative;case 4097:return n.coneInnerAngle;case 4098:return n.coneOuterAngle;case 4099:return n.pitch;case 4100:return n.position;case 4101:return n.direction;case 4102:return n.velocity;case 4103:return n.looping;case 4105:return n.type===4136?n.bufQueue[0].id:0;case 4106:return n.gain.gain.value;case 4109:return n.minGain;case 4110:return n.maxGain;case 4112:return n.state;case 4117:return n.bufQueue.length===1&&n.bufQueue[0].id===0?0:n.bufQueue.length;case 4118:return n.bufQueue.length===1&&n.bufQueue[0].id===0||n.looping?0:n.bufsProcessed;case 4128:return n.refDistance;case 4129:return n.rolloffFactor;case 4130:return n.coneOuterGain;case 4131:return n.maxDistance;case 4132:return p.sourceTell(n);case 4133:var a=p.sourceTell(n);return a>0&&(a*=n.bufQueue[0].frequency),a;case 4134:var a=p.sourceTell(n);return a>0&&(a*=n.bufQueue[0].frequency*n.bufQueue[0].bytesPerSample),a;case 4135:return n.type;case 4628:return n.spatialize;case 8201:for(var i=0,u=0,c=0;c<n.bufQueue.length;c++)i+=n.bufQueue[c].length,n.bufQueue[c].id!==0&&(u=n.bufQueue[c].bytesPerSample*n.bufQueue[c].channels);return i*u;case 8202:for(var i=0,c=0;c<n.bufQueue.length;c++)i+=n.bufQueue[c].length;return i;case 8203:return p.sourceDuration(n);case 53248:return n.distanceModel;default:return p.currentCtx.err=40962,null}},setSourceParam:function(e,t,r,n){if(p.currentCtx){var a=p.currentCtx.sources[t];if(!a){p.currentCtx.err=40961;return}if(n===null){p.currentCtx.err=40962;return}switch(r){case 514:if(n===1)a.relative=!0,p.updateSourceSpace(a);else if(n===0)a.relative=!1,p.updateSourceSpace(a);else{p.currentCtx.err=40963;return}break;case 4097:if(!Number.isFinite(n)){p.currentCtx.err=40963;return}a.coneInnerAngle=n,a.panner&&(a.panner.coneInnerAngle=n%360);break;case 4098:if(!Number.isFinite(n)){p.currentCtx.err=40963;return}a.coneOuterAngle=n,a.panner&&(a.panner.coneOuterAngle=n%360);break;case 4099:if(!Number.isFinite(n)||n<=0){p.currentCtx.err=40963;return}if(a.pitch===n)break;a.pitch=n,p.updateSourceRate(a);break;case 4100:if(!Number.isFinite(n[0])||!Number.isFinite(n[1])||!Number.isFinite(n[2])){p.currentCtx.err=40963;return}a.position[0]=n[0],a.position[1]=n[1],a.position[2]=n[2],p.updateSourceSpace(a);break;case 4101:if(!Number.isFinite(n[0])||!Number.isFinite(n[1])||!Number.isFinite(n[2])){p.currentCtx.err=40963;return}a.direction[0]=n[0],a.direction[1]=n[1],a.direction[2]=n[2],p.updateSourceSpace(a);break;case 4102:if(!Number.isFinite(n[0])||!Number.isFinite(n[1])||!Number.isFinite(n[2])){p.currentCtx.err=40963;return}a.velocity[0]=n[0],a.velocity[1]=n[1],a.velocity[2]=n[2],p.updateSourceSpace(a);break;case 4103:if(n===1){if(a.looping=!0,p.updateSourceTime(a),a.type===4136&&a.audioQueue.length>0){var i=a.audioQueue[0];i.loop=!0,i._duration=Number.POSITIVE_INFINITY}}else if(n===0){a.looping=!1;var u=p.updateSourceTime(a);if(a.type===4136&&a.audioQueue.length>0){var i=a.audioQueue[0];i.loop=!1,i._duration=a.bufQueue[0].audioBuf.duration/a.playbackRate,i._startTime=u-a.bufOffset/a.playbackRate}}else{p.currentCtx.err=40963;return}break;case 4105:if(a.state===4114||a.state===4115){p.currentCtx.err=40964;return}if(n===0){for(var c in a.bufQueue)a.bufQueue[c].refCount--;a.bufQueue.length=1,a.bufQueue[0]=p.buffers[0],a.bufsProcessed=0,a.type=4144}else{var l=p.buffers[n];if(!l){p.currentCtx.err=40963;return}for(var c in a.bufQueue)a.bufQueue[c].refCount--;a.bufQueue.length=0,l.refCount++,a.bufQueue=[l],a.bufsProcessed=0,a.type=4136}p.initSourcePanner(a),p.scheduleSourceAudio(a);break;case 4106:if(!Number.isFinite(n)||n<0){p.currentCtx.err=40963;return}a.gain.gain.value=n;break;case 4109:if(!Number.isFinite(n)||n<0||n>Math.min(a.maxGain,1)){p.currentCtx.err=40963;return}a.minGain=n;break;case 4110:if(!Number.isFinite(n)||n<Math.max(0,a.minGain)||n>1){p.currentCtx.err=40963;return}a.maxGain=n;break;case 4128:if(!Number.isFinite(n)||n<0){p.currentCtx.err=40963;return}a.refDistance=n,a.panner&&(a.panner.refDistance=n);break;case 4129:if(!Number.isFinite(n)||n<0){p.currentCtx.err=40963;return}a.rolloffFactor=n,a.panner&&(a.panner.rolloffFactor=n);break;case 4130:if(!Number.isFinite(n)||n<0||n>1){p.currentCtx.err=40963;return}a.coneOuterGain=n,a.panner&&(a.panner.coneOuterGain=n);break;case 4131:if(!Number.isFinite(n)||n<0){p.currentCtx.err=40963;return}a.maxDistance=n,a.panner&&(a.panner.maxDistance=n);break;case 4132:if(n<0||n>p.sourceDuration(a)){p.currentCtx.err=40963;return}p.sourceSeek(a,n);break;case 4133:var b=p.sourceDuration(a);if(b>0){var h;for(var v in a.bufQueue)if(v){h=a.bufQueue[v].frequency;break}n/=h}if(n<0||n>b){p.currentCtx.err=40963;return}p.sourceSeek(a,n);break;case 4134:var b=p.sourceDuration(a);if(b>0){var g;for(var v in a.bufQueue)if(v){var l=a.bufQueue[v];g=l.frequency*l.bytesPerSample*l.channels;break}n/=g}if(n<0||n>b){p.currentCtx.err=40963;return}p.sourceSeek(a,n);break;case 4628:if(n!==0&&n!==1&&n!==2){p.currentCtx.err=40963;return}a.spatialize=n,p.initSourcePanner(a);break;case 8201:case 8202:case 8203:p.currentCtx.err=40964;break;case 53248:switch(n){case 0:case 53249:case 53250:case 53251:case 53252:case 53253:case 53254:a.distanceModel=n,p.currentCtx.sourceDistanceModel&&p.updateContextGlobal(p.currentCtx);break;default:p.currentCtx.err=40963;return}break;default:p.currentCtx.err=40962;return}}},captures:{},sharedCaptureAudioCtx:null,requireValidCaptureDevice:function(e,t){if(e===0)return p.alcErr=40961,null;var r=p.captures[e];if(!r)return p.alcErr=40961,null;var n=r.mediaStreamError;return n?(p.alcErr=40961,null):r}};function vs(e,t,r,n,a){if(p.currentCtx){var i=p.buffers[e];if(!i){p.currentCtx.err=40963;return}if(a<=0){p.currentCtx.err=40963;return}var u=null;try{switch(t){case 4352:if(n>0){u=p.currentCtx.audioCtx.createBuffer(1,n,a);for(var c=u.getChannelData(0),l=0;l<n;++l)c[l]=W[r++]*.0078125-1}i.bytesPerSample=1,i.channels=1,i.length=n;break;case 4353:if(n>0){u=p.currentCtx.audioCtx.createBuffer(1,n>>1,a);var c=u.getChannelData(0);r>>=1;for(var l=0;l<n>>1;++l)c[l]=ce[r++]*30517578125e-15}i.bytesPerSample=2,i.channels=1,i.length=n>>1;break;case 4354:if(n>0){u=p.currentCtx.audioCtx.createBuffer(2,n>>1,a);for(var c=u.getChannelData(0),h=u.getChannelData(1),l=0;l<n>>1;++l)c[l]=W[r++]*.0078125-1,h[l]=W[r++]*.0078125-1}i.bytesPerSample=1,i.channels=2,i.length=n>>1;break;case 4355:if(n>0){u=p.currentCtx.audioCtx.createBuffer(2,n>>2,a);var c=u.getChannelData(0),h=u.getChannelData(1);r>>=1;for(var l=0;l<n>>2;++l)c[l]=ce[r++]*30517578125e-15,h[l]=ce[r++]*30517578125e-15}i.bytesPerSample=2,i.channels=2,i.length=n>>2;break;case 65552:if(n>0){u=p.currentCtx.audioCtx.createBuffer(1,n>>2,a);var c=u.getChannelData(0);r>>=2;for(var l=0;l<n>>2;++l)c[l]=J[r++]}i.bytesPerSample=4,i.channels=1,i.length=n>>2;break;case 65553:if(n>0){u=p.currentCtx.audioCtx.createBuffer(2,n>>3,a);var c=u.getChannelData(0),h=u.getChannelData(1);r>>=2;for(var l=0;l<n>>3;++l)c[l]=J[r++],h[l]=J[r++]}i.bytesPerSample=4,i.channels=2,i.length=n>>3;break;default:p.currentCtx.err=40963;return}i.frequency=a,i.audioBuf=u}catch{p.currentCtx.err=40963;return}}}function gs(e,t){if(p.currentCtx){for(var r=0;r<e;++r){var n=y[t+r*4>>2];if(n!==0){if(!p.buffers[n]){p.currentCtx.err=40961;return}if(p.buffers[n].refCount){p.currentCtx.err=40964;return}}}for(var r=0;r<e;++r){var n=y[t+r*4>>2];n!==0&&(p.deviceRefCounts[p.buffers[n].deviceId]--,delete p.buffers[n],p.freeIds.push(n))}}}function On(e,t,r){switch(t){case 514:case 4097:case 4098:case 4103:case 4105:case 4128:case 4129:case 4131:case 4132:case 4133:case 4134:case 4628:case 8201:case 8202:case 53248:p.setSourceParam("alSourcei",e,t,r);break;default:p.setSourceParam("alSourcei",e,t,null);break}}function bs(e,t){if(p.currentCtx){for(var r=0;r<e;++r){var n=y[t+r*4>>2];if(!p.currentCtx.sources[n]){p.currentCtx.err=40961;return}}for(var r=0;r<e;++r){var n=y[t+r*4>>2];p.setSourceState(p.currentCtx.sources[n],4116),On(n,4105,0),delete p.currentCtx.sources[n],p.freeIds.push(n)}}}function ys(e,t){if(p.currentCtx)for(var r=0;r<e;++r){var n={deviceId:p.currentCtx.deviceId,id:p.newId(),refCount:0,audioBuf:null,frequency:0,bytesPerSample:2,channels:1,length:0};p.deviceRefCounts[n.deviceId]++,p.buffers[n.id]=n,y[t+r*4>>2]=n.id}}function _s(e,t){if(p.currentCtx)for(var r=0;r<e;++r){var n=p.currentCtx.audioCtx.createGain();n.connect(p.currentCtx.gain);var a={context:p.currentCtx,id:p.newId(),type:4144,state:4113,bufQueue:[p.buffers[0]],audioQueue:[],looping:!1,pitch:1,dopplerShift:1,gain:n,minGain:0,maxGain:1,panner:null,bufsProcessed:0,bufStartTime:Number.NEGATIVE_INFINITY,bufOffset:0,relative:!1,refDistance:1,maxDistance:340282e33,rolloffFactor:1,position:[0,0,0],velocity:[0,0,0],direction:[0,0,0],coneOuterGain:0,coneInnerAngle:360,coneOuterAngle:360,distanceModel:53250,spatialize:2,get playbackRate(){return this.pitch*this.dopplerShift}};p.currentCtx.sources[a.id]=a,y[t+r*4>>2]=a.id}}function ws(){if(p.currentCtx){var e=p.currentCtx.err;return p.currentCtx.err=0,e}else return 40964}function Es(e,t,r){var n=p.getSourceParam("alGetSourcei",e,t);if(n!==null){if(!r){p.currentCtx.err=40963;return}switch(t){case 514:case 4097:case 4098:case 4103:case 4105:case 4112:case 4117:case 4118:case 4128:case 4129:case 4131:case 4132:case 4133:case 4134:case 4135:case 4628:case 8201:case 8202:case 53248:y[r>>2]=n;break;default:p.currentCtx.err=40962;return}}}function Cs(e){if(!p.currentCtx)return 0;if(p.stringCache[e])return p.stringCache[e];var t;switch(e){case 0:t="No Error";break;case 40961:t="Invalid Name";break;case 40962:t="Invalid Enum";break;case 40963:t="Invalid Value";break;case 40964:t="Invalid Operation";break;case 40965:t="Out of Memory";break;case 45057:t="Emscripten";break;case 45058:t="1.1";break;case 45059:t="WebAudio";break;case 45060:t="";for(var r in p.AL_EXTENSIONS)t=t.concat(r),t=t.concat(" ");t=t.trim();break;default:return p.currentCtx.err=40962,0}return t=rn(We(t),tn),p.stringCache[e]=t,t}function xs(e){if(p.currentCtx){var t=p.currentCtx.sources[e];if(!t){p.currentCtx.err=40961;return}p.setSourceState(t,4115)}}function ks(e){if(p.currentCtx){var t=p.currentCtx.sources[e];if(!t){p.currentCtx.err=40961;return}p.setSourceState(t,4114)}}function Ss(e){if(p.currentCtx){var t=p.currentCtx.sources[e];if(!t){p.currentCtx.err=40961;return}p.setSourceState(t,4116)}}function Ps(e,t,r){switch(t){case 4097:case 4098:case 4099:case 4106:case 4109:case 4110:case 4128:case 4129:case 4130:case 4131:case 4132:case 4133:case 4134:case 8203:p.setSourceParam("alSourcef",e,t,r);break;default:p.setSourceParam("alSourcef",e,t,null);break}}function Ts(e){return!(e in p.deviceRefCounts)||p.deviceRefCounts[e]>0?0:(delete p.deviceRefCounts[e],p.freeIds.push(e),1)}function Ds(e,t,r){e.addEventListener(t,r,{once:!0})}function In(e,t){t||(t=[document,document.getElementById("canvas")]),["keydown","mousedown","touchstart"].forEach(function(r){t.forEach(function(n){n&&Ds(n,r,function(){e.state==="suspended"&&e.resume()})})})}function Fs(e,t){if(!(e in p.deviceRefCounts))return p.alcErr=40961,0;var r=null,n=[],a=null;if(t>>=2,t)for(var i=0,u=0;i=y[t++],n.push(i),i!==0;)switch(u=y[t++],n.push(u),i){case 4103:r||(r={}),r.sampleRate=u;break;case 4112:case 4113:break;case 6546:switch(u){case 0:a=!1;break;case 1:a=!0;break;case 2:break;default:return p.alcErr=40964,0}break;case 6550:if(u!==0)return p.alcErr=40964,0;break;default:return p.alcErr=40964,0}var c=window.AudioContext||window.webkitAudioContext,l=null;try{r?l=new c(r):l=new c}catch(S){return S.name==="NotSupportedError"?p.alcErr=40964:p.alcErr=40961,0}In(l),typeof l.createGain>"u"&&(l.createGain=l.createGainNode);var h=l.createGain();h.connect(l.destination);var v={deviceId:e,id:p.newId(),attrs:n,audioCtx:l,listener:{position:[0,0,0],velocity:[0,0,0],direction:[0,0,0],up:[0,0,0]},sources:[],interval:setInterval(function(){p.scheduleContextAudio(v)},p.QUEUE_INTERVAL),gain:h,distanceModel:53250,speedOfSound:343.3,dopplerFactor:1,sourceDistanceModel:!1,hrtf:a||!1,_err:0,get err(){return this._err},set err(S){(this._err===0||S===0)&&(this._err=S)}};if(p.deviceRefCounts[e]++,p.contexts[v.id]=v,a!==null)for(var b in p.contexts){var g=p.contexts[b];g.deviceId===e&&(g.hrtf=a,p.updateContextGlobal(g))}return v.id}function As(e){var t=p.contexts[e];if(p.currentCtx===t){p.alcErr=40962;return}p.contexts[e].interval&&clearInterval(p.contexts[e].interval),p.deviceRefCounts[t.deviceId]--,delete p.contexts[e],p.freeIds.push(e)}function js(e){var t=p.alcErr;return p.alcErr=0,t}function Ls(e,t){if(p.alcStringCache[t])return p.alcStringCache[t];var r;switch(t){case 0:r="No Error";break;case 40961:r="Invalid Device";break;case 40962:r="Invalid Context";break;case 40963:r="Invalid Enum";break;case 40964:r="Invalid Value";break;case 40965:r="Out of Memory";break;case 4100:if(typeof AudioContext<"u"||typeof webkitAudioContext<"u")r=p.DEVICE_NAME;else return 0;break;case 4101:typeof AudioContext<"u"||typeof webkitAudioContext<"u"?r=p.DEVICE_NAME.concat("\0"):r="\0";break;case 785:r=p.CAPTURE_DEVICE_NAME;break;case 784:if(e===0)r=p.CAPTURE_DEVICE_NAME.concat("\0");else{var n=p.requireValidCaptureDevice(e,"alcGetString");if(!n)return 0;r=n.deviceName}break;case 4102:if(!e)return p.alcErr=40961,0;r="";for(var a in p.ALC_EXTENSIONS)r=r.concat(a),r=r.concat(" ");r=r.trim();break;default:return p.alcErr=40963,0}return r=rn(We(r),tn),p.alcStringCache[t]=r,r}function Ms(e){return e===0?(p.currentCtx=null,0):(p.currentCtx=p.contexts[e],1)}function Rs(e){if(e){var t=Ce(e);if(t!==p.DEVICE_NAME)return 0}if(typeof AudioContext<"u"||typeof webkitAudioContext<"u"){var r=p.newId();return p.deviceRefCounts[r]=0,r}else return 0}function Os(){return 2147483648}function Is(e,t,r){W.copyWithin(e,t,t+r)}function Bs(e){try{return ne.grow(e-vt.byteLength+65535>>>16),sn(ne.buffer),1}catch{}}function Ns(e){var t=W.length;e=e>>>0;var r=2147483648;if(e>r)return!1;for(var n=1;n<=4;n*=2){var a=t*(1+.2/n);a=Math.min(a,e+100663296);var i=Math.min(r,uo(Math.max(e,a),65536)),u=Bs(i);if(u)return!0}return!1}var br={};function Us(){return R||"./this.program"}function st(){if(!st.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Us()};for(var r in br)br[r]===void 0?delete t[r]:t[r]=br[r];var n=[];for(var r in t)n.push(r+"="+t[r]);st.strings=n}return st.strings}function zs(e,t){var r=0;return st().forEach(function(n,a){var i=t+r;y[e+a*4>>2]=i,so(n,i),r+=n.length+1}),0}function Gs(e,t){var r=st();y[e>>2]=r.length;var n=0;return r.forEach(function(a){n+=a.length+1}),y[t>>2]=n,0}function $s(e){try{var t=z.getStreamFromFD(e);return s.close(t),0}catch(r){if(typeof s>"u"||!(r instanceof s.ErrnoError))throw r;return r.errno}}function Vs(e,t,r,n){try{var a=z.getStreamFromFD(e),i=z.doReadv(a,t,r);return y[n>>2]=i,0}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return u.errno}}function qs(e,t,r,n,a){try{var i=z.getStreamFromFD(e),u=4294967296,c=r*u+(t>>>0),l=9007199254740992;return c<=-l||c>=l?-61:(s.llseek(i,c,n),ae=[i.position>>>0,(Y=i.position,+Math.abs(Y)>=1?Y>0?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)],y[a>>2]=ae[0],y[a+4>>2]=ae[1],i.getdents&&c===0&&n===0&&(i.getdents=null),0)}catch(h){if(typeof s>"u"||!(h instanceof s.ErrnoError))throw h;return h.errno}}function Ys(e,t,r,n){try{var a=z.getStreamFromFD(e),i=z.doWritev(a,t,r);return y[n>>2]=i,0}catch(u){if(typeof s>"u"||!(u instanceof s.ErrnoError))throw u;return u.errno}}function At(e,t){At.randomDevice||(At.randomDevice=yn());for(var r=0;r<t;r++)H[e+r>>0]=At.randomDevice();return 0}function Ws(e){var t=Date.now();return y[e>>2]=t/1e3|0,y[e+4>>2]=t%1e3*1e3|0,0}function Qs(e){var t=e.getExtension("ANGLE_instanced_arrays");if(t)return e.vertexAttribDivisor=function(r,n){t.vertexAttribDivisorANGLE(r,n)},e.drawArraysInstanced=function(r,n,a,i){t.drawArraysInstancedANGLE(r,n,a,i)},e.drawElementsInstanced=function(r,n,a,i,u){t.drawElementsInstancedANGLE(r,n,a,i,u)},1}function Hs(e){var t=e.getExtension("OES_vertex_array_object");if(t)return e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(r){t.deleteVertexArrayOES(r)},e.bindVertexArray=function(r){t.bindVertexArrayOES(r)},e.isVertexArray=function(r){return t.isVertexArrayOES(r)},1}function Xs(e){var t=e.getExtension("WEBGL_draw_buffers");if(t)return e.drawBuffers=function(r,n){t.drawBuffersWEBGL(r,n)},1}function Ks(e){return!!(e.dibvbi=e.getExtension("WEBGL_draw_instanced_base_vertex_base_instance"))}function Js(e){return!!(e.mdibvbi=e.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance"))}function Zs(e){return!!(e.multiDrawWebgl=e.getExtension("WEBGL_multi_draw"))}var k={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:[],offscreenCanvases:{},queries:[],samplers:[],transformFeedbacks:[],syncs:[],stringCache:{},stringiCache:{},unpackAlignment:4,recordError:function(e){k.lastError||(k.lastError=e)},getNewId:function(e){for(var t=k.counter++,r=e.length;r<t;r++)e[r]=null;return t},getSource:function(e,t,r,n){for(var a="",i=0;i<t;++i){var u=n?y[n+i*4>>2]:-1;a+=Ce(y[r+i*4>>2],u<0?void 0:u)}return a},createContext:function(e,t){e.getContextSafariWebGL2Fixed||(e.getContextSafariWebGL2Fixed=e.getContext,e.getContext=function(a,i){var u=e.getContextSafariWebGL2Fixed(a,i);return a=="webgl"==u instanceof WebGLRenderingContext?u:null});var r=t.majorVersion>1?e.getContext("webgl2",t):e.getContext("webgl",t);if(!r)return 0;var n=k.registerContext(r,t);return n},registerContext:function(e,t){var r=k.getNewId(k.contexts),n={handle:r,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=n),k.contexts[r]=n,(typeof t.enableExtensionsByDefault>"u"||t.enableExtensionsByDefault)&&k.initExtensions(n),r},makeContextCurrent:function(e){return k.currentContext=k.contexts[e],o.ctx=E=k.currentContext&&k.currentContext.GLctx,!(e&&!E)},getContext:function(e){return k.contexts[e]},deleteContext:function(e){k.currentContext===k.contexts[e]&&(k.currentContext=null),typeof JSEvents=="object"&&JSEvents.removeAllHandlersOnTarget(k.contexts[e].GLctx.canvas),k.contexts[e]&&k.contexts[e].GLctx.canvas&&(k.contexts[e].GLctx.canvas.GLctxObject=void 0),k.contexts[e]=null},initExtensions:function(e){if(e||(e=k.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t=e.GLctx;Qs(t),Hs(t),Xs(t),Ks(t),Js(t),e.version>=2&&(t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query_webgl2")),(e.version<2||!t.disjointTimerQueryExt)&&(t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query")),Zs(t);var r=t.getSupportedExtensions()||[];r.forEach(function(n){!n.includes("lose_context")&&!n.includes("debug")&&t.getExtension(n)})}}};function eu(e){E.activeTexture(e)}function tu(e,t){E.attachShader(k.programs[e],k.shaders[t])}function ru(e,t,r){E.bindAttribLocation(k.programs[e],t,Ce(r))}function nu(e,t){e==35051?E.currentPixelPackBufferBinding=t:e==35052&&(E.currentPixelUnpackBufferBinding=t),E.bindBuffer(e,k.buffers[t])}function au(e,t,r,n,a){E.bindBufferRange(e,t,k.buffers[r],n,a)}function ou(e,t){E.bindFramebuffer(e,k.framebuffers[t])}function iu(e,t){E.bindRenderbuffer(e,k.renderbuffers[t])}function su(e,t){E.bindTexture(e,k.textures[t])}function uu(e){E.bindVertexArray(k.vaos[e])}function cu(e){E.blendEquation(e)}function lu(e,t){E.blendFunc(e,t)}function fu(e,t,r,n){E.blendFuncSeparate(e,t,r,n)}function du(e,t,r,n,a,i,u,c,l,h){E.blitFramebuffer(e,t,r,n,a,i,u,c,l,h)}function mu(e,t,r,n){k.currentContext.version>=2?r?E.bufferData(e,W,n,r,t):E.bufferData(e,t,n):E.bufferData(e,r?W.subarray(r,r+t):t,n)}function pu(e,t,r,n){if(k.currentContext.version>=2){E.bufferSubData(e,t,W,n,r);return}E.bufferSubData(e,t,W.subarray(n,n+r))}function hu(e){E.clear(e)}function vu(e,t,r){E.clearBufferfv(e,t,J,r>>2)}function gu(e,t,r,n){E.clearColor(e,t,r,n)}function bu(e){E.clearDepth(e)}function yu(e,t,r,n){E.colorMask(!!e,!!t,!!r,!!n)}function _u(e){E.compileShader(k.shaders[e])}function wu(e,t,r,n,a,i,u,c){if(k.currentContext.version>=2){E.currentPixelUnpackBufferBinding?E.compressedTexImage2D(e,t,r,n,a,i,u,c):E.compressedTexImage2D(e,t,r,n,a,i,W,c,u);return}E.compressedTexImage2D(e,t,r,n,a,i,c?W.subarray(c,c+u):null)}function Eu(e,t,r,n,a,i,u,c,l){E.currentPixelUnpackBufferBinding?E.compressedTexImage3D(e,t,r,n,a,i,u,c,l):E.compressedTexImage3D(e,t,r,n,a,i,u,W,l,c)}function Cu(e,t,r,n,a,i,u,c){E.copyTexSubImage2D(e,t,r,n,a,i,u,c)}function xu(){var e=k.getNewId(k.programs),t=E.createProgram();return t.name=e,t.maxUniformLength=t.maxAttributeLength=t.maxUniformBlockNameLength=0,t.uniformIdCounter=1,k.programs[e]=t,e}function ku(e){var t=k.getNewId(k.shaders);return k.shaders[t]=E.createShader(e),t}function Su(e,t){for(var r=0;r<e;r++){var n=y[t+r*4>>2],a=k.buffers[n];!a||(E.deleteBuffer(a),a.name=0,k.buffers[n]=null,n==E.currentPixelPackBufferBinding&&(E.currentPixelPackBufferBinding=0),n==E.currentPixelUnpackBufferBinding&&(E.currentPixelUnpackBufferBinding=0))}}function Pu(e,t){for(var r=0;r<e;++r){var n=y[t+r*4>>2],a=k.framebuffers[n];!a||(E.deleteFramebuffer(a),a.name=0,k.framebuffers[n]=null)}}function Tu(e){if(e){var t=k.programs[e];if(!t){k.recordError(1281);return}E.deleteProgram(t),t.name=0,k.programs[e]=null}}function Du(e,t){for(var r=0;r<e;r++){var n=y[t+r*4>>2],a=k.renderbuffers[n];!a||(E.deleteRenderbuffer(a),a.name=0,k.renderbuffers[n]=null)}}function Fu(e){if(e){var t=k.shaders[e];if(!t){k.recordError(1281);return}E.deleteShader(t),k.shaders[e]=null}}function Au(e,t){for(var r=0;r<e;r++){var n=y[t+r*4>>2],a=k.textures[n];!a||(E.deleteTexture(a),a.name=0,k.textures[n]=null)}}function ju(e,t){for(var r=0;r<e;r++){var n=y[t+r*4>>2];E.deleteVertexArray(k.vaos[n]),k.vaos[n]=null}}function Lu(e){E.depthFunc(e)}function Mu(e){E.depthMask(!!e)}function Ru(e){E.disable(e)}function Ou(e,t,r){E.drawArrays(e,t,r)}function Iu(e,t,r,n){E.drawArraysInstanced(e,t,r,n)}var yr=[];function Bu(e,t){for(var r=yr[e],n=0;n<e;n++)r[n]=y[t+n*4>>2];E.drawBuffers(r)}function Nu(e,t,r,n){E.drawElements(e,t,r,n)}function Uu(e,t,r,n,a){E.drawElementsInstanced(e,t,r,n,a)}function zu(e){E.enable(e)}function Gu(e){E.enableVertexAttribArray(e)}function $u(e,t,r,n){E.framebufferRenderbuffer(e,t,r,k.renderbuffers[n])}function Vu(e,t,r,n,a){E.framebufferTexture2D(e,t,r,k.textures[n],a)}function qu(e){E.frontFace(e)}function ut(e,t,r,n){for(var a=0;a<e;a++){var i=E[r](),u=i&&k.getNewId(n);i?(i.name=u,n[u]=i):k.recordError(1282),y[t+a*4>>2]=u}}function Yu(e,t){ut(e,t,"createBuffer",k.buffers)}function Wu(e,t){ut(e,t,"createFramebuffer",k.framebuffers)}function Qu(e,t){ut(e,t,"createRenderbuffer",k.renderbuffers)}function Hu(e,t){ut(e,t,"createTexture",k.textures)}function Xu(e,t){ut(e,t,"createVertexArray",k.vaos)}function Ku(e){E.generateMipmap(e)}function Ju(){var e=E.getError()||k.lastError;return k.lastError=0,e}function Zu(e,t){re[e>>2]=t,re[e+4>>2]=(t-re[e>>2])/4294967296}function ec(e,t,r){if(!t){k.recordError(1281);return}var n=void 0;switch(e){case 36346:n=1;break;case 36344:r!=0&&r!=1&&k.recordError(1280);return;case 34814:case 36345:n=0;break;case 34466:var a=E.getParameter(34467);n=a?a.length:0;break;case 33309:if(k.currentContext.version<2){k.recordError(1282);return}var i=E.getSupportedExtensions()||[];n=2*i.length;break;case 33307:case 33308:if(k.currentContext.version<2){k.recordError(1280);return}n=e==33307?3:0;break}if(n===void 0){var u=E.getParameter(e);switch(typeof u){case"number":n=u;break;case"boolean":n=u?1:0;break;case"string":k.recordError(1280);return;case"object":if(u===null)switch(e){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:{n=0;break}default:{k.recordError(1280);return}}else if(u instanceof Float32Array||u instanceof Uint32Array||u instanceof Int32Array||u instanceof Array){for(var c=0;c<u.length;++c)switch(r){case 0:y[t+c*4>>2]=u[c];break;case 2:J[t+c*4>>2]=u[c];break;case 4:H[t+c>>0]=u[c]?1:0;break}return}else try{n=u.name|0}catch(l){k.recordError(1280),te("GL_INVALID_ENUM in glGet"+r+"v: Unknown object returned from WebGL getParameter("+e+")! (error: "+l+")");return}break;default:k.recordError(1280),te("GL_INVALID_ENUM in glGet"+r+"v: Native code calling glGet"+r+"v("+e+") and it returns "+u+" of type "+typeof u+"!");return}}switch(r){case 1:Zu(t,n);break;case 0:y[t>>2]=n;break;case 2:J[t>>2]=n;break;case 4:H[t>>0]=n?1:0;break}}function tc(e,t){ec(e,t,0)}function rc(e,t,r,n){var a=E.getProgramInfoLog(k.programs[e]);a===null&&(a="(unknown error)");var i=t>0&&n?Te(a,n,t):0;r&&(y[r>>2]=i)}function nc(e,t,r){if(!r){k.recordError(1281);return}if(e>=k.counter){k.recordError(1281);return}if(e=k.programs[e],t==35716){var n=E.getProgramInfoLog(e);n===null&&(n="(unknown error)"),y[r>>2]=n.length+1}else if(t==35719){if(!e.maxUniformLength)for(var a=0;a<E.getProgramParameter(e,35718);++a)e.maxUniformLength=Math.max(e.maxUniformLength,E.getActiveUniform(e,a).name.length+1);y[r>>2]=e.maxUniformLength}else if(t==35722){if(!e.maxAttributeLength)for(var a=0;a<E.getProgramParameter(e,35721);++a)e.maxAttributeLength=Math.max(e.maxAttributeLength,E.getActiveAttrib(e,a).name.length+1);y[r>>2]=e.maxAttributeLength}else if(t==35381){if(!e.maxUniformBlockNameLength)for(var a=0;a<E.getProgramParameter(e,35382);++a)e.maxUniformBlockNameLength=Math.max(e.maxUniformBlockNameLength,E.getActiveUniformBlockName(e,a).length+1);y[r>>2]=e.maxUniformBlockNameLength}else y[r>>2]=E.getProgramParameter(e,t)}function ac(e,t,r,n){var a=E.getShaderInfoLog(k.shaders[e]);a===null&&(a="(unknown error)");var i=t>0&&n?Te(a,n,t):0;r&&(y[r>>2]=i)}function oc(e,t,r){if(!r){k.recordError(1281);return}if(t==35716){var n=E.getShaderInfoLog(k.shaders[e]);n===null&&(n="(unknown error)");var a=n?n.length+1:0;y[r>>2]=a}else if(t==35720){var i=E.getShaderSource(k.shaders[e]),u=i?i.length+1:0;y[r>>2]=u}else y[r>>2]=E.getShaderParameter(k.shaders[e],t)}function jt(e){var t=De(e)+1,r=je(t);return Te(e,r,t),r}function ic(e){var t=k.stringCache[e];if(!t){switch(e){case 7939:var r=E.getSupportedExtensions()||[];r=r.concat(r.map(function(l){return"GL_"+l})),t=jt(r.join(" "));break;case 7936:case 7937:case 37445:case 37446:var n=E.getParameter(e);n||k.recordError(1280),t=n&&jt(n);break;case 7938:var a=E.getParameter(7938);k.currentContext.version>=2?a="OpenGL ES 3.0 ("+a+")":a="OpenGL ES 2.0 ("+a+")",t=jt(a);break;case 35724:var i=E.getParameter(35724),u=/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/,c=i.match(u);c!==null&&(c[1].length==3&&(c[1]=c[1]+"0"),i="OpenGL ES GLSL ES "+c[1]+" ("+i+")"),t=jt(i);break;default:k.recordError(1280)}k.stringCache[e]=t}return t}function sc(e){return parseInt(e)}function Bn(e){return e.slice(-1)=="]"&&e.lastIndexOf("[")}function uc(e){var t=e.uniformLocsById,r=e.uniformSizeAndIdsByName,n,a;if(!t)for(e.uniformLocsById=t={},e.uniformArrayNamesById={},n=0;n<E.getProgramParameter(e,35718);++n){var i=E.getActiveUniform(e,n),u=i.name,c=i.size,l=Bn(u),h=l>0?u.slice(0,l):u,v=e.uniformIdCounter;for(e.uniformIdCounter+=c,r[h]=[c,v],a=0;a<c;++a)t[v]=a,e.uniformArrayNamesById[v++]=h}}function cc(e,t){if(t=Ce(t),e=k.programs[e]){uc(e);var r=e.uniformLocsById,n=0,a=t,i=Bn(t);i>0&&(n=sc(t.slice(i+1))>>>0,a=t.slice(0,i));var u=e.uniformSizeAndIdsByName[a];if(u&&n<u[0]&&(n+=u[1],r[n]=r[n]||E.getUniformLocation(e,t)))return n}else k.recordError(1281);return-1}function lc(e,t,r){for(var n=yr[t],a=0;a<t;a++)n[a]=y[r+a*4>>2];E.invalidateFramebuffer(e,n)}function fc(e){e=k.programs[e],E.linkProgram(e),e.uniformLocsById=0,e.uniformSizeAndIdsByName={}}function dc(e,t){e==3317&&(k.unpackAlignment=t),E.pixelStorei(e,t)}function mc(e,t,r,n){function a(c,l){return c+l-1&-l}var i=e*r,u=a(i,n);return t*u}function pc(e){var t={5:3,6:4,8:2,29502:3,29504:4,26917:2,26918:2,29846:3,29847:4};return t[e-6402]||1}function qe(e){return e-=5120,e==0?H:e==1?W:e==2?ce:e==4?y:e==6?J:e==5||e==28922||e==28520||e==30779||e==30782?re:Ge}function Ye(e){return 31-Math.clz32(e.BYTES_PER_ELEMENT)}function _r(e,t,r,n,a,i){var u=qe(e),c=Ye(u),l=1<<c,h=pc(t)*l,v=mc(r,n,h,k.unpackAlignment);return u.subarray(a>>c,a+v>>c)}function hc(e,t,r,n,a,i,u){if(k.currentContext.version>=2){if(E.currentPixelPackBufferBinding)E.readPixels(e,t,r,n,a,i,u);else{var c=qe(i);E.readPixels(e,t,r,n,a,i,c,u>>Ye(c))}return}var l=_r(i,a,r,n,u);if(!l){k.recordError(1280);return}E.readPixels(e,t,r,n,a,i,l)}function vc(e,t,r,n){E.renderbufferStorage(e,t,r,n)}function gc(e,t,r,n,a){E.renderbufferStorageMultisample(e,t,r,n,a)}function bc(e,t,r,n){var a=k.getSource(e,t,r,n);E.shaderSource(k.shaders[e],a)}function yc(e,t,r,n,a,i,u,c,l){if(k.currentContext.version>=2){if(E.currentPixelUnpackBufferBinding)E.texImage2D(e,t,r,n,a,i,u,c,l);else if(l){var h=qe(c);E.texImage2D(e,t,r,n,a,i,u,c,h,l>>Ye(h))}else E.texImage2D(e,t,r,n,a,i,u,c,null);return}E.texImage2D(e,t,r,n,a,i,u,c,l?_r(c,u,n,a,l):null)}function _c(e,t,r,n,a,i,u,c,l,h){if(E.currentPixelUnpackBufferBinding)E.texImage3D(e,t,r,n,a,i,u,c,l,h);else if(h){var v=qe(l);E.texImage3D(e,t,r,n,a,i,u,c,l,v,h>>Ye(v))}else E.texImage3D(e,t,r,n,a,i,u,c,l,null)}function wc(e,t,r){E.texParameteri(e,t,r)}function Ec(e,t,r,n,a){E.texStorage2D(e,t,r,n,a)}function Cc(e,t,r,n,a,i){E.texStorage3D(e,t,r,n,a,i)}function xc(e,t,r,n,a,i,u,c,l){if(k.currentContext.version>=2){if(E.currentPixelUnpackBufferBinding)E.texSubImage2D(e,t,r,n,a,i,u,c,l);else if(l){var h=qe(c);E.texSubImage2D(e,t,r,n,a,i,u,c,h,l>>Ye(h))}else E.texSubImage2D(e,t,r,n,a,i,u,c,null);return}var v=null;l&&(v=_r(c,u,a,i,l)),E.texSubImage2D(e,t,r,n,a,i,u,c,v)}function kc(e,t,r,n,a,i,u,c,l,h,v){if(E.currentPixelUnpackBufferBinding)E.texSubImage3D(e,t,r,n,a,i,u,c,l,h,v);else if(v){var b=qe(h);E.texSubImage3D(e,t,r,n,a,i,u,c,l,h,b,v>>Ye(b))}else E.texSubImage3D(e,t,r,n,a,i,u,c,l,h,null)}function _e(e){var t=E.currentProgram;if(t){var r=t.uniformLocsById[e];return typeof r=="number"&&(t.uniformLocsById[e]=r=E.getUniformLocation(t,t.uniformArrayNamesById[e]+(r>0?"["+r+"]":""))),r}else k.recordError(1282)}function Sc(e,t){E.uniform1f(_e(e),t)}function Pc(e,t){E.uniform1i(_e(e),t)}function Tc(e,t){E.uniform1ui(_e(e),t)}function Dc(e,t,r){E.uniform2f(_e(e),t,r)}var Lt=[];function Fc(e,t,r){if(k.currentContext.version>=2){E.uniform2fv(_e(e),J,r>>2,t*2);return}if(t<=144)for(var a=Lt[2*t-1],n=0;n<2*t;n+=2)a[n]=J[r+4*n>>2],a[n+1]=J[r+(4*n+4)>>2];else var a=J.subarray(r>>2,r+t*8>>2);E.uniform2fv(_e(e),a)}function Ac(e,t,r){if(k.currentContext.version>=2){E.uniform4fv(_e(e),J,r>>2,t*4);return}if(t<=72){var u=Lt[4*t-1],n=J;r>>=2;for(var a=0;a<4*t;a+=4){var i=r+a;u[a]=n[i],u[a+1]=n[i+1],u[a+2]=n[i+2],u[a+3]=n[i+3]}}else var u=J.subarray(r>>2,r+t*16>>2);E.uniform4fv(_e(e),u)}function jc(e,t,r,n){if(k.currentContext.version>=2){E.uniformMatrix4fv(_e(e),!!r,J,n>>2,t*16);return}if(t<=18){var c=Lt[16*t-1],a=J;n>>=2;for(var i=0;i<16*t;i+=16){var u=n+i;c[i]=a[u],c[i+1]=a[u+1],c[i+2]=a[u+2],c[i+3]=a[u+3],c[i+4]=a[u+4],c[i+5]=a[u+5],c[i+6]=a[u+6],c[i+7]=a[u+7],c[i+8]=a[u+8],c[i+9]=a[u+9],c[i+10]=a[u+10],c[i+11]=a[u+11],c[i+12]=a[u+12],c[i+13]=a[u+13],c[i+14]=a[u+14],c[i+15]=a[u+15]}}else var c=J.subarray(n>>2,n+t*64>>2);E.uniformMatrix4fv(_e(e),!!r,c)}function Lc(e){e=k.programs[e],E.useProgram(e),E.currentProgram=e}function Mc(e,t,r,n,a){E.vertexAttribIPointer(e,t,r,n,a)}function Rc(e,t,r,n,a,i){E.vertexAttribPointer(e,t,r,!!n,a,i)}function Oc(e,t,r,n){E.viewport(e,t,r,n)}function Ic(){var e=new Date().getFullYear(),t=new Date(e,0,1),r=new Date(e,6,1),n=t.getTimezoneOffset(),a=r.getTimezoneOffset(),i=Math.max(n,a);y[Vn()>>2]=i*60,y[$n()>>2]=Number(n!=a);function u(b){var g=b.toTimeString().match(/\(([A-Za-z ]+)\)$/);return g?g[1]:"GMT"}var c=u(t),l=u(r),h=tr(c),v=tr(l);a<n?(y[Qe()>>2]=h,y[Qe()+4>>2]=v):(y[Qe()>>2]=v,y[Qe()+4>>2]=h)}function Mt(){Mt.called||(Mt.called=!0,Ic())}function Bc(e,t){Mt();var r=new Date(y[e>>2]*1e3);y[t>>2]=r.getSeconds(),y[t+4>>2]=r.getMinutes(),y[t+8>>2]=r.getHours(),y[t+12>>2]=r.getDate(),y[t+16>>2]=r.getMonth(),y[t+20>>2]=r.getFullYear()-1900,y[t+24>>2]=r.getDay();var n=new Date(r.getFullYear(),0,1),a=(r.getTime()-n.getTime())/(1e3*60*60*24)|0;y[t+28>>2]=a,y[t+36>>2]=-(r.getTimezoneOffset()*60);var i=new Date(r.getFullYear(),6,1).getTimezoneOffset(),u=n.getTimezoneOffset(),c=(i!=u&&r.getTimezoneOffset()==Math.min(u,i))|0;y[t+32>>2]=c;var l=y[Qe()+(c?4:0)>>2];return y[t+40>>2]=l,t}function Nc(e){Mt();var t=new Date(y[e+20>>2]+1900,y[e+16>>2],y[e+12>>2],y[e+8>>2],y[e+4>>2],y[e>>2],0),r=y[e+32>>2],n=t.getTimezoneOffset(),a=new Date(t.getFullYear(),0,1),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),u=a.getTimezoneOffset(),c=Math.min(u,i);if(r<0)y[e+32>>2]=Number(i!=u&&c==n);else if(r>0!=(c==n)){var l=Math.max(u,i),h=r>0?c:l;t.setTime(t.getTime()+(h-n)*6e4)}y[e+24>>2]=t.getDay();var v=(t.getTime()-a.getTime())/(1e3*60*60*24)|0;return y[e+28>>2]=v,y[e>>2]=t.getSeconds(),y[e+4>>2]=t.getMinutes(),y[e+8>>2]=t.getHours(),y[e+12>>2]=t.getDate(),y[e+16>>2]=t.getMonth(),t.getTime()/1e3|0}function Uc(e){}function Rt(e){return e%4===0&&(e%100!==0||e%400===0)}function wr(e,t){for(var r=0,n=0;n<=t;r+=e[n++]);return r}var Ot=[31,29,31,30,31,30,31,31,30,31,30,31],It=[31,28,31,30,31,30,31,31,30,31,30,31];function Bt(e,t){for(var r=new Date(e.getTime());t>0;){var n=Rt(r.getFullYear()),a=r.getMonth(),i=(n?Ot:It)[a];if(t>i-r.getDate())t-=i-r.getDate()+1,r.setDate(1),a<11?r.setMonth(a+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1));else return r.setDate(r.getDate()+t),r}return r}function zc(e,t,r,n){var a=y[n+40>>2],i={tm_sec:y[n>>2],tm_min:y[n+4>>2],tm_hour:y[n+8>>2],tm_mday:y[n+12>>2],tm_mon:y[n+16>>2],tm_year:y[n+20>>2],tm_wday:y[n+24>>2],tm_yday:y[n+28>>2],tm_isdst:y[n+32>>2],tm_gmtoff:y[n+36>>2],tm_zone:a?Ce(a):""},u=Ce(r),c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var l in c)u=u.replace(new RegExp(l,"g"),c[l]);var h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],v=["January","February","March","April","May","June","July","August","September","October","November","December"];function b(x,T,B){for(var A=typeof x=="number"?x.toString():x||"";A.length<T;)A=B[0]+A;return A}function g(x,T){return b(x,T,"0")}function S(x,T){function B(Q){return Q<0?-1:Q>0?1:0}var A;return(A=B(x.getFullYear()-T.getFullYear()))===0&&(A=B(x.getMonth()-T.getMonth()))===0&&(A=B(x.getDate()-T.getDate())),A}function D(x){switch(x.getDay()){case 0:return new Date(x.getFullYear()-1,11,29);case 1:return x;case 2:return new Date(x.getFullYear(),0,3);case 3:return new Date(x.getFullYear(),0,2);case 4:return new Date(x.getFullYear(),0,1);case 5:return new Date(x.getFullYear()-1,11,31);case 6:return new Date(x.getFullYear()-1,11,30)}}function L(x){var T=Bt(new Date(x.tm_year+1900,0,1),x.tm_yday),B=new Date(T.getFullYear(),0,4),A=new Date(T.getFullYear()+1,0,4),Q=D(B),K=D(A);return S(Q,T)<=0?S(K,T)<=0?T.getFullYear()+1:T.getFullYear():T.getFullYear()-1}var M={"%a":function(x){return h[x.tm_wday].substring(0,3)},"%A":function(x){return h[x.tm_wday]},"%b":function(x){return v[x.tm_mon].substring(0,3)},"%B":function(x){return v[x.tm_mon]},"%C":function(x){var T=x.tm_year+1900;return g(T/100|0,2)},"%d":function(x){return g(x.tm_mday,2)},"%e":function(x){return b(x.tm_mday,2," ")},"%g":function(x){return L(x).toString().substring(2)},"%G":function(x){return L(x)},"%H":function(x){return g(x.tm_hour,2)},"%I":function(x){var T=x.tm_hour;return T==0?T=12:T>12&&(T-=12),g(T,2)},"%j":function(x){return g(x.tm_mday+wr(Rt(x.tm_year+1900)?Ot:It,x.tm_mon-1),3)},"%m":function(x){return g(x.tm_mon+1,2)},"%M":function(x){return g(x.tm_min,2)},"%n":function(){return`
`},"%p":function(x){return x.tm_hour>=0&&x.tm_hour<12?"AM":"PM"},"%S":function(x){return g(x.tm_sec,2)},"%t":function(){return"	"},"%u":function(x){return x.tm_wday||7},"%U":function(x){var T=new Date(x.tm_year+1900,0,1),B=T.getDay()===0?T:Bt(T,7-T.getDay()),A=new Date(x.tm_year+1900,x.tm_mon,x.tm_mday);if(S(B,A)<0){var Q=wr(Rt(A.getFullYear())?Ot:It,A.getMonth()-1)-31,K=31-B.getDate(),oe=K+Q+A.getDate();return g(Math.ceil(oe/7),2)}return S(B,T)===0?"01":"00"},"%V":function(x){var T=new Date(x.tm_year+1900,0,4),B=new Date(x.tm_year+1901,0,4),A=D(T),Q=D(B),K=Bt(new Date(x.tm_year+1900,0,1),x.tm_yday);if(S(K,A)<0)return"53";if(S(Q,K)<=0)return"01";var oe;return A.getFullYear()<x.tm_year+1900?oe=x.tm_yday+32-A.getDate():oe=x.tm_yday+1-A.getDate(),g(Math.ceil(oe/7),2)},"%w":function(x){return x.tm_wday},"%W":function(x){var T=new Date(x.tm_year,0,1),B=T.getDay()===1?T:Bt(T,T.getDay()===0?1:7-T.getDay()+1),A=new Date(x.tm_year+1900,x.tm_mon,x.tm_mday);if(S(B,A)<0){var Q=wr(Rt(A.getFullYear())?Ot:It,A.getMonth()-1)-31,K=31-B.getDate(),oe=K+Q+A.getDate();return g(Math.ceil(oe/7),2)}return S(B,T)===0?"01":"00"},"%y":function(x){return(x.tm_year+1900).toString().substring(2)},"%Y":function(x){return x.tm_year+1900},"%z":function(x){var T=x.tm_gmtoff,B=T>=0;return T=Math.abs(T)/60,T=T/60*100+T%60,(B?"+":"-")+String("0000"+T).slice(-4)},"%Z":function(x){return x.tm_zone},"%%":function(){return"%"}};for(var l in M)u.includes(l)&&(u=u.replace(new RegExp(l,"g"),M[l](i)));var U=We(u,!1);return U.length>t?0:(io(U,e),U.length-1)}function Gc(e,t,r,n){return zc(e,t,r,n)}function $c(e){var t=Date.now()/1e3|0;return e&&(y[e>>2]=t),t}var Nn=function(e,t,r,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=s.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n},Nt=365,Ut=146;Object.defineProperties(Nn.prototype,{read:{get:function(){return(this.mode&Nt)===Nt},set:function(e){e?this.mode|=Nt:this.mode&=~Nt}},write:{get:function(){return(this.mode&Ut)===Ut},set:function(e){e?this.mode|=Ut:this.mode&=~Ut}},isFolder:{get:function(){return s.isDir(this.mode)}},isDevice:{get:function(){return s.isChrdev(this.mode)}}}),s.FSNode=Nn,s.staticInit(),o.FS_createPath=s.createPath,o.FS_createDataFile=s.createDataFile,o.FS_createPreloadedFile=s.createPreloadedFile,o.FS_createLazyFile=s.createLazyFile,o.FS_createDevice=s.createDevice,o.FS_unlink=s.unlink,ti(),Ve=o.BindingError=ar(Error,"BindingError"),En=o.InternalError=ar(Error,"InternalError"),di(),Pi(),Ci(),Tn=o.UnboundTypeError=ar(Error,"UnboundTypeError"),Bi(),o.requestFullscreen=function(e,t){_.requestFullscreen(e,t)},o.requestAnimationFrame=function(e){_.requestAnimationFrame(e)},o.setCanvasSize=function(e,t,r){_.setCanvasSize(e,t,r)},o.pauseMainLoop=function(){_.mainLoop.pause()},o.resumeMainLoop=function(){_.mainLoop.resume()},o.getUserMedia=function(){_.getUserMedia()},o.createContext=function(e,t,r,n){return _.createContext(e,t,r,n)};for(var E,Ae=0;Ae<32;++Ae)yr.push(new Array(Ae));for(var Vc=new Float32Array(288),Ae=0;Ae<288;++Ae)Lt[Ae]=Vc.subarray(0,Ae+1);function We(e,t,r){var n=r>0?r:De(e)+1,a=new Array(n),i=ht(e,a,0,a.length);return t&&(a.length=i),a}var Un={__clock_gettime:Po,__cxa_allocate_exception:To,__cxa_rethrow:Do,__cxa_throw:Ao,__gmtime_r:jo,__syscall_fcntl64:Oo,__syscall_fstatat64:Io,__syscall_ftruncate64:Bo,__syscall_getcwd:No,__syscall_getdents64:Uo,__syscall_ioctl:zo,__syscall_lstat64:Go,__syscall_mkdir:$o,__syscall_mmap2:qo,__syscall_munmap:Wo,__syscall_open:Qo,__syscall_readlink:Ho,__syscall_stat64:Xo,__syscall_unlink:Ko,_dlopen_js:Jo,_dlsym_js:Zo,_embind_register_bigint:ei,_embind_register_bool:ai,_embind_register_class:Ai,_embind_register_class_class_function:ji,_embind_register_class_constructor:Li,_embind_register_class_function:Mi,_embind_register_class_property:Ri,_embind_register_emval:Ni,_embind_register_enum:zi,_embind_register_enum_value:Gi,_embind_register_float:Vi,_embind_register_function:qi,_embind_register_integer:Wi,_embind_register_memory_view:Qi,_embind_register_smart_ptr:Hi,_embind_register_std_string:Xi,_embind_register_std_wstring:Ki,_embind_register_void:Ji,_emval_as:Zi,_emval_call:es,_emval_call_void_method:rs,_emval_decref:dr,_emval_get_method_caller:as,_emval_get_module_property:os,_emval_get_property:is,_emval_incref:ss,_emval_is_number:us,_emval_new_cstring:cs,_emval_run_destructors:ls,_emval_set_property:fs,_emval_take_value:ds,abort:ms,alBufferData:vs,alDeleteBuffers:gs,alDeleteSources:bs,alGenBuffers:ys,alGenSources:_s,alGetError:ws,alGetSourcei:Es,alGetString:Cs,alSourcePause:xs,alSourcePlay:ks,alSourceStop:Ss,alSourcef:Ps,alSourcei:On,alcCloseDevice:Ts,alcCreateContext:Fs,alcDestroyContext:As,alcGetError:js,alcGetString:Ls,alcMakeContextCurrent:Ms,alcOpenDevice:Rs,clock_gettime:gn,create_video:wo,delete_video:Eo,emscripten_get_heap_max:Os,emscripten_get_now:tt,emscripten_memcpy_big:Is,emscripten_resize_heap:Ns,environ_get:zs,environ_sizes_get:Gs,exit:Mn,fd_close:$s,fd_read:Vs,fd_seek:qs,fd_write:Ys,get_camera_texture:Co,get_current_hostname:xo,getentropy:At,gettimeofday:Ws,glActiveTexture:eu,glAttachShader:tu,glBindAttribLocation:ru,glBindBuffer:nu,glBindBufferRange:au,glBindFramebuffer:ou,glBindRenderbuffer:iu,glBindTexture:su,glBindVertexArray:uu,glBlendEquation:cu,glBlendFunc:lu,glBlendFuncSeparate:fu,glBlitFramebuffer:du,glBufferData:mu,glBufferSubData:pu,glClear:hu,glClearBufferfv:vu,glClearColor:gu,glClearDepthf:bu,glColorMask:yu,glCompileShader:_u,glCompressedTexImage2D:wu,glCompressedTexImage3D:Eu,glCopyTexSubImage2D:Cu,glCreateProgram:xu,glCreateShader:ku,glDeleteBuffers:Su,glDeleteFramebuffers:Pu,glDeleteProgram:Tu,glDeleteRenderbuffers:Du,glDeleteShader:Fu,glDeleteTextures:Au,glDeleteVertexArrays:ju,glDepthFunc:Lu,glDepthMask:Mu,glDisable:Ru,glDrawArrays:Ou,glDrawArraysInstanced:Iu,glDrawBuffers:Bu,glDrawElements:Nu,glDrawElementsInstanced:Uu,glEnable:zu,glEnableVertexAttribArray:Gu,glFramebufferRenderbuffer:$u,glFramebufferTexture2D:Vu,glFrontFace:qu,glGenBuffers:Yu,glGenFramebuffers:Wu,glGenRenderbuffers:Qu,glGenTextures:Hu,glGenVertexArrays:Xu,glGenerateMipmap:Ku,glGetError:Ju,glGetIntegerv:tc,glGetProgramInfoLog:rc,glGetProgramiv:nc,glGetShaderInfoLog:ac,glGetShaderiv:oc,glGetString:ic,glGetUniformLocation:cc,glInvalidateFramebuffer:lc,glLinkProgram:fc,glPixelStorei:dc,glReadPixels:hc,glRenderbufferStorage:vc,glRenderbufferStorageMultisample:gc,glShaderSource:bc,glTexImage2D:yc,glTexImage3D:_c,glTexParameteri:wc,glTexStorage2D:Ec,glTexStorage3D:Cc,glTexSubImage2D:xc,glTexSubImage3D:kc,glUniform1f:Sc,glUniform1i:Pc,glUniform1ui:Tc,glUniform2f:Dc,glUniform2fv:Fc,glUniform4fv:Ac,glUniformMatrix4fv:jc,glUseProgram:Lc,glVertexAttribIPointer:Mc,glVertexAttribPointer:Rc,glViewport:Oc,gmtime_r:rt,is_electron:ko,localtime_r:Bc,mktime:Nc,setTempRet0:Uc,strftime_l:Gc,time:$c};_o(),o.___wasm_call_ctors=function(){return(o.___wasm_call_ctors=o.asm.__wasm_call_ctors).apply(null,arguments)};var je=o._malloc=function(){return(je=o._malloc=o.asm.malloc).apply(null,arguments)},zn=o.___errno_location=function(){return(zn=o.___errno_location=o.asm.__errno_location).apply(null,arguments)},we=o._free=function(){return(we=o._free=o.asm.free).apply(null,arguments)},Gn=o.___getTypeName=function(){return(Gn=o.___getTypeName=o.asm.__getTypeName).apply(null,arguments)};o.___embind_register_native_and_builtin_types=function(){return(o.___embind_register_native_and_builtin_types=o.asm.__embind_register_native_and_builtin_types).apply(null,arguments)};var Qe=o.__get_tzname=function(){return(Qe=o.__get_tzname=o.asm._get_tzname).apply(null,arguments)},$n=o.__get_daylight=function(){return($n=o.__get_daylight=o.asm._get_daylight).apply(null,arguments)},Vn=o.__get_timezone=function(){return(Vn=o.__get_timezone=o.asm._get_timezone).apply(null,arguments)},qn=o.stackAlloc=function(){return(qn=o.stackAlloc=o.asm.stackAlloc).apply(null,arguments)},Yn=o._memalign=function(){return(Yn=o._memalign=o.asm.memalign).apply(null,arguments)};o.dynCall_ji=function(){return(o.dynCall_ji=o.asm.dynCall_ji).apply(null,arguments)},o.dynCall_jjj=function(){return(o.dynCall_jjj=o.asm.dynCall_jjj).apply(null,arguments)},o.dynCall_jii=function(){return(o.dynCall_jii=o.asm.dynCall_jii).apply(null,arguments)},o.dynCall_jiii=function(){return(o.dynCall_jiii=o.asm.dynCall_jiii).apply(null,arguments)},o.dynCall_viiij=function(){return(o.dynCall_viiij=o.asm.dynCall_viiij).apply(null,arguments)},o.dynCall_viijjiii=function(){return(o.dynCall_viijjiii=o.asm.dynCall_viijjiii).apply(null,arguments)},o.dynCall_iiiiji=function(){return(o.dynCall_iiiiji=o.asm.dynCall_iiiiji).apply(null,arguments)},o.dynCall_iiiijii=function(){return(o.dynCall_iiiijii=o.asm.dynCall_iiiijii).apply(null,arguments)},o.dynCall_iijjj=function(){return(o.dynCall_iijjj=o.asm.dynCall_iijjj).apply(null,arguments)},o.dynCall_viij=function(){return(o.dynCall_viij=o.asm.dynCall_viij).apply(null,arguments)},o.dynCall_iiffj=function(){return(o.dynCall_iiffj=o.asm.dynCall_iiffj).apply(null,arguments)},o.dynCall_jijjiii=function(){return(o.dynCall_jijjiii=o.asm.dynCall_jijjiii).apply(null,arguments)},o.dynCall_vij=function(){return(o.dynCall_vij=o.asm.dynCall_vij).apply(null,arguments)},o.dynCall_jiji=function(){return(o.dynCall_jiji=o.asm.dynCall_jiji).apply(null,arguments)},o.dynCall_iiiijj=function(){return(o.dynCall_iiiijj=o.asm.dynCall_iiiijj).apply(null,arguments)},o.dynCall_viijj=function(){return(o.dynCall_viijj=o.asm.dynCall_viijj).apply(null,arguments)},o.dynCall_viiijjjj=function(){return(o.dynCall_viiijjjj=o.asm.dynCall_viiijjjj).apply(null,arguments)},o.dynCall_vijjiii=function(){return(o.dynCall_vijjiii=o.asm.dynCall_vijjiii).apply(null,arguments)},o.dynCall_viiiji=function(){return(o.dynCall_viiiji=o.asm.dynCall_viiiji).apply(null,arguments)},o.dynCall_viiijii=function(){return(o.dynCall_viiijii=o.asm.dynCall_viiijii).apply(null,arguments)},o.dynCall_iiiiiij=function(){return(o.dynCall_iiiiiij=o.asm.dynCall_iiiiiij).apply(null,arguments)},o.dynCall_viji=function(){return(o.dynCall_viji=o.asm.dynCall_viji).apply(null,arguments)},o.dynCall_vijii=function(){return(o.dynCall_vijii=o.asm.dynCall_vijii).apply(null,arguments)},o.dynCall_vijij=function(){return(o.dynCall_vijij=o.asm.dynCall_vijij).apply(null,arguments)},o.dynCall_vijiii=function(){return(o.dynCall_vijiii=o.asm.dynCall_vijiii).apply(null,arguments)},o.dynCall_vijiiif=function(){return(o.dynCall_vijiiif=o.asm.dynCall_vijiiif).apply(null,arguments)},o.dynCall_viiiij=function(){return(o.dynCall_viiiij=o.asm.dynCall_viiiij).apply(null,arguments)},o.dynCall_viiiiji=function(){return(o.dynCall_viiiiji=o.asm.dynCall_viiiiji).apply(null,arguments)},o.dynCall_iiiji=function(){return(o.dynCall_iiiji=o.asm.dynCall_iiiji).apply(null,arguments)},o.dynCall_viiijj=function(){return(o.dynCall_viiijj=o.asm.dynCall_viiijj).apply(null,arguments)},o.dynCall_viijii=function(){return(o.dynCall_viijii=o.asm.dynCall_viijii).apply(null,arguments)},o.dynCall_iiiiij=function(){return(o.dynCall_iiiiij=o.asm.dynCall_iiiiij).apply(null,arguments)},o.dynCall_iiiiijj=function(){return(o.dynCall_iiiiijj=o.asm.dynCall_iiiiijj).apply(null,arguments)},o.dynCall_iiiiiijj=function(){return(o.dynCall_iiiiiijj=o.asm.dynCall_iiiiiijj).apply(null,arguments)},o.dynCall_jijiii=function(){return(o.dynCall_jijiii=o.asm.dynCall_jijiii).apply(null,arguments)},o.dynCall_jijiiii=function(){return(o.dynCall_jijiiii=o.asm.dynCall_jijiiii).apply(null,arguments)},o.dynCall_jijii=function(){return(o.dynCall_jijii=o.asm.dynCall_jijii).apply(null,arguments)},o.dynCall_jijiiiiii=function(){return(o.dynCall_jijiiiiii=o.asm.dynCall_jijiiiiii).apply(null,arguments)},o.dynCall_jijj=function(){return(o.dynCall_jijj=o.asm.dynCall_jijj).apply(null,arguments)},o.dynCall_iijijjji=function(){return(o.dynCall_iijijjji=o.asm.dynCall_iijijjji).apply(null,arguments)},o.dynCall_iiiij=function(){return(o.dynCall_iiiij=o.asm.dynCall_iiiij).apply(null,arguments)},o.dynCall_iiji=function(){return(o.dynCall_iiji=o.asm.dynCall_iiji).apply(null,arguments)},o.dynCall_jijij=function(){return(o.dynCall_jijij=o.asm.dynCall_jijij).apply(null,arguments)},o.dynCall_iijijji=function(){return(o.dynCall_iijijji=o.asm.dynCall_iijijji).apply(null,arguments)},o.dynCall_jij=function(){return(o.dynCall_jij=o.asm.dynCall_jij).apply(null,arguments)},o.addRunDependency=gt,o.removeRunDependency=et,o.FS_createPath=s.createPath,o.FS_createDataFile=s.createDataFile,o.FS_createPreloadedFile=s.createPreloadedFile,o.FS_createLazyFile=s.createLazyFile,o.FS_createDevice=s.createDevice,o.FS_unlink=s.unlink,o.FS=s,o.GL=k;var zt;function Wn(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}Ze=function e(){zt||Er(),zt||(Ze=e)};function Er(e){if(Me>0||(lo(),Me>0))return;function t(){zt||(zt=!0,o.calledRun=!0,!Ee&&(fo(),w(o),o.onRuntimeInitialized&&o.onRuntimeInitialized(),po()))}o.setStatus?(o.setStatus("Running..."),setTimeout(function(){setTimeout(function(){o.setStatus("")},1),t()},1)):t()}o.run=Er;function qc(e,t){Pe=e,rr()||mo(),Yc(e)}function Yc(e){Pe=e,rr()||(o.onExit&&o.onExit(e),Ee=!0),j(e,new Wn(e))}if(o.preInit)for(typeof o.preInit=="function"&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return Er(),In=function(){},o.ready}})();const ka=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),Sa=m=>(m!==""&&!m.endsWith("/")&&(m+="/"),f=>m+f),Pa=m=>f=>m[f],Ta=async(m,f={})=>{var o,d,w,C;if(await ka())(d=f.info)===null||d===void 0||d.call(f,'The platform supports SIMD. Going to use "BanubaSDK.simd.wasm"');else return(o=f.info)===null||o===void 0||o.call(f,'The platform does not support SIMD. Using "BanubaSDK.wasm"'),m;const P=m("BanubaSDK.simd.wasm");return P?await fetch(P,{method:"HEAD"}).then(F=>F.ok)?F=>{const[R,j]=F.split(".");if(j!=="wasm")return m(F);const O=[R,"simd",j].join(".");return m(O)}:((C=f.warn)===null||C===void 0||C.call(f,`Unable to fetch "BanubaSDK.simd.wasm" from the "${P}". Using "BanubaSDK.wasm" as a fallback`),m):((w=f.warn)===null||w===void 0||w.call(f,'"BanubaSDK.simd.wasm" is missing in the "locateFile" option. Using "BanubaSDK.wasm" as a fallback'),m)},Da=(()=>{try{return new URL(".",document.currentScript.src).toString()}catch{return""}})(),Fa=async(m,f)=>(typeof m>"u"&&(m=Da),typeof m=="string"&&(m=Sa(m)),typeof m=="object"&&(m=Pa(m)),m=await Ta(m,f),m),dt=(()=>{const m=[];return{start(){m.push([])},add(f){const o=m[m.length-1];o&&o.push(f)},remove(f){const o=m[m.length-1];if(!o)return;const d=o.findIndex(w=>w===f);d!==-1&&o.splice(d,1)},end(){const f=m.pop();if(f)for(const o of f)o.isDeleted()||o.delete()}}})();class Aa{register(f){dt.add(f)}unregister(){}}const Xt=m=>(dt.remove(m),m),le=m=>{try{dt.start();const f=m();return ja(f)?Xt(f):f}finally{dt.end()}};function ja(m){return m==null||typeof m!="object"?!1:["isAliasOf","clone","delete","isDeleted","deleteLater"].every(f=>f in m)}var Le;(function(m){m.ERROR="error",m.WARNING="warn",m.INFO="info",m.DEBUG="debug"})(Le||(Le={}));function La(m){var f;const o=(f=Object.keys(Le).reverse().find(w=>typeof m[Le[w]]=="function"))!==null&&f!==void 0?f:"ERROR",d=w=>{for(const P in Le)if(w.includes(P)){const F=m[Le[P]];if(typeof F=="function"){F.call(m,w);return}}const C=m[Le.DEBUG];typeof C=="function"&&C.call(m,w)};return{logLevel:o,print:d,printErr:d}}async function Yr({clientToken:m,locateFile:f,canvas:o=Ma(),logger:d={warn:console.warn,error:console.error},...w}){var C;const P=await Fa(f,d),{logLevel:F,print:R,printErr:j}=La(d),O=await new Promise((I,q)=>xa({locateFile:P,FinalizationGroup:Aa,print:R,printErr:j,onAbort:ee=>{ee instanceof WebAssembly.CompileError&&q(new Error(`Failed to compile "BanubaSDK.wasm": the file "${P("BanubaSDK.wasm")}" is invalid. This error is usually caused by misconfigured "locateFile" option, see https://docs.banuba.com/face-ar-sdk-v1/generated/typedoc/modules.html#SDKOptions. Original Error: `+ee))},...w}).then(I,q));try{le(()=>{O.UtilityManager.initialize(new O.VectorString,m),O.UtilityManager.setLogLevel(O.SeverityLevel[F])})}catch(I){throw typeof I=="number"&&(I=new Error(O.getExceptionMessage(I))),I}return O.createContext(o,!0,!0,{alpha:!0,antialias:!1,depth:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!1}),O.canvas=o,typeof WebGL2RenderingContext>"u"&&(["WEBGL_depth_texture","ANGLE_depth_texture","GL_ANGLE_depth_texture","OES_texture_half_float"].every(I=>{var q;return(q=O.canvas.getContext("webgl"))===null||q===void 0?void 0:q.getExtension(I)})||(C=d.warn)===null||C===void 0||C.call(d,"Depth textures are not supported on the current device.")),O}function Ma(){const m=document.createElement("canvas");return m.style.maxWidth="100%",m.style.objectFit="cover",m}const Ra=(m,f,o)=>fetch(m,f).then(d=>{if(!d.body)return d;let w=0;const C=Number(d.headers.get("content-length")||0),P=d.body.getReader();return new Response(new ReadableStream({async start(F){for(var R;;){const{done:j,value:O}=await P.read();if(j?w=C:w+=O.byteLength,(R=o?.onProgress)===null||R===void 0||R.call(o,{total:C,transferred:w}),j)break;F.enqueue(O)}F.close()}}),d)});var Oa=`this.self=function(){"use strict";var w=Uint8Array,x=Uint16Array,_=Uint32Array,$=new w([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),L=new w([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ur=new w([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),q=function(r,e){for(var n=new x(31),a=0;a<31;++a)n[a]=e+=1<<r[a-1];for(var f=new _(n[30]),a=1;a<30;++a)for(var l=n[a];l<n[a+1];++l)f[l]=l-n[a]<<5|a;return[n,f]},j=q($,2),b=j[0],hr=j[1];b[28]=258,hr[258]=28;for(var cr=q(L,0),wr=cr[0],P=new x(32768),o=0;o<32768;++o){var F=(o&43690)>>>1|(o&21845)<<1;F=(F&52428)>>>2|(F&13107)<<2,F=(F&61680)>>>4|(F&3855)<<4,P[o]=((F&65280)>>>8|(F&255)<<8)>>>1}for(var A=function(r,e,n){for(var a=r.length,f=0,l=new x(e);f<a;++f)r[f]&&++l[r[f]-1];var h=new x(e);for(f=0;f<e;++f)h[f]=h[f-1]+l[f-1]<<1;var t;if(n){t=new x(1<<e);var i=15-e;for(f=0;f<a;++f)if(r[f])for(var v=f<<4|r[f],u=e-r[f],g=h[r[f]-1]++<<u,S=g|(1<<u)-1;g<=S;++g)t[P[g]>>>i]=v}else for(t=new x(a),f=0;f<a;++f)r[f]&&(t[f]=P[h[r[f]-1]++]>>>15-r[f]);return t},M=new w(288),o=0;o<144;++o)M[o]=8;for(var o=144;o<256;++o)M[o]=9;for(var o=256;o<280;++o)M[o]=7;for(var o=280;o<288;++o)M[o]=8;for(var d=new w(32),o=0;o<32;++o)d[o]=5;var gr=A(M,9,1),sr=A(d,5,1),R=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},m=function(r,e,n){var a=e/8|0;return(r[a]|r[a+1]<<8)>>(e&7)&n},Y=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},Cr=function(r){return(r+7)/8|0},W=function(r,e,n){(e==null||e<0)&&(e=0),(n==null||n>r.length)&&(n=r.length);var a=new(r.BYTES_PER_ELEMENT==2?x:r.BYTES_PER_ELEMENT==4?_:w)(n-e);return a.set(r.subarray(e,n)),a},mr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],s=function(r,e,n){var a=new Error(e||mr[r]);if(a.code=r,Error.captureStackTrace&&Error.captureStackTrace(a,s),!n)throw a;return a},pr=function(r,e,n){var a=r.length;if(!a||n&&n.f&&!n.l)return e||new w(0);var f=!e||n,l=!n||n.i;n||(n={}),e||(e=new w(a*3));var h=function(or){var lr=e.length;if(or>lr){var tr=new w(Math.max(lr*2,or));tr.set(e),e=tr}},t=n.f||0,i=n.p||0,v=n.b||0,u=n.l,g=n.d,S=n.m,k=n.n,B=a*8;do{if(!u){t=m(r,i,1);var U=m(r,i+1,3);if(i+=3,U)if(U==1)u=gr,g=sr,S=9,k=5;else if(U==2){var J=m(r,i,31)+257,rr=m(r,i+10,15)+4,er=J+m(r,i+5,31)+1;i+=14;for(var D=new w(er),K=new w(19),C=0;C<rr;++C)K[ur[C]]=m(r,i+C*3,7);i+=rr*3;for(var nr=R(K),Ur=(1<<nr)-1,Dr=A(K,nr,1),C=0;C<er;){var ar=Dr[m(r,i,Ur)];i+=ar&15;var c=ar>>>4;if(c<16)D[C++]=c;else{var y=0,O=0;for(c==16?(O=3+m(r,i,3),i+=2,y=D[C-1]):c==17?(O=3+m(r,i,7),i+=3):c==18&&(O=11+m(r,i,127),i+=7);O--;)D[C++]=y}}var fr=D.subarray(0,J),z=D.subarray(J);S=R(fr),k=R(z),u=A(fr,S,1),g=A(z,k,1)}else s(1);else{var c=Cr(i)+4,H=r[c-4]|r[c-3]<<8,I=c+H;if(I>a){l&&s(0);break}f&&h(v+H),e.set(r.subarray(c,I),v),n.b=v+=H,n.p=i=I*8,n.f=t;continue}if(i>B){l&&s(0);break}}f&&h(v+131072);for(var Nr=(1<<S)-1,Or=(1<<k)-1,Q=i;;Q=i){var y=u[Y(r,i)&Nr],T=y>>>4;if(i+=y&15,i>B){l&&s(0);break}if(y||s(2),T<256)e[v++]=T;else if(T==256){Q=i,u=null;break}else{var ir=T-254;if(T>264){var C=T-257,N=$[C];ir=m(r,i,(1<<N)-1)+b[C],i+=N}var V=g[Y(r,i)&Or],Z=V>>>4;V||s(3),i+=V&15;var z=wr[Z];if(Z>3){var N=L[Z];z+=Y(r,i)&(1<<N)-1,i+=N}if(i>B){l&&s(0);break}f&&h(v+131072);for(var vr=v+ir;v<vr;v+=4)e[v]=e[v-z],e[v+1]=e[v+1-z],e[v+2]=e[v+2-z],e[v+3]=e[v+3-z];v=vr}}n.l=u,n.p=Q,n.b=v,n.f=t,u&&(t=1,n.m=S,n.d=g,n.n=k)}while(!t);return v==e.length?e:W(e,0,v)},Er=new w(0),E=function(r,e){return r[e]|r[e+1]<<8},p=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},X=function(r,e){return p(r,e)+p(r,e+4)*4294967296};function Sr(r,e){return pr(r,e)}var G=typeof TextDecoder<"u"&&new TextDecoder,kr=0;try{G.decode(Er,{stream:!0}),kr=1}catch{}var Fr=function(r){for(var e="",n=0;;){var a=r[n++],f=(a>127)+(a>223)+(a>239);if(n+f>r.length)return[e,W(r,n-1)];f?f==3?(a=((a&15)<<18|(r[n++]&63)<<12|(r[n++]&63)<<6|r[n++]&63)-65536,e+=String.fromCharCode(55296|a>>10,56320|a&1023)):f&1?e+=String.fromCharCode((a&31)<<6|r[n++]&63):e+=String.fromCharCode((a&15)<<12|(r[n++]&63)<<6|r[n++]&63):e+=String.fromCharCode(a)}};function zr(r,e){if(e){for(var n="",a=0;a<r.length;a+=16384)n+=String.fromCharCode.apply(null,r.subarray(a,a+16384));return n}else{if(G)return G.decode(r);var f=Fr(r),l=f[0],h=f[1];return h.length&&s(8),l}}var xr=function(r,e){return e+30+E(r,e+26)+E(r,e+28)},yr=function(r,e,n){var a=E(r,e+28),f=zr(r.subarray(e+46,e+46+a),!(E(r,e+8)&2048)),l=e+46+a,h=p(r,e+20),t=n&&h==4294967295?Tr(r,l):[h,p(r,e+24),p(r,e+42)],i=t[0],v=t[1],u=t[2];return[E(r,e+10),i,v,f,l+E(r,e+30)+E(r,e+32),u]},Tr=function(r,e){for(;E(r,e)!=1;e+=4+E(r,e+2));return[X(r,e+12),X(r,e+4),X(r,e+20)]};function Ar(r,e){for(var n={},a=r.length-22;p(r,a)!=101010256;--a)(!a||r.length-a>65558)&&s(13);var f=E(r,a+8);if(!f)return{};var l=p(r,a+16),h=l==4294967295;h&&(a=p(r,a-12),p(r,a)!=101075792&&s(13),f=p(r,a+32),l=p(r,a+48));for(var t=e&&e.filter,i=0;i<f;++i){var v=yr(r,l,h),u=v[0],g=v[1],S=v[2],k=v[3],B=v[4],U=v[5],c=xr(r,U);l=B,(!t||t({name:k,size:g,originalSize:S,compression:u}))&&(u?u==8?n[k]=Sr(r.subarray(c,c+g),new w(S)):s(14,"unknown compression type "+u):n[k]=W(r,c,c+g))}return n}const Mr=r=>Ar(r,{filter:({name:e,size:n})=>!(n===0||e.startsWith("__MACOSX/"))});onmessage=({data:r})=>{let e;try{e={id:r.id,data:Mr(r.data)}}catch(n){e={id:r.id,error:n.message}}postMessage(e)};var Br="";return Br}();
`;const Kt=new Sr(Oa),Ia=async m=>new Promise((f,o)=>{const d=qr(),w=new Uint8Array(m),C={id:d,data:w},P=({data:F})=>{F.id===C.id&&(Kt.removeEventListener("message",P),"error"in F&&o(new Error(F.error)),"data"in F&&f(F.data))};Kt.addEventListener("message",P),Kt.postMessage(C,[m])}),Jt="/";class Wr{constructor(f){Object.defineProperty(this,"_source",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_fs",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_mountpoint",{enumerable:!0,configurable:!0,writable:!0,value:Jt}),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._source=f}static async preload(f,o){if(Array.isArray(f)){const w=o?.onProgress;return await Promise.all(f.map((C,P)=>{const F=w?{onProgress:(...R)=>w(P,...R)}:{};return this.preload(C,F)}))}const d=new this(f);return await d.load(o),d}async _fetch(f,o){return await Ra(f,{},o).then(d=>{if(d.ok)return d.blob();throw new Error(`${d.status}: Failed to fetch ${f}`)}).then(d=>{if(d.size>0)return d;throw new Error(`The source must not be empty. Received ${d.size} bytes size source.`)})}async _unzip(f){if(!f.type.includes("zip"))throw new TypeError(`The source type must be "application/zip"-like. Received: "${f.type}".`);return await Qr(f).then(Ia).then(o=>Object.entries(o)).then(o=>Object.fromEntries(o))}async load(f){let o=this._source;return typeof o=="string"&&(o=new Request(o)),o instanceof Request&&(o=await this._fetch(o,f)),o instanceof Blob&&(o=await this._unzip(o)),o instanceof Object&&o.constructor===Object&&await Promise.all(Object.entries(o).map(([d,w])=>this.writeFile(d,w))),this._source=null,this._data}_fsWriteFile(f,o){!this._fs||(f=`${this._mountpoint}${f.startsWith("/")?f.substring(1):f}`,Zt.write(this._fs,f,o))}async writeFile(f,o){const d=new Uint8Array(o instanceof Blob?await Qr(o):o);this._data[f]=d,this._fsWriteFile(f,this._data[f])}mount(f,o=Jt){this._fs=f,this._mountpoint=o.endsWith("/")?o:`${o}/`,Object.entries(this._data).forEach(([d,w])=>this._fsWriteFile(d,w))}unmount(){this._fs=null,this._mountpoint=Jt}}function Qr(m){return"arrayBuffer"in m?m.arrayBuffer():new Promise(f=>{const o=new FileReader;o.onload=()=>f(o.result),o.readAsArrayBuffer(m)})}var Zt;(function(m){m.write=(f,o,d)=>{const w=o.split("/");w[0]===""&&w.shift(),w.length>1&&w.reduce((C,P)=>(m.exists(f,C)||f.mkdir(C),`${C}/${P}`)),f.writeFile(o,d)},m.exists=(f,o)=>{try{return f.lstat(o),!0}catch(d){if(d.errno===44||d.code==="ENOENT")return!1;throw d}}})(Zt||(Zt={}));const Hr=(m,f=o=>console.warn(o))=>function(o,d,w){const C=w.value;if(typeof C!="function")throw new TypeError("Only functions can be marked as deprecated");function P(...F){return f.call(this,`DEPRECATION: ${o.constructor.name}.${d}() is deprecated. ${m}`),C.call(this,...F)}return{...w,deprecationWarning:P}};function Xr(){try{return new EventTarget}catch{return document.createDocumentFragment()}}class Ba{constructor(){Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._emitter=Xr()}addEventListener(...f){this._emitter.addEventListener(...f)}removeEventListener(...f){this._emitter.removeEventListener(...f)}dispatchEvent(...f){var o;return(o=this._emitter.dispatchEvent(...f))!==null&&o!==void 0?o:!0}removeAllEventListeners(){this._emitter=Xr()}}class Kr{constructor(f){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:`effects/${qr()}`}),Object.defineProperty(this,"_player",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_resource",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._resource=new Na(f)}static async preload(f,o){if(Array.isArray(f)){const w=o?.onProgress;return await Promise.all(f.map((C,P)=>{const F=w?{onProgress:(...R)=>w(P,...R)}:{};return this.preload(C,F)}))}const d=new this(f);return await d._load(o),d}async _load(f){await this._resource.load(f)}async _bind(f){await this._resource.load(),this._player=f,this._resource.mount(this._player._sdk.FS,this.name)}_unbind(){this._resource.unmount(),this._player=null}async writeFile(f,o){return this._resource.writeFile(f,o)}callJsMethod(f,o=""){if(!this._player){console.warn("The method won't evaluate: the effect is not applied to a player.");return}const d=this._player._effectManager;return le(()=>d.current().callJsMethod(f,o))}async evalJs(f){if(!this._player){console.warn("The script won't evaluate: the effect is not applied to a player.");return}const o=this._player._effectManager;return new Promise(d=>{le(()=>o.current().evalJs(f,d))})}}Ke([Hr("Please, use Effect.evalJs() instead.")],Kr.prototype,"callJsMethod",null);class Na extends Wr{async _unzip(f){let o=await super._unzip(f);const d=Object.keys(o).map(C=>C.split("/").find(Boolean)),w=d[0];return d.every(C=>C===w)&&(o=Object.fromEntries(Object.entries(o).map(([C,P])=>[C.replace(`${w}/`,""),P]))),o}}class Jr{constructor(f){Object.defineProperty(this,"_buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._buffer=new ArrayBuffer(f)}get buffer(){return this._buffer}get byteLength(){return this._buffer.byteLength}get byteOffset(){return 0}set(){}}class Ua{constructor(f){Object.defineProperty(this,"ptr",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"length",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.length=f,this.data=new Jr(f)}}class za{constructor(f,o,d){Object.defineProperty(this,"_sdk",{enumerable:!0,configurable:!0,writable:!0,value:f}),Object.defineProperty(this,"_byteOffset",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_byteLength",{enumerable:!0,configurable:!0,writable:!0,value:d})}get buffer(){return this._sdk.HEAPU8.buffer}get byteLength(){return this._byteLength}get byteOffset(){return this._byteOffset}set(f){return this._sdk.HEAPU8.set(f,this._byteOffset)}}class Ga{constructor(f,o=1){Object.defineProperty(this,"_sdk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_free",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inuse",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._sdk=f,this._free=new Array(o).fill(null).map(()=>({ptr:NaN,length:0}))}allocate(f){const o=this._free.shift();if(o)this._inuse.push(o);else return null;return o.length!==f&&(isNaN(o.ptr)||this._sdk._free(o.ptr),o.ptr=this._sdk._malloc(f),o.length=f,o.data=new za(this._sdk,o.ptr,o.length)),o}release(f){let o;do(o=this._inuse.shift())&&this._free.push(o);while(o&&o.ptr!==f)}reset(){this._free.push(...this._inuse.splice(0,this._inuse.length)),this._free.forEach(f=>{isNaN(f.ptr)||this._sdk._free(f.ptr),f.ptr=NaN,f.length=0})}}var fe;const Zr={devicePixelRatio:typeof devicePixelRatio<"u"?devicePixelRatio:1,faceSearchMode:"GOOD",consistencyMode:"SYNCHRONOUS",cameraOrientation:0,maxFaces:1,logger:console};$.Player=fe=class extends Ba{constructor(m,f={}){super(),Object.defineProperty(this,"_sdk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_preferences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_meta",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_memory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_releaser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_player",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_effectManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_state",{enumerable:!0,configurable:!0,writable:!0,value:"paused"}),Object.defineProperty(this,"_frames",{enumerable:!0,configurable:!0,writable:!0,value:async function*(){}()});const{width:o,height:d}=m.canvas;this._sdk=m,this._preferences={...Zr,fps:30,...f},this._meta={currentFrame:{index:-1,width:o,height:d},upcomingFrame:{index:-1,width:o,height:d}},this._memory=new Ga(this._sdk,5),this._releaser=w=>this._memory.release(w),this._player=le(()=>this._sdk.EffectPlayer.create(new this._sdk.EffectPlayerConfiguration(o,d,!0,this._sdk.FaceSearchMode[this._preferences.faceSearchMode],!1,!1))),this._player.surfaceCreated(this._sdk.canvas.width,this._sdk.canvas.height),this._player.setMaxFaces(this._preferences.maxFaces),this._player.setRenderConsistencyMode(this._sdk.ConsistencyMode[this._preferences.consistencyMode]),this._player.addFrameDurationListener((w,C)=>this.dispatchEvent(new CustomEvent(fe.FRAME_PROCESSED_EVENT,{detail:{instantDuration:w,averagedDuration:C}})),(w,C)=>this.dispatchEvent(new CustomEvent(fe.FRAME_RECEIVED_EVENT,{detail:{instantDuration:w,averagedDuration:C}})),(w,C)=>this.dispatchEvent(new CustomEvent(fe.FRAME_RENDERED_EVENT,{detail:{instantDuration:w,averagedDuration:C}}))),this._player.addFrameDataListener(w=>{le(()=>{this.dispatchEvent(new CustomEvent(fe.FRAME_DATA_EVENT,{detail:w})),w.delete()})}),this._effectManager=this._player.effectManager(),this._effectManager.addEffectActivatedListener(()=>{le(()=>{const w=this._effectManager.current();this.dispatchEvent(new CustomEvent(fe.EFFECT_ACTIVATED_EVENT,{detail:w})),w.delete()})}),this.setVolume(0)}get isPlaying(){return this._state==="playing"}static async create(m){const f=await Yr(m);return new this(f,m)}use(m,f){this._frames=m[Symbol.asyncIterator]({allocate:o=>(this._memory.allocate(o)||new Ua(o)).data,...f})}async applyEffect(m){const f=this,o=m.name;return await m._bind(f),new Promise(d=>{this.addEventListener(fe.EFFECT_ACTIVATED_EVENT,({detail:C})=>{C=Xt(C.clone()),d(C),Xe(()=>C.delete())},{once:!0}),this.addEventListener(fe.EFFECT_ACTIVATED_EVENT,w),le(()=>{this._effectManager.load(o)});function w({detail:C}){C.url()!==`/${o}`&&(f.removeEventListener(fe.EFFECT_ACTIVATED_EVENT,w),m._unbind())}})}async clearEffect(){return new Promise(m=>{this.addEventListener(fe.EFFECT_ACTIVATED_EVENT,()=>m(),{once:!0}),le(()=>{this._effectManager.load("")})})}async addModule(...m){await Promise.all(m.map(f=>f._bind(this)))}callJsMethod(m,f=""){return le(()=>this._effectManager.current().callJsMethod(m,f))}setVolume(m){this._effectManager.setEffectVolume(m),this.dispatchEvent(new CustomEvent("volumechange",{detail:m}))}_setSurfaceSize(m,f,o=this._preferences.devicePixelRatio){const d=Math.round(window.devicePixelRatio),[w,C]=[screen.width*d,screen.height*d],P=Math.max(1,w/m),F=Math.max(1,C/f),R=Math.max(P,F);o=Math.min(o,R),m*=o,f*=o,this._sdk.setCanvasSize(m,f),this._effectManager.setEffectSize(m,f),this._player.surfaceChanged(m,f)}_pushFrame({data:m,width:f,height:o,format:d="RGBA"},w=[]){if(m instanceof Jr)return;const{upcomingFrame:C}=this._meta,P=C.index+1;le(()=>{const F=this._sdk.FrameData.makeFromBpc8(m.byteOffset,this._releaser,f,o,this._sdk.CameraOrientation[`DEG_${this._preferences.cameraOrientation}`],this._sdk.PixelFormat[d],!1,0);if(w.length>0){const R=new this._sdk.VectorFeatureParameter;for(const[j=0,O=0,I=0,q=0]of w)R.push_back(new this._sdk.FeatureParameter(j,O,I,q));F.addFeatureParameters(R)}this._player.pushFrameDataWithNumber(F,P),this._player.recognizerProcessFromBuffer(),C.index=P,C.width=f,C.height=o})}_draw(){try{const{currentFrame:m,upcomingFrame:f}=this._meta;(m.width!==f.width||m.height!==f.height)&&this._setSurfaceSize(m.width=f.width,m.height=f.height);const o=this._player.draw(),d=this._sdk.ctx;return d instanceof WebGLRenderingContext||d.bindFramebuffer(d.READ_FRAMEBUFFER,null),o!==-1&&(m.index=o),o}catch(m){throw this._memory.reset(),m}}play({fps:m}={}){typeof m<"u"&&(this._preferences.fps=m),this._state==="pausing"&&(this._state="playing"),this._state!=="playing"&&(this._state="playing",(async()=>{for(;;){const{value:f}=await this._frames.next(this._preferences.fps);if(f||(this._state="paused"),this._state!=="playing")return;this._pushFrame(f)}})(),(async()=>{let f=0;const o=d=>{var w,C,P,F;if(this._state==="pausing"&&(this._state="paused"),this._state!=="playing")return;Ne(o);const R=1e3/this._preferences.fps,j=.1*R;if(!(d-f<R-j)){f=d;try{this._draw()}catch(O){if(O instanceof WebAssembly.RuntimeError)throw this._state="paused",O;this.clearEffect(),(C=(w=this._preferences.logger).warn)===null||C===void 0||C.call(w,"The effect was force cleared due to the exception:"),(F=(P=this._preferences.logger).error)===null||F===void 0||F.call(P,O)}}};Ne(o)})())}async pause(){for(this._state==="playing"&&(this._state="pausing");this._state==="pausing";)await new Promise(m=>Ne(m));if(this._state!=="paused")throw new Error("The pause request was canceled")}async destroy(){await this.pause(),this.removeAllEventListeners(),await this.clearEffect(),this._player.surfaceDestroyed(),this._player.delete(),this._effectManager.delete(),this._memory.reset();for(const m in this)m.startsWith("_")&&m!=="_state"&&Object.defineProperty(this,m,{get(){throw new Error("The player is destroyed.")},set(){throw new Error("The player is destroyed.")}})}},Object.defineProperty($.Player,"FRAME_RECEIVED_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"framereceived"}),Object.defineProperty($.Player,"FRAME_PROCESSED_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"frameprocessed"}),Object.defineProperty($.Player,"FRAME_RENDERED_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"framerendered"}),Object.defineProperty($.Player,"FRAME_DATA_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"framedata"}),Object.defineProperty($.Player,"EFFECT_ACTIVATED_EVENT",{enumerable:!0,configurable:!0,writable:!0,value:"effectactivated"}),Ke([Hr("Please, use Effect.evalJs() instead.")],$.Player.prototype,"callJsMethod",null),$.Player=fe=Ke([en],$.Player);function en(m,f,o){if(o){let C=function(...F){let R;try{if(R=P.call(this,...F),!(R instanceof Promise))return R}catch(j){throw typeof j=="number"&&(j=new Error(this._sdk.getExceptionMessage(j))),j}return R.catch(j=>{throw typeof j=="number"&&(j=new Error(this._sdk.getExceptionMessage(j))),j})};const P=o.value;return typeof P!="function"||P===m.constructor?o:{...o,value:C}}const d=m.prototype,w=Object.getOwnPropertyDescriptors(d);for(const C in w)Object.defineProperty(d,C,en(d,C,w[C]));return m}class $a{constructor(f){Object.defineProperty(this,"_resource",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._resource=new Wr(f)}static async preload(f,o){if(Array.isArray(f)){const w=o?.onProgress;return await Promise.all(f.map((C,P)=>{const F=w?{onProgress:(...R)=>w(P,...R)}:{};return this.preload(C,F)}))}const d=new this(f);return await d._load(o),d}async _load(f){await this._resource.load(f)}async _bind(f){await this._resource.load(),this._resource.mount(f._sdk.FS)}}const mt=m=>{if(!(m instanceof $.Player))throw new Error(`The "player" must be a Player instance, but "${m}" is received. Make sure you haven't forgot to place "await" before Player.create() call.`)},er=new WeakMap,Va={render:(m,f)=>{mt(m);const o=typeof f=="string"?document.querySelector(f):f;if(!(o instanceof HTMLElement))throw new Error("Target container is not a DOM element");if(o instanceof HTMLMediaElement||o instanceof HTMLCanvasElement)throw new Error("Target container must be a plain html element like `div`");er.set(o,m),o.appendChild(m._sdk.canvas),m.play()},unmount:m=>{const f=typeof m=="string"?document.querySelector(m):m;if(!(f instanceof HTMLElement))throw new Error("Target container is not a DOM element");const o=er.get(f);o&&f.removeChild(o._sdk.canvas),er.delete(f)}};class qa{constructor(f){Object.defineProperty(this,"_player",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),mt(f),this._player=f}async takePhoto(f){var o,d;const w=this._player._sdk.canvas,C=this._player._meta.currentFrame,P=(o=f?.width)!==null&&o!==void 0?o:C.width,F=(d=f?.height)!==null&&d!==void 0?d:C.height,R=Wa(w,P,F);return await new Promise((j,O)=>{var I;return R.toBlob(q=>q?j(q):O(new Error("Unexpected error: Unable to create Blob")),(I=f?.type)!==null&&I!==void 0?I:"image/jpeg",f?.quality)})}}const Ya=/(iP(hone|od|ad).*)|(Version\/)14.*Safari/.test(typeof navigator>"u"?"":navigator.userAgent),Wa=(m,f=m.width,o=m.height)=>{if(f!==m.width||o!==m.height||Ya){const d=Qa(f,o);return d.getContext("2d").drawImage(m,0,0,d.width,d.height),d}return m},Qa=(m,f)=>{let o;return typeof OffscreenCanvas>"u"?(o=document.createElement("canvas"),o.width=m,o.height=f):(o=new OffscreenCanvas(m,f),o.toBlob=function(d,w,C){this.convertToBlob({type:w,quality:C}).then(d).catch(P=>d(null))}),o},Ha=typeof MediaStream<"u"?MediaStream:class{constructor(){throw new Error("The environment does not support MediaStream API")}};class Ue extends Ha{constructor(f){mt(f),super();const o=Ue.cache.get(f);if(!o||!o.active){let d=f._sdk.canvas;if(((d.getContext("webgl2")||d.getContext("webgl")).getContextAttributes()||{}).alpha){const w=d,C=document.createElement("canvas"),P=Vr.createRenderingContext(C,{alpha:!1}),F=typeof WebGL2RenderingContext<"u";f.addEventListener($.Player.FRAME_RENDERED_EVENT,()=>{let R=0,j=0,O=w.width,I=w.height;F&&([j,I]=[I,-I]),P.drawImage(w,R,j,O,I)}),d=C}d.captureStream().getTracks().forEach(w=>this.addTrack(w)),Ue.cache.set(f,this)}return Ue.cache.get(f)}getVideoTrack(f=0){return this.getVideoTracks()[f]}getAudioTrack(f=0){return this.getAudioTracks()[f]}stop(){this.getTracks().forEach(f=>f.stop())}}Object.defineProperty(Ue,"cache",{enumerable:!0,configurable:!0,writable:!0,value:new WeakMap});const Xa=typeof MediaRecorder<"u"?MediaRecorder:class{constructor(){throw new Error("The environment does not support MediaRecorder API")}};class Ka extends Xa{constructor(f,o){mt(f);const d=f._sdk.canvas.captureStream();super(d,o)}async stop(){return new Promise((f,o)=>{const d=C=>{super.removeEventListener("dataavailable",d),super.removeEventListener("error",w),f(C.data)},w=C=>{super.removeEventListener("dataavailable",d),super.removeEventListener("error",w),o(C.error)};super.addEventListener("dataavailable",d),super.addEventListener("error",w),super.stop()})}}const Ja="1.5.2";$.Dom=Va,$.Effect=Kr,$.Image=Ur,$.ImageCapture=qa,$.MediaStream=ke,$.MediaStreamCapture=Ue,$.Module=$a,$.VERSION=Ja,$.Video=Ht,$.VideoRecorder=Ka,$.Webcam=Ea,$.createSDK=Yr,$.defaultPlayerOptions=Zr,$.defaultVideoConstraints=ft,$.defaultVideoOptions=Gr,$.keep=Xt,$.tidy=le,$.timers=la,$.utils=Vr,Object.defineProperties($,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
